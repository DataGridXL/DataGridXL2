/**
 * DataGridXL
 * v2.22.02.02
 * (c) Vanilla Components
 * https://datagridxl.com/buy
 */

const t=["optimizeSpeed","-moz-crisp-edges","-webkit-optimize-contrast","optimize-contrast","pixelated"],e=[];function i(t){return Array.isArray(t)}function s(t){return i(t)&&i(t[0])}function o(t){for(var e,i=0;i<t.length;i++)e=1+i,this._rows.store.push({id:e,title:void 0,_hide:!1,_pass:!0}),this._rows.indexList.push(e);this._rows.store._lastId=e}function n(t){return t instanceof Object&&t.constructor===Object}function l(t){return i(t)&&n(t[0])}function r(t,e=null){null!=e&&l(e)?a.call(this,t,e):s(t)?c.call(this,t):l(t)&&d.call(this,t)}const h=function(t,e=null,i=0){for(var s=!1,o=i,n=0;n<t.length;n++){o+=1;var l=void 0,r=void 0;null!=e&&("source"in t[n]?t[n].source in e&&(l=t[n].source,r=t[n].source):(l=e[n]||void 0,r=e[n]||void 0));var h=t[n].field||l,a=t[n].title||r,c=t[n]._hide||!1;this._cols.store.push({id:o,field:h,title:a,width:t[n].width||this.colWidth,align:t[n].align||this.colAlign,_hide:c,level:0,parent_id:void 0,_role:"data"}),c||(s=!0)}return s||(this._cols.store[this._cols.store.length-1]._hide=!1),o},a=function(t,e){if(l(t))var i=Object.keys(t[0]);else i=null;h.call(this,e,i);for(var s=[],o=0;o<this._cols.store.length;o++)s.push(this._cols.store[o].id);this._cols.indexList=s,this._cols.store._lastId=this._cols.store[this._cols.store.length-1].id},c=function(t){for(var e,i=0;i<t[0].length;i++)e=1+i,this._cols.store.push({id:e,field:void 0,title:void 0,width:this.colWidth,align:this.colAlign,_hide:!1,level:0,parent_id:void 0,_role:"data"}),this._cols.indexList.push(e);this._cols.store._lastId=e},d=function(t){var e,i=0;for(var s in t[0]){e=1+i;var o=s,n=s;this._cols.store.push({id:e,field:o,title:n,width:this.colWidth,align:this.colAlign,_hide:!1,level:0,parent_id:void 0,_role:"data"}),this._cols.indexList.push(e),i++}this._cols.store._lastId=e};function u(t){return null!==t&&""!==t&&!isNaN(t)}function p(t,e=null){this._cellStore=[],null!=e&&l(e)?s(t)?f.call(this,t,e):l(t)&&_.call(this,t,e):s(t)?g.call(this,t):l(t)&&y.call(this,t)}const f=function(t,e){for(var i=0;i<this._rows.store.length;i++){this._cellStore[this._rows.store[i].id-1]=[];for(var s=0;s<this._cols.store.length;s++){if("source"in e[s]&&u(e[s].source))var o=Number(e[s].source);else o=s;this._cellStore[this._rows.store[i].id-1][this._cols.store[s].id-1]={value:t[i][o],_found:!1}}}},g=function(t){for(var e=0;e<this._rows.store.length;e++){this._cellStore[this._rows.store[e].id-1]=[];for(var i=0;i<this._cols.store.length;i++)this._cellStore[this._rows.store[e].id-1][this._cols.store[i].id-1]={value:t[e][i],_found:!1}}},_=function(t,e){for(var i=0;i<this._rows.store.length;i++){this._cellStore[this._rows.store[i].id-1]=[];for(var s=0;s<this._cols.store.length;s++){if("source"in e[s])var o=e[s].source;else o=Object.keys(t[0])[s];this._cellStore[this._rows.store[i].id-1][this._cols.store[s].id-1]={value:t[i][o],_found:!1}}}},y=function(t){for(var e=0;e<this._rows.store.length;e++){this._cellStore[this._rows.store[e].id-1]=[];for(var i=0;i<this._cols.store.length;i++)this._cellStore[this._rows.store[e].id-1][this._cols.store[i].id-1]={value:t[e][this._cols.store[i].field],_found:!1}}};function m(t=null,e=null){this._dataFormat=s(t)?"arrayCollection":"objectCollection",o.call(this,t),r.call(this,t,e),p.call(this,t,e)}function x(t){"data"in t&&i(t.data)?m.call(this,t.data,t.columns||null):"columns"in t&&i(t.columns)?m.call(this,v(t.columns),t.columns):m.call(this,this.constructor.createEmptyData(3,3))}const v=function(t){for(var e=[],i=0;i<3;i++){e.push([]);for(var s=0;s<t.length;s++)e[i].push(null)}return e};function w(){var t=[],e=0,i=[],s=-1,o=[],n=!1,l=[[],[],[]],r=[[],[],[]];if(null!=this._freezeLineColAfterId)var h=0;else h=1;for(var a=0;a<this._cols.indexList.length;a++){this._cols.store[this._cols.indexList[a]-1]._hide?(n?i[s].push(this._cols.indexList[a]):(i[++s]=[this._cols.indexList[a]],e>0&&(o[e-1][1]=s)),n=!0):(t.push(this._cols.indexList[a]),l[h].push(this._cols.indexList[a]),n?o.push([s,null]):o.push([null,null]),e++,n=!1),r[h].push(this._cols.indexList[a]),this._cols.indexList[a]==this._freezeLineColAfterId&&(h=1)}this._cols.hiddenGroups=i,this._cols.iconList=o,this._cols.coordList=t,this._cols.coordSections=l,this._cols.indexSections=r}function C(){var t=[],e=0,i=[],s=-1,o=[],n=!1,l=[[],[],[]],r=[[],[],[]];if(null!=this._freezeLineRowAfterId)var h=0;else h=1;for(var a=0;a<this._rows.indexList.length;a++){var c=this._rows.store[this._rows.indexList[a]-1];c._hide?(n?i[s].push(this._rows.indexList[a]):(i[++s]=[this._rows.indexList[a]],e>0&&(o[e-1][1]=s)),n=!0):c._pass&&(t.push(this._rows.indexList[a]),l[h].push(this._rows.indexList[a]),n?o.push([s,null]):o.push([null,null]),e++,n=!1),r[h].push(this._rows.indexList[a]),this._rows.indexList[a]==this._freezeLineRowAfterId&&(h=1)}this._rows.hiddenGroups=i,this._rows.iconList=o,this._rows.coordList=t,this._rows.coordSections=l,this._rows.indexSections=r}function b(t){for(var e=[],i=0;i<t.length;i++)"string"==typeof t[i]?!(t[i]in this._presetParts)||"include"in this._presetParts[t[i]]&&!this._presetParts[t[i]].include.call(this)||e.push(this._presetParts[t[i]]):e.push(t[i]);return e}function S(t){I.call(this,t),x.call(this,t),L.call(this),w.call(this),C.call(this),this._validatedTopBar=b.call(this,this.topBar),this._validatedBottomBar=b.call(this,this.bottomBar)}const I=function(t){for(var e in t)e in this&&(this[e]=t[e])},L=function(){var t=this.frozenCols,e=this.frozenRows;this.frozenCols>=this._cols.indexList.length&&(t=0),this.frozenRows>=this._rows.indexList.length&&(e=0),this._freezeLineColAfterId=this._cols.indexList[t-1]||null,this._freezeLineRowAfterId=this._rows.indexList[e-1]||null};function R(t){return"function"==typeof t}function P(t={},e={}){var i={};if(null!=t&&Object.keys(t).length)for(var s in t)i[s]=t[s];if(null!=e&&Object.keys(e).length)for(var s in e)i[s]=e[s];return i}function N(t=null,e={},i=!1){i&&(e=P({margin:0,padding:0,"font-weight":"normal","font-size":"100%","font-family":"inherit","vertical-align":"baseline","list-style":"none","box-sizing":"border-box"},e)),H(t,e)}const H=function(t,e){var i=["user-select","user-drag","touch-callout"],s=["-ktml","-moz-","-ms-","-webkit-","-o-"];for(let n in e){if(i.indexOf(n)>-1)for(var o=0;o<s.length;o++)s[o]+n in e||(t.style[s[o]+n]=e[n]);null!==e[n]&&(t.style[n]=e[n])}};function z(t,e=!1){var s="";for(let n in t){if(i(t[n]))for(var o=0;o<t[n].length;o++)s+=n+": "+t[n][o]+";";else e&&(s+="\t"),s+=n+": "+t[n]+";";e&&(s+="\n")}return s}function k(t="div",e={}){var i=document.createElement(t);for(let t in e)if("name"!=t&&"tag"!=t&&"domNodes"!=t&&"children"!=t)if("text"==t)i.textContent=e.text;else if("html"==t)i.innerHTML=e.html;else if("style"==t){var s=!0;"_reset"in e&&(s=e._reset),N(i,e.style,s)}else"noCSS"==t?N(i,e.noCSS,!1):"styleText"==t?i.style.cssText=z(e.styleText):t.startsWith("_")?i[t]=e[t]:("string"==typeof e[t]||u(e[t]))&&i.setAttribute(t,e[t]);return i}function A(){return document.createDocumentFragment()}function T(t=null,e=[]){for(var i=A(),s=0;s<e.length;s++)null!=e[s]&&i.appendChild(e[s]);return t.appendChild(i),t}function F(t,e=this._domNodes){return B.call(this,t,e)}const B=function(t,e=null){if(null==t)return null;var i="",s=[];if("name"in t){s=t.name.split(" ");for(var o=0;o<s.length;o++)i+="dgxl-"+s[o].replace(".","-"),o<s.length-1&&(i+=" ");t.class=i}var n=k(t.tag||"div",t);if("domNodes"in t&&t.domNodes.length&&T(n,t.domNodes),"children"in t&&t.children.length){var l=[];for(o=0;o<t.children.length;o++)"_reset"in t&&(t.children[o]._reset=t._reset),l.push(B.call(this,t.children[o],e));T(n,l)}if(null!=e&&s.length){var r=s[0].split(".");r.length>1?(r[0]in e||(e[r[0]]={}),e[r[0]][r[1]]=n):e[s[0]]=n}return n};function M(){return{name:"contextMenu theme-"+this.cssTheme,style:{position:"absolute",top:0,left:0,"z-index":99999,"-webkit-touch-callout":"none","user-select":"none","font-family":this.fontFamily,"font-size":this.fontSize,display:"none"}}}function E(){return{name:"contextMenuTouch theme-"+this.cssTheme,style:{position:"absolute",top:0,left:0,padding:"0","z-index":99999,"-webkit-touch-callout":"none","user-select":"none","font-family":"sans-serif","font-size":"14px","overflow-x":"auto",visibility:"hidden"}}}function O(){return{name:"scrollbarMeter",style:{position:"absolute",width:"100px",height:"100px","pointer-events":"none",visibility:"hidden",top:0,left:0,overflow:"scroll"},children:[{name:"scrollbarMeterSurface",style:{width:"200px",height:"200px"}}]}}function X(){return{name:"container",style:{overflow:"hidden",position:"relative","text-align":"left","touch-action":"auto"}}}function V(){return{name:"textWidthMeter",style:{position:"absolute",top:0,left:0,"pointer-events":"none",visibility:"hidden"},children:[{tag:"canvas",name:"textWidthMeterCanvas"}]}}function Y(){return{name:"lineHeightMeter",style:{"white-space":"pre",overflow:"hidden",position:"absolute",display:"inline-block","z-index":1e3,top:0,left:0,"line-height":this.rowHeight+"px","font-family":this.fontFamily,"font-size":this.fontSize+"px","pointer-events":"none",visibility:"hidden"},text:K()}}const K=function(){for(var t="",e=0;e<"abc".length;e++)t+="abc\n";return t.trim()};var W={".dgxl-component":function(){return{"background-color":this.getThemeSetting("component")}},".dgxl-bar":function(){return{"column-gap":"6px",padding:"6px"}},".dgxl-inputWrapper":function(){return{display:"flex","flex-grow":1,position:"relative","border-width":"1px","border-style":"solid","border-color":this.getThemeSetting("input|border"),"border-radius":"4px",background:this.getThemeSetting("input")}},".dgxl-inputWrapper.dgxl-hasFocus":function(){return{"box-shadow":"inset 0 0 0 1px "+this.getThemeSetting("input:focus|border"),"border-color":this.getThemeSetting("input:focus|border")}},"reset|.dgxl-inputWrapper.dgxl-hasFocus":function(){return{"box-shadow":"","border-color":this.getThemeSetting("input|border")}},".dgxl-inputField":function(){return{border:"none",outline:"none",width:"100%",position:"relative","background-color":"transparent",height:"100%","box-sizing":"border-box",padding:"0 6px",color:this.getThemeSetting("input|text")}},".dgxl-part button":function(){var t={"box-sizing":"border-box","background-color":this.getThemeSetting("button"),"border-color":"transparent","border-style":"solid","border-width":"1px","border-radius":"4px",color:"#0f1111",cursor:"pointer",display:"flex","align-items":"center","justify-content":"center","font-family":"sans-serif",overflow:"hidden",padding:"0 6px","text-align":"center","text-decoration":"none","touch-action":"manipulation","white-space":"nowrap","min-width":"32px","flex-grow":0,height:"100%"};return"button"in this.theme||(t["background-image"]="linear-gradient(#f7f8fa ,#e7e9ec)",t["border-color"]="#adb1b8 #a2a6ac #8d9096"),t},".dgxl-part button svg":function(){return{fill:this.getThemeSetting("button-icon")}},".dgxl-inputInfo":function(){return{position:"absolute",top:"50%",right:"6px",color:this.getThemeSetting("input-info"),transform:"translateY(-50%)","font-size":this.fontSize+2+"px"}},".dgxl-contextMenuItemList":function(){return{"border-radius":"4px","list-style":"none",margin:0,padding:"var(--dgxl-contextmenu-verticalpadding) 1px","background-color":this.getThemeSetting("contextmenu"),color:this.getThemeSetting("contextmenu|text"),"font-size":"14px","box-shadow":"0 0 4px var(--dgxl-contextmenu-shadowcolor)"}},".dgxl-contextMenuItem":function(){return{height:"var(--dgxl-contextmenu-itemheight)","line-height":"var(--dgxl-contextmenu-itemheight)",padding:"0 10px",position:"relative"}},".dgxl-contextMenuItem-highlight":function(){return{"background-color":this.getThemeSetting("contextmenu-item:highlight")}},"reset|.dgxl-contextMenuItem-highlight":function(){return{"background-color":""}},".dgxl-contextMenuItemShortcutLabel":function(){return{position:"absolute",right:"10px",top:0,color:this.getThemeSetting("contextmenu-item-shortcut"),"font-size":"smaller"}}};function D(t){for(var e=t.parentNode.children,i=0;i<e.length;i++)if(e[i]==t)return i;return-1}function j(t,e){for(;"classList"in t&&!t.classList.contains(e);)t=t.parentNode;return"classList"in t&&t.classList.contains(e)?t:null}function U(t,e="#fff",i="#000"){if("rgb"==t.substring(0,3))var s=t.replace(/[^\d,.]/g,"").split(","),o=s[0],n=s[1],l=s[2];else{var r="#"===t.charAt(0)?t.substring(1,7):t;o=parseInt(r.substring(0,2),16),n=parseInt(r.substring(2,4),16),l=parseInt(r.substring(4,6),16)}var h=[o/255,n/255,l/255].map(t=>t<=.03928?t/12.92:Math.pow((t+.055)/1.055,2.4));return.2126*h[0]+.7152*h[1]+.0722*h[2]>.179?i:e}class G{constructor(t=null,e={}){this._domNodes={},this._offsetX=4,this._offsetY=4,this._prevCursorIndex=null,this._cursorIndex=null,this._context=null,this._isOpen=!1,this.dimensions={width:240,verticalPadding:6,itemHeight:30},this._selectItemCallback=function(){},this._closeCallback=function(){},this.items=[],this._domNodes.containerNode=t}isOpen(){return this._isOpen}open(t,e,i,s,o,n){this._isOpen=!0,this.items=e,this._context=t,this._selectItemCallback=o,this._closeCallback=n;var l=`--dgxl-contextmenu-shadowcolor: ${U(this._context.getThemeSetting("sheet"),"rgba(255,255,255,.35)","rgba(0,0,0,.35)")};--dgxl-contextmenu-verticalpadding: ${this.dimensions.verticalPadding}px;`;l+=z(W[".dgxl-contextMenuItemList"].call(this._context));var r=`--dgxl-contextmenu-itemheight: ${this.dimensions.itemHeight}px;`;r+=z(W[".dgxl-contextMenuItem"].call(this._context));for(var h=z(W[".dgxl-contextMenuItemShortcutLabel"].call(this._context)),a='<ul class="dgxl-contextMenuItemList" style="'+l+'">',c=0;c<this.items.length;c++){var d="dgxl-contextMenuItem",u="",p=!1;"disabled"in this.items[c]&&this.items[c].disabled.call(this._context)?(d+=" "+d+"-disabled",u+="opacity:0.25;",p=!0):u+="cursor:pointer;",a+='<li class="'+d+'" style="'+(r+u)+'"',a+=p?' data-disabled="true"':' data-disabled="false"',a+=">";var f=R(this.items[c].label)?this.items[c].label.call(this._context):this.items[c].label;a+='<div class="dgxl-contextMenuItemLabel">'+this._context.getLocaleSetting(f)+"</div>","shortcut"in this.items[c]&&(a+='<div class="dgxl-contextMenuItemShortcutLabel" style="'+h+'">'+this.items[c].shortcut+"</div>"),a+="</li>"}a+="</ul>",Q.call(this,window,i,s),this._domNodes.containerNode.innerHTML=a,this._domNodes.containerNode.style.display="block",this.setCursor(-1),"_mouseDownListener"in this._domNodes.containerNode||(this._domNodes.containerNode._mouseDownListener=function(t){if(this._domNodes.containerNode.contains(t.target)){if(0==t.button){var e=j(t.target,"dgxl-contextMenuItem");if(null==e)var i=-1;else i=D(e);this.hit(i)}}else this.close()}.bind(this)),"_contextMenuListener"in this._domNodes.containerNode||(this._domNodes.containerNode._contextMenuListener=function(t){t.preventDefault()}),document.addEventListener("mousedown",this._domNodes.containerNode._mouseDownListener),document.addEventListener("contextmenu",this._domNodes.containerNode._contextMenuListener),"_mouseMoveListener"in this._domNodes.containerNode||(this._domNodes.containerNode._mouseMoveListener=function(t){var e=j(t.target,"dgxl-contextMenuItem");if(null==e||1==e.dataset.disabled)var i=-1;else i=D(e);this.setCursor(i)}.bind(this)),"_mouseLeaveListener"in this._domNodes.containerNode||(this._domNodes.containerNode._mouseLeaveListener=function(t){this.setCursor(-1)}.bind(this)),this._domNodes.containerNode.addEventListener("mousemove",this._domNodes.containerNode._mouseMoveListener),this._domNodes.containerNode.addEventListener("mouseleave",this._domNodes.containerNode._mouseLeaveListener)}close(){this._closeCallback.call(this._context,{contextMenu:this})}execClose(){this._isOpen=!1,document.removeEventListener("mousedown",this._domNodes.containerNode._mouseDownListener),document.removeEventListener("contextmenu",this._domNodes.containerNode._contextMenuListener),this._domNodes.containerNode.removeEventListener("mousemove",this._domNodes.containerNode._mouseMoveListener),this._domNodes.containerNode.removeEventListener("mouseleave",this._domNodes.containerNode._mouseLeaveListener),this.setCursor(-1),this._domNodes.containerNode.innerHTML="",this._domNodes.containerNode.style.display="none"}setCursor(t){if(t!==this._prevCursorIndex){var e=this._domNodes.containerNode;e.children.length&&(null!==this._prevCursorIndex&&this._prevCursorIndex>-1&&(N(e.children[0].children[this._prevCursorIndex],W["reset|.dgxl-contextMenuItem-highlight"].call(this._context)),e.children[0].children[this._prevCursorIndex].classList.remove("dgxl-contextMenuItem-highlight")),this._cursorIndex=t,null!==this._cursorIndex&&this._cursorIndex>-1&&(N(e.children[0].children[this._cursorIndex],W[".dgxl-contextMenuItem-highlight"].call(this._context)),e.children[0].children[this._cursorIndex].classList.add("dgxl-contextMenuItem-highlight")),this._prevCursorIndex=this._cursorIndex)}}moveCursorDown(){-1==this._cursorIndex||null===this._cursorIndex?this.setCursor($.call(this)):this._cursorIndex==q.call(this)?this.setCursor($.call(this)):this.setCursor(Z.call(this,this._cursorIndex))}moveCursorUp(){-1==this._cursorIndex||null===this._cursorIndex?this.setCursor(q.call(this)):0==this._cursorIndex?this.setCursor(q.call(this)):this.setCursor(J.call(this,this._cursorIndex))}moveCursorRight(){}moveCursorLeft(){}redrawLabels(){if(this.isOpen())for(var t=this._domNodes.containerNode.getElementsByClassName("dgxl-contextMenuItemList")[0],e=0;e<this.items.length;e++)R(this.items[e].label)&&(t.children[e].firstChild.innerHTML=this._context.getLocaleSetting(this.items[e].label.call(this._context)))}triggerHit(){this.hit(this._cursorIndex)}hit(t){-1!=t&&this.items[t]&&("disabled"in this.items[t]&&this.items[t].disabled.call(this._context)||"method"in this.items[t]&&this._selectItemCallback.call(this._context,{contextMenu:this,index:t,item:this.items[t]}))}}const $=function(){return Z.call(this,-1)},Z=function(t){if(t==this.items.length-1)var e=0;else e=t+1;return"disabled"in this.items[e]&&this.items[e].disabled.call(this._context)?Z.call(this,e):e},q=function(){return J.call(this,this.items.length)},J=function(t){if(0==t)var e=this.items.length-1;else e=t-1;return"disabled"in this.items[e]&&this.items[e].disabled.call(this._context)?J.call(this,e):e},Q=function(t=window,e,i){var s=this._domNodes.containerNode,o=2*this.dimensions.verticalPadding+this.items.length*this.dimensions.itemHeight,n=this.dimensions.width;if(s.style.width=n+"px",t==window)var l=window.scrollY+window.innerHeight,r=window.scrollX+window.innerWidth;else if(t instanceof Element){var h=t.getBoundingClientRect();l=Math.floor(window.scrollY+h.y+h.height),r=Math.floor(window.scrollX+h.x+h.width)}i+this._offsetY+o>l?s._top=i-(o+this._offsetY):s._top=i+this._offsetY,e+this._offsetX+n>r?s._left=e-(n+this._offsetX):s._left=e+this._offsetX,s.style.top=s._top+"px",s.style.left=s._left+"px"};function tt(){et.call(this),it.call(this),st.call(this),ot.call(this)}const et=function(){null===this._container?this._domNodes.container=null:this._container instanceof HTMLElement?this._domNodes.container=this._container:this._domNodes.container=document.getElementById(this._container),null===this._container?F.call(this,X.call(this)):this._domNodes.container.innerHTML=""},it=function(){Object.keys(this.constructor._domNodes).length||(T(document.body,[F.call(this,M.call(this),this.constructor._domNodes),F.call(this,E.call(this),this.constructor._domNodes),F.call(this,O.call(this),this.constructor._domNodes)]),this.constructor.contextMenu=new G(this.constructor._domNodes.contextMenu))},st=function(){T(document.body,[F.call(this,V.call(this)),F.call(this,Y.call(this))]),this._textWidthMeterCanvasContext=this._domNodes.textWidthMeterCanvas.getContext("2d"),this._textWidthMeterCanvasContext.font=this.fontSize+"px "+this.fontFamily},ot=function(){if(this.constructor._isIOS){var t=F.call(this,{tag:"style",html:"\n    .dgxl-ios-fullscreen {\n      width: 100vw !important;\n      height: 100vh !important;\n    }\n  "});document.head.appendChild(t)}};function nt(){var t=this.constructor._domNodes.scrollbarMeter;this.constructor._browserScrollbarSize=t.offsetWidth-t.clientWidth}function lt(){var t=this._domNodes.lineHeightMeter.getBoundingClientRect(),e="abc".length;this._actualRowHeight=Math.round(t.height/e*100)/100}function rt(){var t=!1,e=window.getComputedStyle(this._domNodes.container);this._cd.containerWidth=this._domNodes.container.clientWidth-(parseFloat(e.paddingLeft)+parseFloat(e.paddingRight)),this._cd.containerHeight=this._domNodes.container.clientHeight-(parseFloat(e.paddingTop)+parseFloat(e.paddingBottom)),0==this._containerHeight&&(this._domNodes.container.style.height="300px",t=!0),0==this._containerWidth&&(this._domNodes.container.style.width="100%"),"static"==e.position&&(this._domNodes.container.style.position="relative"),"inline"==e.display&&(this._domNodes.container.style.display="inline-block",t=!0),"hidden"!=e.overflow&&(this._domNodes.container.style.overflow="hidden"),t&&(e=window.getComputedStyle(this._domNodes.container),this._cd.containerWidth=this._domNodes.container.clientWidth-(parseFloat(e.paddingLeft)+parseFloat(e.paddingRight)),this._cd.containerHeight=this._domNodes.container.clientHeight-(parseFloat(e.paddingTop)+parseFloat(e.paddingBottom)))}function ht(){return this.topBar&&this.topBar.length?48:0}function at(){return this.bottomBar&&this.bottomBar.length?48:0}function ct(){return this._cd.componentWidth}function dt(){return this._cd.componentHeight-this._cd.topBarSpace-this._cd.bottomBarSpace}function ut(){return this.constructor._browserScrollbarSize||10}function pt(){return this._cd.displayWidth-this._cd.scrollbarSpace}function ft(){return this._cd.displayHeight-this._cd.scrollbarSpace}function gt(){return this._rows.headerLevels.length*this.rowHeaderWidth}function _t(){return this._cols.headerLevels.length*this.colHeaderHeight}function yt(){return this._cd.colHeaderLevelsSpace+this.colHeaderHeight}function mt(){return this._cd.rowHeaderLevelsSpace+this.rowHeaderWidth}function xt(t){for(var e=0,i=t[0];i<=t[1];i++)e+=this.getColWidthById(this.getColIdByCoord(i));return e}function vt(){var t=this._cd.rowHeaderSpace;if(this._cols.coordSections[0].length){var e=0+this._cols.coordSections[0].length-1;t+=xt.call(this,[0,e])}return{left:t,center:this._cd.viewportWidth-t}}function wt(t){for(var e=0,i=t[0];i<=t[1];i++)e+=this.getRowHeightById(this.getRowIdByCoord(i));return e}function Ct(){var t=this._cd.colHeaderSpace;if(this._rows.coordSections[0].length){var e=0+this._rows.coordSections[0].length-1;t+=wt.call(this,[0,e])}return{top:t,center:this._cd.viewportHeight-t}}function bt(){for(var t=this._cd.rowHeaderSpace,e=0;e<this._sectionsPerPaneX.left.length;e++)t+=St.call(this,this._sectionsPerPaneX.left[e]);var i=t;(t>this._cd.rowHeaderSpace||this._freezeLineColAfterId&&this._sectionsPerPaneX.left.length&&!this._panesXids.left.length)&&(i+=6);var s={space:t,outer:i},o=this._cd.viewportWidth-s.outer,n={space:o,outer:o};return s.offset=0,n.offset=s.outer,{left:s,center:n}}const St=function(t){for(var e=0,i=0;i<this._cols.coordSections.length&&!(i>=t);i++)e+=this._cols.coordSections[i].length;var s=e+this._cols.coordSections[t].length-1;return xt.call(this,[e,s])};function It(){for(var t=this._cd.colHeaderSpace,e=0;e<this._sectionsPerPaneY.top.length;e++)t+=Lt.call(this,this._sectionsPerPaneY.top[e]);var i=t;(t>this._cd.colHeaderSpace||this._freezeLineRowAfterId&&this._sectionsPerPaneY.top.length&&!this._panesYids.top.length)&&(i+=6);var s={space:t,outer:i},o=this._cd.viewportHeight-s.outer,n={space:o,outer:o,inner:o,innerOffset:0};return s.offset=0,n.offset=s.outer,{top:s,center:n}}const Lt=function(t){for(var e=0,i=0;i<this._rows.coordSections.length&&!(i>=t);i++)e+=this._rows.coordSections[i].length;var s=e+this._rows.coordSections[t].length-1;return wt.call(this,[e,s])};function Rt(){return{top:Pt.call(this,"top"),center:Pt.call(this,"center")}}const Pt=function(t){for(var e=this._sectionsPerPaneY[t],i=[],s=0;s<e.length;s++)i.push(this._rows.coordSections[e[s]]);return[].concat.apply([],i)};function Nt(){return{left:Ht.call(this,"left"),center:Ht.call(this,"center")}}const Ht=function(t){for(var e=this._sectionsPerPaneX[t],i=[],s=0;s<e.length;s++)i.push(this._cols.coordSections[e[s]]);return[].concat.apply([],i)};function zt(){for(var t=0,e=0;e<this._panesXids.center.length;e++)t+=this.getColWidthById(this._panesXids.center[e]);return t}function kt(){for(var t=0,e=0;e<this._panesYids.center.length;e++)t+=this.getRowHeightById(this._panesYids.center[e]);return t}function At(){for(var t,e,i=this._cd.innerDocumentWidth-this._cd.panesX.center.space,s=0,o=0;o<this._panesXids.center.length&&(t=o,e=s,!(s>=i));o++)s+=this.getColWidthById(this._panesXids.center[o]);var n=e+this._cd.panesX.center.space-this._cd.innerDocumentWidth;return{startIndex:this._panesXids.left.length+t,blankSpace:n}}function Tt(){for(var t,e,i=this._cd.innerDocumentHeight-this._cd.panesY.center.space,s=0,o=0;o<this._panesYids.center.length&&(t=o,e=s,!(s>=i));o++)s+=this.getRowHeightById(this._panesYids.center[o]);var n=e+this._cd.panesY.center.space-this._cd.innerDocumentHeight;return{startIndex:this._panesYids.top.length+t,blankSpace:n}}function Ft(){var t=this._lastColView.startIndex-this._panesXids.left.length;return 0==t?1:this._cd.scrollAreaWidth+40*t}function Bt(){var t=this._lastRowView.startIndex-this._panesYids.top.length;return 0==t?1:this._cd.scrollAreaHeight+40*t}function Mt(){return Math.max(this._cd.viewportWidth,this._cd.innerDocumentWidth+this._lastColView.blankSpace)}function Et(){return this._cd.innerDocumentHeight+this._lastRowView.blankSpace}function Ot(){this._isFullscreen?(window.getComputedStyle(this._domNodes.component),this._cd.componentWidth=this._domNodes.component.clientWidth,this._cd.componentHeight=this._domNodes.component.clientHeight):(this._cd.componentWidth=this._cd.containerWidth,this._cd.componentHeight=this._cd.containerHeight),this._cd.topBarSpace=ht.call(this),this._cd.bottomBarSpace=at.call(this),this._cd.displayWidth=ct.call(this),this._cd.displayHeight=dt.call(this),this._cd.scrollbarSpace=ut.call(this),this._cd.viewportWidth=pt.call(this),this._cd.viewportHeight=ft.call(this),this._cd.colHeaderLevelsSpace=_t.call(this),this._cd.rowHeaderLevelsSpace=gt.call(this),this._cd.colHeaderSpace=yt.call(this),this._cd.rowHeaderSpace=mt.call(this),this._cd.virtualPanesX=vt.call(this),this._cd.virtualPanesY=Ct.call(this),this._cd.virtualPanesX.center>=200?this._sectionsPerPaneX={left:[0],center:[1]}:this._sectionsPerPaneX={left:[],center:[0,1]},this._cd.virtualPanesY.center>=120?this._sectionsPerPaneY={top:[0],center:[1]}:this._sectionsPerPaneY={top:[],center:[0,1]},this._panesXids=Nt.call(this),this._panesYids=Rt.call(this),this._cd.panesX=bt.call(this),this._cd.panesY=It.call(this),this._cd.innerDocumentWidth=zt.call(this),this._cd.innerDocumentHeight=kt.call(this),this._lastColView=At.call(this),this._lastRowView=Tt.call(this),this._cd.scrollAreaWidth=this._cd.displayWidth,this._cd.scrollAreaHeight=this._cd.displayHeight,this._cd.scrollWidth=Ft.call(this),this._cd.scrollHeight=Bt.call(this),this._cd.scrollableDocumentWidth=Mt.call(this),this._cd.scrollableDocumentHeight=Et.call(this)}function Xt(){for(var t=this._viewportPosition.x-this._panesXids.left.length,e=[],i=0,s=this._cd.panesX.center.space;i<s&&!(t>this._panesXids.center.length-1);)e.push(this._panesXids.center[t]),i+=this.getColWidthById(this._panesXids.center[t]),t++;this._colViewOverflow=i-this._cd.panesX.center.space,this._colView=e}function Vt(){for(var t=this._viewportPosition.y-this._panesYids.top.length,e=[],i=0,s=this._cd.panesY.center.space;i<s&&!(t>this._panesYids.center.length-1);)e.push(this._panesYids.center[t]),i+=this.getRowHeightById(this._panesYids.center[t]),t++;this._rowViewOverflow=i-this._cd.panesY.center.space,this._rowView=e}function Yt(t=!1,e=!1){null==this._viewportPosition&&(this._viewportPosition={x:this._panesXids.left.length,y:this._panesYids.top.length}),this._viewportPosition={x:t?this._panesXids.left.length:this._viewportPosition.x,y:e?this._panesYids.top.length:this._viewportPosition.y},this._viewportPosition={x:Math.max(this._panesXids.left.length,this._viewportPosition.x),y:Math.max(this._panesYids.top.length,this._viewportPosition.y)},Xt.call(this),Vt.call(this)}function Kt(){null==this.constructor_browserScrollbarSize&&nt.call(this),this._isFullscreen||rt.call(this),lt.call(this),Ot.call(this),Yt.call(this)}class Wt{constructor(t){this.events={},this._anyEvent="any",this._context=t}on(t,e){return"function"==typeof e&&("string"==typeof t&&(void 0===this.events[t]&&(this.events[t]={listeners:[]}),!(this.events[t].listeners.indexOf(e)>-1)&&void this.events[t].listeners.push(e)))}off(t,e){if(void 0===this.events[t])return!1;this.events[t].listeners=this.events[t].listeners.filter(t=>t!==e)}dispatch(t,e={},i=t){if(t!=this._anyEvent&&this.dispatch(this._anyEvent,e,t),void 0===this.events[t])return!0;var s=[];this.events[t].listeners.forEach(t=>{s.push(t.call(this._context,e,i))});for(var o=0;o<s.length;o++)if(!1===s[o])return!1;return!0}}function Dt(t,e,i){var s;return function(){var o=this,n=arguments,l=function(){s=null,i||t.apply(o,n)},r=i&&!s;clearTimeout(s),s=setTimeout(l,e),r&&t.apply(o,n)}}class jt{constructor(t,e){this._sharedSensorStyles={display:"block",position:"absolute",left:0,top:0,right:0,bottom:0,overflow:"auto","z-index":-1,visibility:"hidden"},this._resizeSensorStyles={overflow:"hidden"},this._expandTriggerStyles={width:"100000px",height:"100000px"},this._shrinkTriggerStyles={width:"200%",height:"200%"},this._context=e,this._domNodes={},this._domNodes.container=t,this._resizeListener,this.events=new Wt(this),Ut.call(this),Gt.call(this)}}const Ut=function(){this._domNodes.component=k("div",{class:"dgxl-resizeSensor",style:P(this._sharedSensorStyles,this._resizeSensorStyles)});var t=A(),e=k("div",{class:"dgxl-expandSensor",style:this._sharedSensorStyles});e.appendChild(k("div",{class:"dgxl-expandTrigger",style:this._expandTriggerStyles}));var i=k("div",{class:"dgxl-shrinkSensor",style:this._sharedSensorStyles});i.appendChild(k("div",{class:"dgxl-shrinkTrigger",style:this._shrinkTriggerStyles})),t.appendChild(e),t.appendChild(i),this._domNodes.component.appendChild(t),this._domNodes.container.appendChild(this._domNodes.component)},Gt=function(){const t=Dt(t=>{this.events.dispatch("resize",{})},100);this._resizeListener=t.bind(this);var e=!0,i=!0,s=this._domNodes.component.children[0],o=this._domNodes.component.children[1],n=t=>{s.scrollLeft=1e5,s.scrollTop=1e5,o.scrollLeft=1e5,o.scrollTop=1e5},l=t=>{t.target==s&&e?e=!1:t.target==o&&i?i=!1:(this._resizeListener(),n())};n(),s.addEventListener("scroll",l),o.addEventListener("scroll",l)};function $t(){return{name:"topbar bar",style:{position:"absolute",height:this._cd.topBarSpace+"px","line-height":this._cd.topBarSpace+"px",left:0,top:0,right:0,"box-sizing":"border-box",display:this._cd.topBarSpace?"flex":"none","justify-content":"space-between"},noCSS:W[".dgxl-bar"].call(this),domNodes:Zt.call(this),_reset:!1}}const Zt=function(){for(var t,e=[],i=0;i<this._validatedTopBar.length;i++)(t={type:this._validatedTopBar[i].name,wrapper:void 0,nodes:{}}).wrapper=F.call(this,{name:"part part-"+this._validatedTopBar[i].name,style:{display:"flex","flex-grow":this._validatedTopBar[i].grow||0,height:"100%"},children:[this._validatedTopBar[i].node.call(this)],_reset:!1},t.nodes),e.push(t.wrapper),this._topBarNodes.push(t);return e};function qt(){var t=this._cd.panesY.top.space-this._cd.colHeaderSpace;return{name:"backgrounds",style:{width:this._cd.viewportWidth+"px",height:this._cd.viewportHeight+"px",position:"absolute",top:0,left:0,overflow:"hidden"},children:[{name:"background.top-left",style:{position:"absolute",top:this._cd.panesY.top.offset+this._cd.colHeaderSpace+"px",left:this._cd.panesX.left.offset+this._cd.rowHeaderSpace+"px",width:this._cd.panesX.left.space-this._cd.rowHeaderSpace+"px",height:t+"px",overflow:"hidden"},children:[Jt.call(this,"top","left")]},{name:"background.top-center",style:{position:"absolute",width:this._cd.panesX.center.space+"px",height:t+"px",top:this._cd.panesY.top.offset+this._cd.colHeaderSpace+"px",left:this._cd.panesX.center.offset+"px",overflow:"hidden"},children:[Jt.call(this,"top","center")]},{name:"background.center-left",style:{position:"absolute",width:this._cd.panesX.left.space-this._cd.rowHeaderSpace+"px",height:this._cd.panesY.center.space+"px",top:this._cd.panesY.center.offset+"px",left:this._cd.panesX.left.offset+this._cd.rowHeaderSpace+"px",overflow:"hidden"},children:[Jt.call(this,"center","left")]},{name:"background.center-center",style:{position:"absolute",width:this._cd.panesX.center.space+"px",height:this._cd.panesY.center.space+"px",top:this._cd.panesY.center.offset+"px",left:this._cd.panesX.center.offset+"px",overflow:"hidden"},children:[Jt.call(this,"center","center")]}]}}const Jt=function(e,i){var s=this._cd.panesX[i].space,o=this._cd.panesY[e].space;"left"==i&&(s-=this._cd.rowHeaderSpace),"top"==e&&(o-=this._cd.colHeaderSpace);var n=1*Math.ceil(s/1),l=Math.ceil(o/this.rowHeight)*this.rowHeight;return{tag:"canvas",name:"canvas."+e+"-"+i,styleText:{position:"absolute",top:0,left:0,width:n+"px",height:l+"px","image-rendering":t},_panePositionY:e,_panePositionX:i,_displayWidth:n,_displayHeight:l}};function Qt(){return{name:"colHeaderBackground",style:{position:"absolute",left:0,top:0,background:this.getThemeSetting("header"),height:this._cd.colHeaderSpace+"px",width:this._cd.viewportWidth+"px"}}}function te(){return{name:"rowHeaderBackground",style:{position:"absolute",left:0,top:0,background:this.getThemeSetting("header"),height:this._cd.viewportHeight+"px",width:this._cd.rowHeaderSpace+"px"}}}function ee(t){var e=t.cloneNode(!0);return"_opacity"in t&&(e._opacity=t._opacity),"_borderStyle"in t&&(e._borderStyle=t._borderStyle),e}function ie(){return{name:"colHeaderRangeHighlightContainer",domNodes:[ee(this._templates.colHeaderRangeHighlight)]}}function se(){return{name:"colHeaderRangeSelectedContainer",domNodes:[ee(this._templates.colHeaderRangeSelected)]}}function oe(){return{name:"rowHeaderRangeHighlightContainer",domNodes:[ee(this._templates.rowHeaderRangeHighlight)]}}function ne(){return{name:"rowHeaderRangeSelectedContainer",domNodes:[ee(this._templates.rowHeaderRangeSelected)]}}function le(){return{name:"gridLines",style:{position:"absolute",top:0,left:0,opacity:this.getThemeSetting("gridline|opacity"),overflow:"hidden",width:this._cd.viewportWidth+"px",height:this._cd.viewportHeight+"px"},children:re.call(this)}}const re=function(){return[{name:"rowLines",style:{position:"absolute",top:0,left:0,width:this._cd.viewportWidth+"px"},domNodes:he.call(this)},{name:"colLines",style:{position:"absolute",top:0,left:0,height:this._cd.viewportHeight+"px"},domNodes:ce.call(this)}]},he=function(){var t=[];for(var e in this._cd.panesY)t.push(...ae.call(this,e));return t},ae=function(t){var e=[],i=this._cd.panesY[t].offset;if("top"==t){i+=this._cd.colHeaderSpace;var s=F.call(this,{name:"rowLine",style:{position:"absolute",top:0,left:0,right:0,height:0,"border-bottom":"thin solid "+this.getThemeSetting("gridline-tip"),transform:"translateY("+i+"px)",opacity:1}});e.push(s)}for(var o=0;o<this._panesYids[t].length;o++){i+=this.getRowHeightById(this._panesYids[t][o]);s=F.call(this,{name:"rowLine",style:{position:"absolute",top:0,left:0,right:0,height:0,"border-bottom":"thin solid "+this.getThemeSetting("gridline"),transform:"translateY("+i+"px)",opacity:1},children:[{style:{position:"absolute",left:0,top:0,width:this._cd.rowHeaderSpace+1+"px","border-bottom":"thin solid "+this.getThemeSetting("gridline-tip")}}]});e.push(s),this._rowLines.push({node:s,offset:i})}return e},ce=function(){var t=[];for(var e in this._cd.panesX)t.push(...de.call(this,e));return t},de=function(t){var e=[],i=this._cd.panesX[t].offset;if("left"==t){i+=this._cd.rowHeaderSpace;var s=F.call(this,{name:"colLine",style:{position:"absolute",top:0,bottom:0,left:0,width:0,transform:"translateX("+i+"px)","border-right":"thin solid "+this.getThemeSetting("gridline-tip"),opacity:1}});e.push(s)}for(var o=0;o<this._panesXids[t].length;o++){i+=this.getColWidthById(this._panesXids[t][o]);s=F.call(this,{name:"colLine",style:{position:"absolute",top:0,bottom:0,left:0,width:0,transform:"translateX("+i+"px)","border-right":"thin solid "+this.getThemeSetting("gridline"),opacity:1},children:[{style:{position:"absolute",top:0,left:0,height:this._cd.colHeaderSpace+1+"px","border-right":"thin solid "+this.getThemeSetting("gridline-tip")}}]});e.push(s),this._colLines.push({node:s,offset:i})}return e};function ue(){return{name:"placeholderFreezeLines",style:{position:"absolute",top:0,left:0,opacity:1,overflow:"hidden",width:this._cd.viewportWidth+"px",height:this._cd.viewportHeight+"px"},children:pe.call(this)}}const pe=function(){var t=[];return t.push({name:"freezeLinePlaceholder_row",style:{position:"absolute",left:0,width:this._cd.rowHeaderSpace+"px",height:"6px","background-color":this.getThemeSetting("freezelineplaceholder"),top:0,opacity:0},_opacity:this._sectionsPerPaneY.top.length?0:1}),t.push({name:"freezeLinePlaceholder_col",style:{position:"absolute",top:0,height:this._cd.colHeaderSpace+"px",left:0,width:"6px","background-color":this.getThemeSetting("freezelineplaceholder"),opacity:0},_opacity:this._sectionsPerPaneX.left.length?0:1}),t};function fe(){return{name:"blankSheetContainer",children:[ge.call(this),_e.call(this)]}}const ge=function(){var t=1;if(this._rowView.length){var e=this._viewportPosition.y+(this._rowView.length-1),i=this.getRowPositionInViewport(e);i+=this._actualRowHeight+1,t=(this._cd.viewportHeight-i)/100}return{name:"blankSheetBottom blankSheet",style:{position:"absolute",bottom:0,left:0,right:0,"background-color":this.getThemeSetting("blanksheet"),height:"100px","transform-origin":"center bottom",transform:"scaleY("+t+")",opacity:t>0?1:0},_opacity:1}},_e=function(){var t=1;if(this._colView.length){var e=this._viewportPosition.x+(this._colView.length-1),i=this.getColPositionInViewport(e);i+=this.getColWidthById(this._cols.coordList[e])+1,t=(this._cd.viewportWidth-i)/100}return{name:"blankSheetRight blankSheet",style:{position:"absolute",top:0,right:0,bottom:0,"background-color":this.getThemeSetting("blanksheet"),width:"100px","transform-origin":"top right",transform:"scaleX("+t+")",opacity:t>0?1:0},_opacity:1}};function ye(){return{name:"cellRangeContainer",domNodes:[ee(this._templates.cellRange)]}}function me(){return{name:"panes",style:{"font-family":"sans-serif","font-size":"14px",width:this._cd.viewportWidth+"px",height:this._cd.viewportHeight+"px",position:"absolute",top:0,left:0,overflow:"hidden",contain:"layout style"},children:[{name:"pane-left",style:{position:"absolute",left:this._cd.panesX.left.offset+"px",width:this._cd.panesX.left.space+"px",height:this._cd.viewportHeight+"px",top:0,overflow:"hidden"},domNodes:xe.call(this,"left")},{name:"pane-center",style:{position:"absolute",left:this._cd.panesX.center.offset+"px",width:this._cd.panesX.center.space+"px",height:this._cd.viewportHeight+"px",top:0,overflow:"hidden"},domNodes:xe.call(this,"center")}]}}const xe=function(t){var e=[],i=0;if("left"==t&&(e.push(this._domNodes.rowHeaderColumn),i+=this._cd.rowHeaderSpace),"center"==t)var s=this._colView;else s=this._panesXids[t];for(var o=0;o<s.length;o++){var n=s[o]-1,l=this._cols.store[n],r=this._columnNodes[n];r.column.style.transform="translateX("+i+"px)",i+=l.width,e.push(r.column)}return e};function ve(){return{name:"cellRangeForegroundContainer",domNodes:[ee(this._templates.cellRangeForeground)]}}function we(){return{name:"freezeLines",style:{overflow:"hidden",position:"absolute",top:0,left:0,width:this._cd.viewportWidth+"px",height:this._cd.viewportHeight+"px"},children:[Ce.call(this),be.call(this)]}}const Ce=function(){if(this._sectionsPerPaneX.left.length||null==this._freezeLineColAfterId)var t=1;else t=0;var e=this.getThemeSetting("freezeline-tip");return this.allowFreezeCols||null!=this._freezeLineColAfterId||(e="transparent"),{name:"freezeLine-col",style:{position:"absolute",top:0,left:(this._freezeLineColAfterId?this._cd.panesX.left.space:this._cd.panesX.center.offset-6)+"px",bottom:0,width:"6px","background-color":this._freezeLineColAfterId?this.getThemeSetting("freezeline"):"transparent",opacity:this._cd.panesX.left.space?t:.25},children:[{style:{position:"absolute",top:0,left:0,height:this._cd.colHeaderSpace+"px",width:"6px","background-color":e}}]}},be=function(){if(this._sectionsPerPaneY.top.length||null==this._freezeLineRowAfterId)var t=1;else t=0;var e=this.getThemeSetting("freezeline-tip");return this.allowFreezeRows||null!=this._freezeLineRowAfterId||(e="transparent"),{name:"freezeLine-row",style:{position:"absolute",top:(this._freezeLineRowAfterId?this._cd.panesY.top.space:this._cd.panesY.center.offset-6)+"px",left:0,right:0,height:"6px","background-color":this._freezeLineRowAfterId?this.getThemeSetting("freezeline"):"transparent",opacity:this._cd.panesY.top.space?t:.25},children:[{style:{position:"absolute",top:0,left:0,width:this._cd.rowHeaderSpace+"px",height:"6px","background-color":e}}]}};function Se(){return{name:"cellCursor",style:{position:"absolute",top:0,left:0,"box-sizing":"border-box","border-width":"2px","border-style":"solid","border-color":this.getThemeSetting("cellcursor"),"transform-origin":"0 0",width:this.colWidth+1+"px",height:this.actualRowHeight+1+"px",opacity:0},_opacity:1}}function Ie(){return{name:"searchCursor",style:{position:"absolute",top:0,left:0,"box-sizing":"border-box","border-width":"2px","border-style":"solid","border-color":this.getThemeSetting("searchcursor"),"border-radius":"4px","transform-origin":"center center",width:this.colWidth+1+"px",height:this._actualRowHeight+1+"px",opacity:0,transition:"transform 0.05s"},_opacity:1}}function Le(){return{name:"ghostsContainer",style:{overflow:"hidden",position:"absolute",top:0,left:0,width:this._cd.viewportWidth+"px",height:this._cd.viewportHeight+"px"},children:Re.call(this)}}const Re=function(){var t={name:"ghostForFreezeRows",style:{position:"absolute",top:0,left:0,right:0,height:"6px","background-color":this.getThemeSetting("freeze?ghost"),opacity:0},children:[{style:{position:"absolute",top:0,left:0,width:this._cd.rowHeaderSpace+"px",height:"6px","background-color":"transparent"}}],_opacity:this.getThemeSetting("freeze?ghost|opacity")},e={name:"ghostForFreezeCols",style:{position:"absolute",top:0,left:0,bottom:0,width:"6px","background-color":this.getThemeSetting("freeze?ghost"),opacity:0},children:[{style:{position:"absolute",top:0,left:0,height:this._cd.colHeaderSpace+"px",width:"6px","background-color":"transparent"}}],_opacity:this.getThemeSetting("freeze?ghost|opacity")},i={name:"ghostForMoveCols",style:{position:"absolute",left:0,width:"100px","box-sizing":"border-box","background-color":this.getThemeSetting("move?ghost"),bottom:0,top:this._cd.colHeaderSpace+"px",opacity:0},_opacity:this.getThemeSetting("move?ghost|opacity")};return[{name:"ghostForMoveRows",style:{position:"absolute",left:this._cd.rowHeaderSpace+"px",height:"100px","box-sizing":"border-box","background-color":this.getThemeSetting("move?ghost"),right:0,top:0,opacity:0},_opacity:this.getThemeSetting("move?ghost|opacity")},i,t,e]};function Pe(){return{name:"guidesContainer",style:{overflow:"hidden",position:"absolute",top:0,left:0,width:this._cd.viewportWidth+"px",height:this._cd.viewportHeight+"px"},children:Ne.call(this)}}const Ne=function(){return[{name:"guideForResizeCols",style:{position:"absolute",top:0,left:0,bottom:0,width:"1px","background-color":this.getThemeSetting("resize?guide"),"box-sizing":"border-box",opacity:0},_opacity:this.getThemeSetting("resize?guide|opacity")},{name:"guideForMoveCols",style:{position:"absolute",top:this._cd.colHeaderSpace+"px",left:0,bottom:0,width:"3px","background-color":this.getThemeSetting("move?guide"),opacity:0},_opacity:this.getThemeSetting("move?guide|opacity")},{name:"guideForMoveRows",style:{position:"absolute",left:this._cd.rowHeaderSpace+"px",top:0,right:0,height:"3px","background-color":this.getThemeSetting("move?guide"),opacity:0},_opacity:this.getThemeSetting("move?guide|opacity")},{name:"guideForFreezeRows",style:{position:"absolute",top:0,left:0,height:"6px",right:0,"background-color":this.getThemeSetting("freeze?guide"),opacity:0},_opacity:this.getThemeSetting("freeze?guide|opacity")},{name:"guideForFreezeCols",style:{position:"absolute",top:0,left:0,width:"6px",bottom:0,"background-color":this.getThemeSetting("freeze?guide"),opacity:0},_opacity:this.getThemeSetting("freeze?guide|opacity")}]};function He(){return{name:"hintsContainer",style:{overflow:"hidden",position:"absolute",top:0,left:0,width:this._cd.viewportWidth+"px",height:this._cd.viewportHeight+"px"},children:ze.call(this)}}const ze=function(){var t=`\n  <svg height="8" width="8" style="position:absolute;top:3px;right:4px;fill:${this.getThemeSetting("header-icon")};">\n    <polygon points="2,4 8,0 8,8" class="triangle">\n  </svg>\n  `,e=`\n  <svg height="8" width="8" style="position:absolute;top:3px;left:4px;fill:${this.getThemeSetting("header-icon")};">\n    <polygon points="6,4 0,0 0,8" class="triangle">\n  </svg>\n  `,i=`\n  <svg height="8" width="8" style="position:absolute;bottom:4px;left:3px;fill:${this.getThemeSetting("header-icon")};">\n    <polygon points="4,2 0,8 8,8" class="triangle">\n  </svg>\n  `,s=`\n  <svg height="8" width="8" style="position:absolute;top:4px;left:3px;fill:${this.getThemeSetting("header-icon")};">\n    <polygon points="4,6 0,0 8,0" class="triangle">\n  </svg>`;return[{name:"hintForResizeCols",style:{overflow:"hidden",position:"absolute",top:0,left:0,width:"4px",height:this._cd.colHeaderSpace+"px","background-color":this.getThemeSetting("resize?hint"),opacity:0},_opacity:1},{name:"hintForFreezeCols",style:{overflow:"hidden",position:"absolute",top:0,left:0,width:"6px",height:this._cd.colHeaderSpace+"px","background-color":this.getThemeSetting("freeze?hint"),opacity:0},_opacity:1},{name:"hintForFreezeRows",style:{overflow:"hidden",position:"absolute",top:0,left:0,height:"6px",width:this._cd.rowHeaderSpace+"px","background-color":this.getThemeSetting("freeze?hint"),opacity:0},_opacity:1},{name:"hintForShowColsNext",style:{position:"absolute",top:this.colHeaderHeight/2-8+"px",left:0,height:"16px",width:"14px",background:this.getThemeSetting("show?hint"),"border-radius":"2px 0 0 2px","border-width":"1px","border-style":"solid","border-right-style":"none","border-color":this.getThemeSetting("show?hint"),"box-shadow":"0px 0px 0px 1px "+this.getThemeSetting("show?hint|border"),"clip-path":"polygon(-100% -100%, 100% -100%, 100% 200%, -100% 200%)","box-sizing":"border-box","font-size":10,"text-align":"center",opacity:0},html:t,_opacity:1},{name:"hintForShowColsPrev",style:{position:"absolute",top:this.colHeaderHeight/2-8+"px",left:0,height:"16px",width:"14px",background:this.getThemeSetting("show?hint"),"border-radius":"0 2px 2px 0","border-width":"1px","border-style":"solid","border-left-style":"none","border-color":this.getThemeSetting("show?hint"),"box-shadow":"0px 0px 0px 1px "+this.getThemeSetting("show?hint|border"),"clip-path":"polygon(0% -100%, 200% -100%, 200% 200%, 0% 200%)","box-sizing":"border-box","font-size":10,"text-align":"center",opacity:0},html:e,_opacity:1},{name:"hintForShowRowsNext",style:{position:"absolute",top:0,left:"2px",height:"16px",width:"16px",background:this.getThemeSetting("show?hint"),"border-radius":"2px 2px 0 0","border-width":"1px","border-style":"solid","border-bottom-style":"none","border-color":this.getThemeSetting("show?hint"),"box-shadow":"0px 0px 0px 1px "+this.getThemeSetting("show?hint|border"),"clip-path":"polygon(100% -100%, 200% -100%, 200% 100%, -100% 100%)","box-sizing":"border-box","font-size":10,"text-align":"center",opacity:0},html:i,_opacity:1},{name:"hintForShowRowsPrev",style:{position:"absolute",top:0,left:"2px",height:"16px",width:"16px",background:this.getThemeSetting("show?hint"),"border-radius":"0 0 2px 2px","border-width":"1px","border-style":"solid","border-top-style":"none","border-color":this.getThemeSetting("show?hint"),"box-shadow":"0px 0px 0px 1px "+this.getThemeSetting("show?hint|border"),"clip-path":"polygon(-100% 0%, 200% 0%, 200% 200%, 0% 200%)","box-sizing":"border-box","font-size":10,"text-align":"center",opacity:0},html:s,_opacity:1}]};function ke(){return{name:"hiddenColGroupIconContainer",children:[{name:"hiddenColGroupIconPrevContainer"},{name:"hiddenColGroupIconNextContainer"}]}}function Ae(){return{name:"hiddenRowGroupIconContainer",children:[{name:"hiddenRowGroupIconPrevContainer"},{name:"hiddenRowGroupIconNextContainer"}]}}function Te(){return{name:"actionRangesContainer",style:{overflow:"hidden",position:"absolute",top:0,left:0,width:this._cd.viewportWidth+"px",height:this._cd.viewportHeight+"px"},children:Fe.call(this)}}const Fe=function(){return[{name:"fillRange",style:{overflow:"hidden","pointer-events":"none",position:"absolute","box-sizing":"border-box","border-width":"1px","border-style":"dashed","border-color":this.getThemeSetting("cellrange:fill"),top:0,left:0,opacity:0},_extra:0,_opacity:1,_borderStyle:"dashed"},{name:"copyRange",style:{overflow:"hidden","pointer-events":"none",position:"absolute","box-sizing":"border-box","border-width":"2px","border-style":"dashed","border-color":this.getThemeSetting("cellrange:copy"),"background-color":"transparent",top:0,left:0,opacity:0},_extra:1,_opacity:1,_borderStyle:"dashed"},{name:"cutRange",style:{overflow:"hidden","pointer-events":"none",position:"absolute","box-sizing":"border-box","border-width":"2px","border-style":"dashed","border-color":this.getThemeSetting("cellrange:cut"),"background-color":"transparent",top:0,left:0,opacity:0},_extra:1,_opacity:1,_borderStyle:"dashed"}]};function Be(){return{name:"fillHandle",style:{position:"absolute","background-color":this.getThemeSetting("sheet"),width:"9px",height:"9px",left:0,top:0,opacity:0,display:this.constructor._isTouchDevice?"none":"block"},children:[{name:"fillHandleInner",style:{position:"absolute","background-color":this.getThemeSetting("fillhandle"),width:"8px",height:"8px",left:"1px",top:"1px"}}],_opacity:this.allowFillCells?1:0}}function Me(){return{name:"viewport",style:{overflow:"hidden",position:"absolute",top:0,left:0,width:this._cd.viewportWidth+"px",height:this._cd.viewportHeight+"px"},children:[qt.call(this),Qt.call(this),te.call(this),ie.call(this),se.call(this),oe.call(this),ne.call(this),le.call(this),ye.call(this),me.call(this),we.call(this),ue.call(this),ve.call(this),fe.call(this),Te.call(this),Se.call(this),Ie.call(this),Le.call(this),Pe.call(this),ke.call(this),Ae.call(this),He.call(this),Be.call(this)]}}function Ee(){var t={eventArea:{position:"absolute",left:0,top:0,width:this._cd.scrollAreaWidth+"px",height:this._cd.scrollAreaHeight+"px",overflow:"hidden","touch-action":"manipulation","background-color":"transparent",cursor:this.mouseCursorStatesIdle.default},scrollArea:{position:"absolute",overflow:"scroll","overflow-scrolling":"touch",left:0,top:0,width:this._cd.scrollAreaWidth+"px",height:this._cd.scrollAreaHeight+"px","box-sizing":"border-box",display:"block"},scrollSurface:{width:this._cd.scrollWidth+"px",height:this._cd.scrollHeight+"px"}};return{name:"eventArea",style:t.eventArea,children:[{name:"scrollArea",style:t.scrollArea,children:[{name:"scrollSurface",style:t.scrollSurface}]}]}}function Oe(){return{name:"scrollbars",children:[{name:"scrollbarY",style:{position:"absolute",right:0,top:0,bottom:0,width:this._cd.scrollbarSpace+"px",background:this.getThemeSetting("scrollbar"),"border-left":"1px solid "+this.getThemeSetting("scrollbar|border")}},{name:"scrollbarX",style:{position:"absolute",bottom:0,left:0,right:0,height:this._cd.scrollbarSpace+"px",background:this.getThemeSetting("scrollbar"),"border-top":"1px solid "+this.getThemeSetting("scrollbar|border")}},{name:"jointScrollbar",style:{position:"absolute",bottom:0,right:0,width:this._cd.scrollbarSpace+"px",height:this._cd.scrollbarSpace+"px",background:this.getThemeSetting("header"),"border-top":"1px solid "+this.getThemeSetting("scrollbar|border"),"border-left":"1px solid "+this.getThemeSetting("scrollbar|border")}}]}}function Xe(){var t=U(this.getThemeSetting("sheet"),"rgba(255,255,255,.35)","rgba(0,0,0,.35)"),e={tag:"textarea",name:"cellEditorInputField",style:{"box-sizing":"border-box",background:this.getThemeSetting("sheet"),color:this.getThemeSetting("sheet|text"),"font-family":this.fontFamily,"font-size":this.fontSize+"px","border-width":"2px","border-style":"solid","border-color":this.getThemeSetting("celleditor"),"box-shadow":"1px 1px 2px "+t,height:"auto","min-height":"auto",resize:"none",overflow:"auto",outline:"none","overflow-y":"hidden","padding-left":"4px","padding-right":"4px","border-radius":0,"line-height":this.rowHeight-4+"px","-webkit-touch-callout":"none","user-drag":"none","user-select":"text"},tabIndex:-1,autoComplete:"off",wrap:"hard",value:"",spellcheck:!1,autocomplete:"off",_actualCommand:void 0,_isOpen:!1,_coords:null,_mode:null};return this.constructor._isTouchDevice&&(e.readonly=!0),{name:"cellEditor",style:{position:"absolute",top:0,left:0,"user-select":"none",height:"1px",opacity:0,"z-index":-1},children:[e]}}function Ve(){return{name:"display",style:{position:"absolute",top:this._cd.topBarSpace+"px",left:0,right:0,bottom:this._cd.bottomBarSpace+"px","background-color":this.getThemeSetting("sheet")},children:[Me.call(this),Oe.call(this),Ee.call(this),Xe.call(this)],_touchStartFired:!1,_hasScrolled:!1,_hasZoomed:!1,_setViewportPositionOnScroll:!0}}function Ye(){return{name:"bottombar bar",style:{position:"absolute",height:this._cd.bottomBarSpace+"px","line-height":this._cd.bottomBarSpace+"px",left:0,bottom:0,right:0,"box-sizing":"border-box",display:this._cd.bottomBarSpace?"flex":"none","justify-content":"space-between"},noCSS:W[".dgxl-bar"].call(this),domNodes:Ke.call(this),_reset:!1}}const Ke=function(){for(var t,e=[],i=0;i<this._validatedBottomBar.length;i++)(t={type:this._validatedBottomBar[i].name,wrapper:void 0,nodes:{}}).wrapper=F.call(this,{name:"part part-"+this._validatedBottomBar[i].name,style:{display:"flex","flex-grow":this._validatedBottomBar[i].grow||0,height:"100%"},children:[this._validatedBottomBar[i].node.call(this)],_reset:!1},t.nodes),e.push(t.wrapper),this._bottomBarNodes.push(t);return e};function We(){return{name:"component theme-"+this.cssTheme,style:{position:"relative","user-select":"none",width:this._cd.componentWidth+"px",height:this._cd.componentHeight+"px",overflow:"hidden","z-index":0,"font-size":this.fontSize,"font-family":this.fontFamily},noCSS:W[".dgxl-component"].call(this),id:"datagridxl_"+this._componentIndex,children:[$t.call(this),Ve.call(this),Ye.call(this)]}}function De(t,e){if(null==t)return[];for(var i=[],s=0;s<t.length;s++){var o=!0;for(var n in e)if(!(n in t[s])||t[s][n]!=e[n]){o=!1;break}o&&i.push(t[s])}return i}function je(t){var e={};for(var i in this.headerLabelSeries)e[i]=this.headerLabelSeries[i].indexToLabel(t,this.headerLabelSeries[i]);return e}function Ue(t){var e=this.getRowIndexById(t),i=this.getRowCoordById(t),s=je.call(this,e),o=this._rows.store[t-1],n=this.rowHeaderLabelFunction.call(this,e,i,o,s);return String(n).replace(/\n/g,"↵").replace(/\t/g," ")}function Ge(t){for(var e,i,s="",o=De(this._selection,{type:"row"}),n=!1,l=0;l<t.length;l++){i=t[l],e=this.getRowCoordById(i);for(var r=0;r<o.length;r++)if(!n&&e>=o[r].range[0].y&&e<=o[r].range[1].y){s+='<span style="color:'+this.getThemeSetting("header:selected|text")+';">',n=!0;break}s+=Ue.call(this,i)+"\n";for(r=0;r<o.length;r++)if(n&&e<=o[r].range[1].y){s+="</span>",n=!1;break}}return n&&(s+="</span>"),s}function $e(){return Ge.call(this,this._panesYids.top)}function Ze(){return Ge.call(this,this._rowView)}function qe(){F.call(this,{name:"rowHeaderColumn",style:{position:"absolute",width:this._cd.rowHeaderSpace+"px",height:this._cd.viewportHeight+"px","line-height":this.rowHeight+"px",overflow:"hidden",contain:"strict","white-space":"pre","font-size":this.fontSize+"px","font-family":this.fontFamily,color:this.getThemeSetting("sheet|text")},children:[Je.call(this)]})}var Je=function(){return{name:"innerColumn",style:{position:"relative","margin-top":this._cd.colHeaderSpace+"px","padding-left":"6px","padding-right":"6px",width:this._cd.rowHeaderSpace+"px","box-sizing":"border-box",color:this.getThemeSetting("header|text"),"white-space":"pre","line-height":this.rowHeight+"px","text-align":this.rowHeaderLabelAlign},children:[{name:"column-top",style:{position:"absolute",top:this._cd.panesY.top.offset+"px",height:this._cd.panesY.top.space+"px",width:this._cd.rowHeaderSpace-12+"px"},html:$e.call(this)},{name:"column-center",style:{position:"absolute",top:this._cd.panesY.center.offset-this._cd.colHeaderSpace+"px",height:this._cd.panesY.center.space+"px",width:this._cd.rowHeaderSpace-12+"px",overflow:"hidden"},html:Ze.call(this)}]}};function Qe(t){var e=this.getColIndexById(t),i=this.getColCoordById(t),s=je.call(this,e),o=this._cols.store[t-1],n=this.colHeaderLabelFunction.call(this,e,i,o,s);return String(n).replace(/\n/g,"↵").replace(/\t/g," ")}function ti(t){return t||""}function ei(t){for(var e="",i=0;i<this._panesYids.top.length;i++)e+=ti.call(this,this._cellStore[this._panesYids.top[i]-1][t-1].value)+"\n";return e}function ii(t){for(var e="",i=0;i<this._rowView.length;i++)e+=ti.call(this,this._cellStore[this._rowView[i]-1][t-1].value)+"\n";return e}function si(t,e){var i=e-1;this._columnNodes[i]={};var s=this._cols.store[i];F.call(this,{name:"column",style:{position:"absolute",width:s.width+"px",height:this._cd.viewportHeight+"px","line-height":this.rowHeight+"px",overflow:"hidden",contain:"layout style","font-size":this.fontSize+"px","font-family":this.fontFamily,color:this.getThemeSetting("sheet|text")},children:[oi.call(this,t,e),ni.call(this,t,e)]},this._columnNodes[i])._colId=s.id}var oi=function(t,e){return{name:"columnHeader",style:{position:"absolute",top:0,left:0,right:0,height:this._cd.colHeaderSpace+"px","line-height":this._cd.colHeaderSpace+"px"},children:[{name:"columnHeaderLabel",style:{position:"absolute",top:0,height:this._colHeaderSpace+"px","line-height":this._colHeaderSpace+"px",left:"6px",right:"6px",color:this.getThemeSetting("header|text"),"text-align":this.colHeaderLabelAlign},html:Qe.call(this,e)},{name:"columnHeaderSortIndicator",style:{position:"absolute",top:0,height:this._cd.colHeaderSpace+"px",width:"12px",right:"2px",color:this.getThemeSetting("header|text")}}]}},ni=function(t,e){var i=this._cols.store[e-1],s={height:this._cd.panesY.top.outer-this._cd.colHeaderSpace+"px","padding-left":"6px","padding-right":"6px",overflow:"hidden"},o={height:this._cd.panesY.center.space+"px","padding-left":"6px","padding-right":"6px",clear:"both"};return"center"==i.align?(s["margin-left"]="-100%",s["margin-right"]="-100%",s["text-align"]="center",o["margin-left"]="-100%",o["margin-right"]="-100%",o["text-align"]="center"):"right"==i.align&&(s.float="right",s["text-align"]="right",o.float="right",o["text-align"]="right"),{name:"innerColumn",style:{position:"relative","margin-top":this._cd.colHeaderSpace+"px",color:this.getThemeSetting("sheet|text"),"white-space":"pre","line-height":this.rowHeight+"px"},children:[{name:"column-top",style:s,text:ei.call(this,e)},{name:"column-center",style:o,text:ii.call(this,e)}]}};function li(){for(var t=0;t<this._cols.store.length;t++)si.call(this,t,this._cols.store[t].id)}function ri(){return{name:"colHeaderRangeHighlight",style:{position:"absolute",top:0,left:0,"background-color":this.getThemeSetting("header:highlight"),"transform-origin":"0 0",width:"100px",height:"100px",opacity:0},_opacity:1}}function hi(){return{name:"colHeaderRangeSelected",style:{position:"absolute",top:0,left:0,"background-color":this.getThemeSetting("header:selected"),"transform-origin":"0 0",width:"100px",height:"100px",opacity:0},_opacity:1}}function ai(){return{name:"rowHeaderRangeHighlight",style:{position:"absolute",top:0,left:0,"background-color":this.getThemeSetting("header:highlight"),"transform-origin":"0 0",width:"100px",height:"100px",opacity:0},_opacity:1}}function ci(){return{name:"rowHeaderRangeSelected",style:{position:"absolute",top:0,left:0,"background-color":this.getThemeSetting("header:selected"),"transform-origin":"0 0",width:"100px",height:"100px",opacity:0},_opacity:1}}function di(){return{name:"hiddenRowGroupIconPrev",style:{position:"absolute",top:0,left:"2px",height:"16px",width:"16px","border-radius":"0 0 2px 2px","border-width":"1px","border-style":"solid","border-top-style":"none","border-color":"transparent","box-sizing":"border-box","font-size":10,"text-align":"center"},html:`\n  <svg height="8" width="8" style="position:absolute;top:4px;left:3px;fill:${this.getThemeSetting("header-icon")};">\n    <polygon points="4,6 0,0 8,0" class="triangle">\n  </svg>`}}function ui(){return{name:"hiddenRowGroupIconNext",style:{position:"absolute",top:0,left:"2px",height:"16px",width:"16px","border-radius":"2px 2px 0 0","border-width":"1px","border-style":"solid","border-bottom-style":"none","border-color":"transparent","box-sizing":"border-box","font-size":10,"text-align":"center"},html:`\n  <svg height="8" width="8" style="position:absolute;bottom:4px;left:3px;fill:${this.getThemeSetting("header-icon")};">\n    <polygon points="4,2 0,8 8,8" class="triangle">\n  </svg>\n  `}}function pi(){var t=`\n  <svg height="8" width="8" style="position:absolute;top:3px;left:4px;fill:${this.getThemeSetting("header-icon")};">\n    <polygon points="6,4 0,0 0,8" class="triangle">\n  </svg>\n  `;return{name:"hiddenColGroupIconPrev",style:{position:"absolute",top:this.colHeaderHeight/2-8+"px",left:0,height:"16px",width:"14px","border-radius":"0 2px 2px 0","border-width":"1px","border-style":"solid","border-left-style":"none","border-color":"transparent","box-sizing":"border-box","font-size":10,"text-align":"center"},html:t}}function fi(){var t=`\n  <svg height="8" width="8" style="position:absolute;top:3px;right:4px;fill:${this.getThemeSetting("header-icon")};">\n    <polygon points="2,4 8,0 8,8" class="triangle">\n  </svg>\n  `;return{name:"hiddenColGroupIconNext",style:{position:"absolute",top:this.colHeaderHeight/2-8+"px",left:0,height:"16px",width:"14px","border-radius":"2px 0 0 2px","border-width":"1px","border-style":"solid","border-right-style":"none","border-color":"transparent","box-sizing":"border-box","font-size":10,"text-align":"center"},html:t}}function gi(){return{style:{position:"absolute",top:0,left:0,"background-color":this.getThemeSetting("cellrange:selected"),"transform-origin":"0 0",width:"100px",height:"100px",opacity:0},_opacity:this.getThemeSetting("cellrange:selected|opacity")}}function _i(){return{name:"cellRangeForeground",style:{position:"absolute",top:0,left:0,"border-width":"thin","border-top-style":"solid","border-bottom-style":"solid","border-left-style":"solid","border-right-style":"solid","border-color":this.getThemeSetting("cellrange:selected|border"),"transform-origin":"0 0","box-sizing":"border-box",width:this.colWidth+1+"px",height:this.rowHeight+1+"px",opacity:0},_opacity:1,_borderStyle:"solid"}}function yi(){return{name:"colLine",style:{position:"absolute",top:0,bottom:0,left:0,width:0,transform:"translateX(0)","border-right":"thin solid "+this.getThemeSetting("gridline"),opacity:1},children:[{style:{position:"absolute",top:0,left:0,height:this._cd.colHeaderSpace+1+"px","border-right":"thin solid "+this.getThemeSetting("gridline-tip")}}]}}function mi(){return{name:"rowLine",style:{position:"absolute",top:0,left:0,right:0,height:0,"border-bottom":"thin solid "+this.getThemeSetting("gridline"),transform:"translateY(0)",opacity:1},children:[{style:{position:"absolute",left:0,top:0,width:this._cd.rowHeaderSpace+1+"px","border-bottom":"thin solid "+this.getThemeSetting("gridline-tip")}}]}}function xi(t){this.resize()}function vi(t,e){if(t in this._listeners&&e in this._listeners[t]){if("document"==t||"window"==t)var i=window[t];else i=this._domNodes[t];var s=e.split("_");1==s.length?i.addEventListener(e,this._listeners[t][e]):"debounced"==s[1]?i.addEventListener(s[0],this._listeners[t][e]):"passive"==s[1]&&i.addEventListener(s[0],this._listeners[t][e],{passive:!0})}}function wi(t,e){if(t in this._listeners&&e in this._listeners[t]){if("document"==t||"window"==t)var i=window[t];else i=this._domNodes[t];i.removeEventListener(e,this._listeners[t][e])}}function Ci(t=!1){this.constructor._isIOS||(this.activeSheetDisplay&&(this._domNodes.cellEditor.style.top=this.getRowPositionInViewport(this._cellCursorPosition.y)+"px",this._domNodes.cellEditor.style.left=this.getColPositionInViewport(this._cellCursorPosition.x)+"px"),t?bi.call(this,this._domNodes.cellEditorInputField):setTimeout(()=>{bi.call(this,this._domNodes.cellEditorInputField)},0))}const bi=function(t){t.value=" ",t.select(),t.setSelectionRange(0,1)};function Si(){"webkitCurrentFullScreenElement"in document?Ii.call(this,"webkitCurrentFullScreenElement"):Ii.call(this,"fullscreenElement"),this.constructor._isTouchDevice||Ci.call(this)}const Ii=function(t){document[t]==this._domNodes.component?Li.call(this):Ri.call(this)},Li=function(){this.activate(),this._isFullscreen=!0,xi.call(this),setTimeout(()=>{vi.call(this,"window","resize"),this._domNodes.container._resizeSensor.events.off("resize",this._listeners.container.resize)},100),Pi.call(this),this.events.dispatch("fullscreenenter")},Ri=function(){(this.constructor._isMacOS||this.constructor._isIOS)&&(this._domNodes.component.style.height=this._cd.containerHeight+"px",this._domNodes.component.style.width=this._cd.containerWidth+"px"),this._isFullscreen=!1,xi.call(this),setTimeout(()=>{wi.call(this,"window","resize"),this._domNodes.container._resizeSensor.events.on("resize",this._listeners.container.resize)},100),this._isActive&&(Ni.call(this),this.events.dispatch("fullscreenleave"))},Pi=function(){this.constructor.contextMenu.isOpen()&&this.constructor.contextMenu.close(),T(this._domNodes.component,[this.constructor._domNodes.contextMenu])},Ni=function(){this.constructor.contextMenu.isOpen()&&this.constructor.contextMenu.close(),T(document.body,[this.constructor._domNodes.contextMenu,this.constructor._domNodes.contextMenuTouch])};function Hi(t){setTimeout(()=>{Si.call(this,t)},100)}function zi(t){setTimeout(()=>{Si.call(this,t)},0)}function ki(t){this.hijackNativeSearchCommand&&70==t.keyCode&&t[this._commandKey]&&Ai.call(this,t)}const Ai=function(t){var e=[...De(this._topBarNodes,{type:"searchBar"}),...De(this._bottomBarNodes,{type:"searchBar"})];e.length&&(t.preventDefault(),this.search(""),e[0].nodes.inputField.focus(),e[0].nodes.inputField.select())};function Ti(t){this.deactivate()}function Fi(t){if(!(this._domNodes.container.contains(t.target)||this.constructor._domNodes.contextMenu.contains(t.target)||this.constructor._domNodes.contextMenuTouch.contains(t.target))){for(var e=document.getElementsByClassName("dgxl-app"),i=0;i<e.length;i++)if(e[i].contains(t.target))return;Ti.call(this,{originalEvent:t})}}function Bi(t){xi.call(this,"window")}function Mi(t){}function Ei(t){this._isFullscreen||xi.call(this,"container")}function Oi(t){"INPUT"!=t.target.tagName&&"TEXTAREA"!=t.target.tagName&&"A"!=t.target.tagName&&"IMG"!=t.target.tagName&&t.preventDefault()}function Xi(t,e){"clipboardData"in t?t.clipboardData.setData("text/plain",e):setTimeout(()=>{window.clipboardData.setData("text",e)},100)}function Vi(t){return null!=t&&(t[0].x==t[1].x&&t[0].y==t[1].y)}function Yi(t){return null==t?null:{x:Ki.call(this,t),y:Wi.call(this,t)}}const Ki=function(t){var e,i,s,o=!1,n=!1,l=0,r=this._cd.rowHeaderSpace,h=0,a=[];for(e=0;e<this._panesXids.left.length;e++)i=e,s=this.getColWidthById(this._panesXids.left[i]),i>=t[0].x&&i<=t[1].x&&(a.push({colIndex:i,visibleColIndex:l,visibleColOffset:r}),h+=s),r+=s,l++;for((this._panesXids.left.length||this._freezeLineColAfterId&&this._sectionsPerPaneX.left.length&&!this._panesXids.left.length)&&(r+=6),e=0;e<this._colView.length;e++)i=this._viewportPosition.x+e,s=this.getColWidthById(this._colView[e]),e==this._colView.length-1&&(s-=Math.max(this._colViewOverflow,0)),i>=t[0].x&&i<=t[1].x&&(a.push({colIndex:i,visibleColIndex:l,visibleColOffset:r}),h+=s),r+=s,l++;if(a.length)var c=a[0].visibleColOffset;else c=0;var d=t[0].x<this._panesXids.left.length,u=t[0].x>=this._viewportPosition.x&&t[0].x<=this._viewportPosition.x+this._colView.length-1;(d||u)&&(o=!0);var p=t[1].x<this._panesXids.left.length,f=t[1].x>=this._viewportPosition.x&&t[1].x<this._viewportPosition.x+this._colView.length-1||t[1].x==this._viewportPosition.x+this._colView.length-1&&this._colViewOverflow<=0,g=t[1].x>=this._viewportPosition.x;return(p||f)&&(n=!0),d&&g&&(h+=6),h&&(h+=1),{offset:c,size:h,lineLeft:o,lineRight:n}},Wi=function(t){var e,i,s,o=!1,n=!1,l=0,r=this._cd.colHeaderSpace,h=0,a=[];for(e=0;e<this._panesYids.top.length;e++)i=e,s=this.getRowHeightById(this._panesYids.top[i]),i>=t[0].y&&i<=t[1].y&&(a.push({rowIndex:i,visibleRowIndex:l,visibleRowOffset:r}),h+=s),r+=s,l++;for((this._panesYids.top.length||this._freezeLineRowAfterId&&this._sectionsPerPaneY.top.length&&!this._panesYids.top.length)&&(r+=6),e=0;e<this._rowView.length;e++)i=this._viewportPosition.y+e,s=this.getRowHeightById(this._rowView[e]),e==this._rowView.length-1&&(s-=Math.max(this._rowViewOverflow,0)),i>=t[0].y&&i<=t[1].y&&(a.push({rowIndex:i,visibleRowIndex:l,visibleRowOffset:r}),h+=s),r+=s,l++;if(a.length)var c=a[0].visibleRowOffset;else c=0;var d=t[0].y<this._panesYids.top.length,u=t[0].y>=this._viewportPosition.y&&t[0].y<=this._viewportPosition.y+this._rowView.length-1;(d||u)&&(o=!0);var p=t[1].y<this._panesYids.top.length,f=t[1].y>=this._viewportPosition.y&&t[1].y<this._viewportPosition.y+this._rowView.length-1||t[1].y==this._viewportPosition.y+this._rowView.length-1&&this._rowViewOverflow<=0,g=t[1].y>=this._viewportPosition.y;return(p||f)&&(n=!0),d&&g&&(h+=6),h&&(h+=1),{offset:c,size:h,lineTop:o,lineBottom:n}};function Di(t,e){var i=t._borderStyle||"solid";if(null!=e){t.style.opacity=t._opacity;var s=Yi.call(this,e),o=i,n=i,l=i,r=i;s.y.lineTop&&0!=s.x.size||(o="none"),s.y.lineBottom&&0!=s.x.size||(n="none"),s.x.lineLeft&&0!=s.y.size||(l="none"),s.x.lineRight&&0!=s.y.size||(r="none"),"_actionProperties"in e&&"dragDirection"in e._actionProperties&&("up"==e._actionProperties.dragDirection?n="none":"right"==e._actionProperties.dragDirection?l="none":"down"==e._actionProperties.dragDirection?o="none":"left"==e._actionProperties.dragDirection&&(r="none")),t.style["border-top-style"]=o,t.style["border-right-style"]=r,t.style["border-bottom-style"]=n,t.style["border-left-style"]=l,s.x.size+=2*t._extra,s.y.size+=2*t._extra,s.x.offset-=t._extra,s.y.offset-=t._extra;var h="translate("+s.x.offset+"px,"+s.y.offset+"px)";t.style.transform=h,t.style.width=s.x.size+"px",t.style.height=s.y.size+"px"}else t.style.opacity=0}function ji(t,e,i={}){"cut"==t?(this._cutRange=e,this._copyRange=null):"copy"==t?(this._copyRange=e,this._cutRange=null):"fill"==t&&(this._fillRange=e,null!=this._fillRange&&(this._fillRange._actionProperties=i)),requestAnimationFrame(()=>{Di.call(this,this._domNodes.copyRange,this._copyRange),Di.call(this,this._domNodes.cutRange,this._cutRange),Di.call(this,this._domNodes.fillRange,this._fillRange)})}function Ui(t={},e=null){var i=this._selection[this._activeRangeIndex].range;if(t={text:this.getCellRangeText(i),cellRange:i},this.events.dispatch("beforecopy",t)){if(null!=this.constructor._clipboardObject&&ji.call(this,this.constructor._clipboardObject.type,null),ji.call(this,"copy",t.cellRange),Vi(i)&&"\n"==t.text)var s=!0;else s=!1;this.constructor._clipboardObject={type:"copy",text:t.text,cellRange:t.cellRange,isSingleEmptyCell:s,instance:this},Xi.call(this,e,t.text),this.events.dispatch("copy",t)}}function Gi(t={},e=null){var i=this._selection[this._activeRangeIndex].range;if(t={text:this.getCellRangeText(i),cellRange:i},this.events.dispatch("beforecut",t)){if(null!=this.constructor._clipboardObject&&ji.call(this,this.constructor._clipboardObject.type,null),this.instantCut)this.clearCellValues(t.cellRange);else{if(ji.call(this,"cut",t.cellRange),Vi(i)&&"\n"==t.text)var s=!0;else s=!1;this.constructor._clipboardObject={type:"cut",text:t.text,cellRange:t.cellRange,isSingleEmptyCell:s,instance:this}}Xi.call(this,e,t.text),this.events.dispatch("cut",t)}}function $i(t){t.preventDefault(),"cut"==this._domNodes.cellEditor._actualCommand?Gi.call(this,{},t):"copy"==this._domNodes.cellEditor._actualCommand?Ui.call(this,{},t):null==this._domNodes.cellEditor._actualCommand&&this.allowCopy&&Ui.call(this,{},t),this._domNodes.cellEditor._actualCommand=void 0}function Zi(t={},e=null){if(this.events.dispatch("beforepaste",t)){var i=t.text;null!=this.constructor._clipboardObject&&"\n"==t.text&&this.constructor._clipboardObject.isSingleEmptyCell&&(i="");var s=function(t){for(var e=0,i=[],s=t.split("\n"),o=0;o<s.length;o++){i.push([]);var n=s[o].split("\t");n.length>e&&(e=n.length);for(var l=0;l<n.length;l++){var r=n[l];r=""==r?null:String(r).replace(/[\n\r\t]/g," "),i[o].push(r)}}for(o=0;o<i.length;o++)if(i[o].length<e)for(;i[o].length<e;)i[o].push(null);return i}(i);if(null!=this.constructor._clipboardObject&&this.constructor._clipboardObject.instance==this&&"cut"==this.constructor._clipboardObject.type&&i==this.constructor._clipboardObject.text)var o=!0;else o=!1;this.events.dispatch("paste",t),this.setCellValues(this._selection,s,!0,o)}}function qi(t){t.preventDefault(),this.allowPaste&&Ji.call(this,t)}const Ji=function(t){if(this.constructor._isIE)var e=window.clipboardData.getData("text");else e=t.clipboardData.getData("text");Zi.call(this,{text:e},t)};function Qi(t){t.preventDefault(),this.allowCut&&Gi.call(this,{},t)}function ts(t){if(t in this.keyActionSets&&t!=this._activeKeyActionSet){if(this._activeKeyActionSet)for(var e=0;e<this.keyActionSets[this._activeKeyActionSet].length;e++){var i=this.keyActionSets[this._activeKeyActionSet][e],s=this._presetKeyActions[i];this.keyActionSets[t].indexOf(i)>-1||this.keys.off(s.keys,s.action,s.repeat,s.target)}for(e=0;e<this.keyActionSets[t].length;e++){i=this.keyActionSets[t][e],s=this._presetKeyActions[i];null!=this._activeKeyActionSet&&this.keyActionSets[this._activeKeyActionSet].indexOf(i)>-1||("active"in s&&!s.active.call(this)||this.keys.on(s.keys,s.action,s.repeat))}this._activeKeyActionSet=t}}function es(t){"edit"!=this._domNodes.cellEditor._mode&&(this._domNodes.cellEditor._mode="edit",ts.call(this,"inputModeEdit"))}function is(){var t=this.getColWidthById(this._cols.coordList[this._domNodes.cellEditor._coords.x]),e=Math.ceil(this._textWidthMeterCanvasContext.measureText(this._domNodes.cellEditorInputField.value).width)+12;this._domNodes.cellEditorInputField.style.width=Math.max(e,t)+1+"px"}function ss(t){"contextMenuOpen"!=this._activeKeyActionSet&&this.allowEditCells&&(this._domNodes.cellEditor._isOpen||this.openCellEditor("enter"),is.call(this),this.events.dispatch("celleditorinput",{value:t.target.value}))}function os(){this._domNodes.display._hasScrolled=!0,this._domNodes.searchCursor.style.transition=""}function ns(t,e){return null==t&&null==e||null!=t&&null!=e&&(n(t)&&n(e)?t.x==e.x&&t.y==e.y:!(!u(t)||!u(e))&&t==e)}function ls(){return this._viewportPosition.y==this._panesYids.top.length}function rs(){return this._viewportPosition.x==this._panesXids.left.length}function hs(t,e={x:0,y:0}){t=cs.call(this,t),as.call(this,t,e)}const as=function(t,e){ns(this._viewportPosition,t)||(this._viewportPosition=t,this._viewportOverflowPx=e,Xt.call(this),Vt.call(this),this._isViewportConnectedTo={top:ls.call(this),left:rs.call(this)})},cs=function(t){return t.x<this._panesXids.left.length&&(t.x=this._panesXids.left.length),t.y<this._panesYids.top.length&&(t.y=this._panesYids.top.length),t.x>this._lastColView.startIndex&&(t.x=this._lastColView.startIndex),t.y>this._lastRowView.startIndex&&(t.y=this._lastRowView.startIndex),t};function ds(t){this._domNodes.display._hasScrolled||os.call(this),this._scrollLeft=Math.round(t.currentTarget.scrollLeft),this._scrollTop=Math.round(t.currentTarget.scrollTop),this._domNodes.display._setViewportPositionOnScroll&&(hs.call(this,{x:this._panesXids.left.length+Math.floor(this._scrollLeft/40),y:this._panesYids.top.length+Math.floor(this._scrollTop/40)}),this.redraw()),this._currentDragAction&&this._domNodes.display[this._currentDragAction+"MoveFunc"].call(this),this._domNodes.display._setViewportPositionOnScroll=!0}function us(){this._domNodes.display._hasScrolled=!1,this._domNodes.searchCursor.style.transition="transform 0.05s"}function ps(t){us.call(this)}function fs(t){if(null==t)return null;var e={};for(var i in t)e[i]=t[i];return e}function gs(t,e){var i=this._domNodes.eventArea.getBoundingClientRect();return{x:Math.round(t-i.left),y:Math.round(e-i.top)}}function _s(t){return t.y<=this._cd.scrollAreaHeight-this._cd.scrollbarSpace?null:{name:"horizontalScrollbar"}}function ys(t){return t.x<=this._cd.scrollAreaWidth-this._cd.scrollbarSpace?null:{name:"verticalScrollbar"}}function ms(t,e=!1){var i,s,o,n=null;if(t<this._cd.rowHeaderSpace)return-1;t<=this._cd.panesX.left.space?(i=this._cd.rowHeaderSpace,s="left",o=this._panesXids.left):(i=this._cd.panesX.center.offset,s="center",o=this._colView);for(var l=i,r=0;l<t&&!(r>o.length-1);)l+=this.getColWidthById(o[r]),r++;(n=r-1,"center"==s&&(n+=this._viewportPosition.x),e)&&(n<0&&(n=0),t-this.getColPositionInViewport(n)>this.getColWidthById(this.getColIdByCoord(n))/2&&n++);return n}function xs(t,e=!1){var i,s,o,n=null;if(t<this._cd.colHeaderSpace)return-1;t<=this._cd.panesY.top.space?(i=this._cd.colHeaderSpace,s="top",o=this._panesYids.top):(i=this._cd.panesY.center.offset,s="center",o=this._rowView);for(var l=i,r=0;l<t&&!(r>o.length-1);)l+=this.getRowHeightById(o[r]),r++;(n=r-1,"center"==s&&(n+=this._viewportPosition.y),e)&&(n<0&&(n=0),t-this.getRowPositionInViewport(n)>this.getRowHeightById(this.getRowIdByCoord(n))/2&&n++);return n}function vs(t){return{x:ms.call(this,t.x),y:xs.call(this,t.y)}}function ws(t){return t.x<=this._cd.rowHeaderSpace&&t.y<=this._cd.colHeaderSpace?{name:"jointHeader",coords:vs.call(this,t)}:null}function Cs(t){if(!this._sectionsPerPaneX.left.length){if(t.y<0||t.y>this._cd.colHeaderSpace)return null;var e=this.getColCoordById(this._freezeLineColAfterId)+1,i=this.getColPositionInViewport(e);return t.x>=i&&t.x<=i+6?{name:"freezeLinePlaceholderCol",coords:{x:e,y:-1},objectPosition:{},object:this._domNodes.freezeLinePlaceholder_col}:null}}function bs(t){if(!this._sectionsPerPaneY.top.length){if(t.x<0||t.x>this._cd.rowHeaderSpace)return null;var e=this.getRowCoordById(this._freezeLineRowAfterId)+1,i=this.getRowPositionInViewport(e);return t.y>=i&&t.y<=i+6?{name:"freezeLinePlaceholderRow",coords:{x:-1,y:e},objectPosition:{},object:this._domNodes.freezeLinePlaceholder_row}:null}}function Ss(t,e){return null!=t&&null!=e&&(n(t)&&l(e)?t.x>=e[0].x&&t.x<=e[1].x&&t.y>=e[0].y&&t.y<=e[1].y:u(t)&&i(e)?t>=e[0]&&t<=e[1]:void 0)}function Is(t){if(t.y>this._cd.colHeaderSpace||this._colViewOverflow<0&&t.x>this._cd.viewportWidth-Math.abs(this._colViewOverflow))return null;var e=vs.call(this,t),i=this.getColRangesFromCoord(e.x);return e.x>=this._cols.coordList.length?null:i.length?{name:"selectedColHeader",coords:e,ranges:i}:null}function Ls(t){return t.y>this._cd.colHeaderSpace?null:{name:"colHeader",coords:vs.call(this,t)}}function Rs(t){if(t.y<0||t.y>this._cd.colHeaderSpace)return null;for(var e=vs.call(this,t),i=null,s=this._cd.rowHeaderSpace,o=0;o<this._panesXids.left.length;o++)if(s+=this.getColWidthById(this._panesXids.left[o]),t.x<=s){t.x>=s-4&&(e.x=o,i={name:"colHeaderEdge",coords:e,objectPosition:{x:s-4,y:0}});break}this._panesXids.left.length&&(s+=6);for(o=0;o<this._colView.length;o++)if(s+=this.getColWidthById(this._colView[o]),t.x<=s){t.x>=s-4&&(e.x=this._viewportPosition.x+o,i={name:"colHeaderEdge",coords:e,objectPosition:{x:s-4,y:0}});break}return i}function Ps(t){return"string"!=typeof t?"":t.charAt(0).toUpperCase()+t.slice(1)}function Ns(t){var e="allow"+Ps(t.slice(0,-5));return t.endsWith("touch")&&e.slice(0,-5),this[e]||!0}function Hs(t){if(!Ns.call(this,"freezeCols")||this._freezeLineColAfterId&&!this._sectionsPerPaneX.left.length)return null;var e=this._cd.panesX.center.offset-6;if(t.x<e||t.x>e+6)return null;var i=vs.call(this,t);return i.x=this._viewportPosition.x,{name:"freezeLineCol",objectPosition:{x:e,y:0},coords:i}}function zs(t){var e=(this.colHeaderHeight-16)/2;if(t.y<e||t.y>this.colHeaderHeight-e)return null;var i=null,s=vs.call(this,t),o=this.getColPositionInViewport(s.x),n=this.getColIdByCoord(s.x);if(s.x>=this._cols.iconList.length)return null;if(null!==this._cols.iconList[s.x][0]&&t.x>=o&&t.x<=o+14){var l=s.x-1,r=this.getColIdByCoord(l),h=l<0?null:{x:this.getColPositionInViewport(l)+this.getColWidthById(r)-14+1,y:0};i={name:"hiddenColGroupIcon",coords:s,type:"prev",groupIndex:this._cols.iconList[s.x][0],objectPositionNext:h,objectPositionPrev:{x:o,y:0}}}else if(null!==this._cols.iconList[s.x][1]&&t.x>=o+this.getColWidthById(n)-14+1&&t.x<=o+this.getColWidthById(n)){var a=s.x+1;this.getColIdByCoord(a);var c=a>this._cols.coordList.length-1?null:{x:this.getColPositionInViewport(a),y:0};i={name:"hiddenColGroupIcon",coords:s,type:"next",groupIndex:this._cols.iconList[s.x][1],objectPositionNext:{x:o+this.getColWidthById(n)-14+1,y:0},objectPositionPrev:c}}return i}function ks(t){if(t.x<2||t.x>18)return null;var e=null,i=vs.call(this,t),s=this.getRowPositionInViewport(i.y),o=this.getRowIdByCoord(i.y);if(i.y>=this._rows.iconList.length)return null;if(null!==this._rows.iconList[i.y][0]&&t.y>=s&&t.y<=s+16){var n=i.y-1,l=this.getRowIdByCoord(n),r=n<0?null:{x:0,y:this.getRowPositionInViewport(n)+this.getRowHeightById(l)-16+1};e={name:"hiddenRowGroupIcon",coords:i,type:"prev",groupIndex:this._rows.iconList[i.y][0],objectPositionNext:r,objectPositionPrev:{x:0,y:s}}}else if(null!=this._rows.iconList[i.y][1]&&t.y>=s+this.getRowHeightById(o)-16+1&&t.y<=s+this.getRowHeightById(o)){var h=i.y+1;this.getRowIdByCoord(h);var a=h>this._rows.coordList.length-1?null:{x:0,y:this.getRowPositionInViewport(h)};e={name:"hiddenRowGroupIcon",coords:i,type:"next",groupIndex:this._rows.iconList[i.y][1],objectPositionNext:{x:0,y:s+this.getRowHeightById(o)-16+1},objectPositionPrev:a}}return e}function As(t){if(t.x>this._cd.rowHeaderSpace||this._rowViewOverflow<0&&t.y>this._cd.viewportHeight-Math.abs(this._rowViewOverflow))return null;var e=vs.call(this,t),i=this.getRowRangesFromCoord(e.y);return i.length?{name:"selectedRowHeader",coords:e,ranges:i}:null}function Ts(t){return t.x>this._cd.rowHeaderSpace?null:{name:"rowHeader",coords:vs.call(this,t)}}function Fs(t){if(!Ns.call(this,"freezeRows")||this._freezeLineRowAfterId&&!this._sectionsPerPaneY.top.length)return null;var e=this._cd.panesY.center.offset-6;if(t.y<e||t.y>e+6)return null;var i=vs.call(this,t);return i.y=this._viewportPosition.y,{name:"freezeLineRow",objectPosition:{x:0,y:e},coords:i}}function Bs(t){return t.x<this._cd.rowHeaderSpace||t.y<this._cd.colHeaderSpace?null:{name:"cell",coords:vs.call(this,t)}}function Ms(t){if(null==this._selection||0==this._selection.length)return null;var e=null,i=this._selection[this._selection.length-1].range,s=this.getColPositionInViewport(i[1].x),o=this.getRowPositionInViewport(i[1].y),n=this.getColWidthById(this.getColIdByCoord(i[1].x)),l=this.getRowHeightById(this.getRowIdByCoord(i[1].y));if(null==s||null==o)return null;var r=o+l-4,h=o+l+4,a=s+n-4,c=s+n+4;return t.x>=a&&t.x<=c&&t.y>=r&&t.y<=h&&(e={name:"fillHandle",coords:{x:i[1].x,y:i[1].y}}),e}function Es(t=null,e="mouse"){if(null==t)return null;var i,s,o,n,l,r,h,a,c,d,u,p,f,g,_,y,m=null;return(i=_s.call(this,t))?m=i:(s=ys.call(this,t))?m=s:this.allowFillCells&&(_=Ms.call(this,t))?m=_:this.allowFreezeCols&&(r=Hs.call(this,t))?m=r:this.allowFreezeRows&&(u=Fs.call(this,t))?m=u:this.allowFreezeCols&&(n=Cs.call(this,t))?m=n:this.allowFreezeRows&&(l=bs.call(this,t))?m=l:(o=ws.call(this,t))?m=o:(a=zs.call(this,t))?m=a:"touch"!=e&&this.allowResizeCols&&(h=Rs.call(this,t))?m=h:this.allowMoveCols&&(c=Is.call(this,t))?m=c:(d=Ls.call(this,t))?m=d:(p=ks.call(this,t))?m=p:this.allowMoveRows&&(f=As.call(this,t))?m=f:(g=Ts.call(this,t))?m=g:(y=Bs.call(this,t))&&(m=y),null!=m&&("coords"in m&&(m.colSection=this.getColSectionFromCellCoords(m.coords),m.rowSection=this.getRowSectionFromCellCoords(m.coords),m.paneX=this.getPanePositionXfromCellCoords(m.coords),m.paneY=this.getPanePositionYfromCellCoords(m.coords)),m.pointerPositionPx=t),m}function Os(t,e){3!=t.which&&this.showColsById(this._cols.hiddenGroups[e.groupIndex])}function Xs(t,e){3!=t.which&&this.showRowsById(this._rows.hiddenGroups[e.groupIndex])}function Vs(t,e){this.selectAll()}function Ys(t){return[t[0].y,t[1].y]}function Ks(t){this._domNodes.ghostForMoveRows.style.transform="translateY("+t+"px)"}function Ws(t){N(this._domNodes.ghostForMoveRows,{height:wt.call(this,t)+"px",opacity:this._domNodes.ghostForMoveRows._opacity}),Ks.call(this,this.getRowPositionInViewport(t[0]))}function Ds(){this._domNodes.ghostForMoveRows.style.opacity=0}function js(t){if(t<this._rows.coordList.length)var e=this.getRowPositionInViewport(t);else{var i=this._rows.coordList.length-1;e=this.getRowPositionInViewport.call(this,i);e+=this.getRowHeightById(this._rows.coordList[i])}this._domNodes.guideForMoveRows.style.transform="translateY("+e+"px)"}function Us(t){N(this._domNodes.guideForMoveRows,{width:this._cd.viewportWidth+"px",opacity:this._domNodes.guideForMoveRows._opacity}),js.call(this,t[0])}function Gs(){this._domNodes.guideForMoveRows.style.opacity=0}var $s={start:function(t){t.pointerOffset=t.pointerPositionPx.y-this.getRowPositionInViewport(t.ranges[t.ranges.length-1].range[0].y)},move:function(t){var e,i=t.pointerPositionPx.y-t.pointerOffset,s=wt.call(this,t.range);i<this._cd.colHeaderSpace&&(i=this._cd.colHeaderSpace),i>this._cd.viewportHeight-s&&(i=this._cd.viewportHeight),(e=Ss(t.pointerPosition.y,t.range)?t.range[0]:t.pointerPosition.y<t.range[0]?t.pointerPosition.y:t.pointerPosition.y+1)<0&&(e=0),t.endCoord=e||0,requestAnimationFrame(()=>{Ks.call(this,i),js.call(this,e)})},end:function(t){this.moveRows(t.range,t.endCoord)},prepare:function(t){var e=t.ranges[t.ranges.length-1];t.range=Ys.call(this,e.range),requestAnimationFrame(()=>{Ws.call(this,t.range),Us.call(this,t.range)})},release:function(t){requestAnimationFrame(()=>{Ds.call(this),Gs.call(this)})}};function Zs(t,e,i){return Math.min(Math.max(t,e),i)}function qs(t){this._domNodes.ghostForFreezeRows.style.transform="translateY("+t+"px)"}function Js(t){N(this._domNodes.ghostForFreezeRows,{opacity:this._domNodes.ghostForFreezeRows._opacity}),qs.call(this,t)}function Qs(){this._domNodes.ghostForFreezeRows.style.opacity=0}function to(t){if(t<this._rows.coordList.length)var e=this.getRowPositionInViewport(t);0!=t&&t!=this._panesYids.top.length||(e-=6),this._domNodes.guideForFreezeRows.style.transform="translateY("+e+"px)"}function eo(t){N(this._domNodes.guideForFreezeRows,{width:this._cd.viewportWidth+"px",opacity:this._domNodes.guideForFreezeRows._opacity}),to.call(this,t)}function io(){this._domNodes.guideForFreezeRows.style.opacity=0}var so=(()=>{const t=function(t){t.ghostPositionPx=t.pointerPositionPx.y-t.pointerOffset-1,t.endCoord=Zs(xs.call(this,t.pointerPositionPx.y,!0),0,this._rows.coordList.length-1)};return{start:function(t){this._domNodes.scrollArea.scrollTop=0},move:function(e){t.call(this,e),requestAnimationFrame(()=>{qs.call(this,e.ghostPositionPx),to.call(this,e.endCoord)})},end:function(t){this.freezeRows(this.getRowIndexByCoord(t.endCoord))},prepare:function(e){var i=e.pointerPositionPx.y;i-=this.getRowPositionInViewport(e.coords.y),(this._panesYids.top.length||null==this._freezeLineRowAfterId)&&(i+=6),e.pointerOffset=i,t.call(this,e),requestAnimationFrame(()=>{Js.call(this,e.ghostPositionPx),eo.call(this,e.coords.y)})},release:function(t){requestAnimationFrame(()=>{Qs.call(this),io.call(this)})}}})();function oo(t){this._domNodes.ghostForFreezeCols.style.transform="translateX("+t+"px)"}function no(t){N(this._domNodes.ghostForFreezeCols,{opacity:this._domNodes.ghostForFreezeCols._opacity}),oo.call(this,t)}function lo(){this._domNodes.ghostForFreezeCols.style.opacity=0}function ro(t){if(t<this._cols.coordList.length)var e=this.getColPositionInViewport(t);0!=t&&t!=this._panesXids.left.length||(e-=6),this._domNodes.guideForFreezeCols.style.transform="translateX("+e+"px)"}function ho(t){N(this._domNodes.guideForFreezeCols,{height:this._cd.viewportHeight+"px",opacity:this._domNodes.guideForFreezeCols._opacity}),ro.call(this,t)}function ao(){this._domNodes.guideForFreezeCols.style.opacity=0}var co=(()=>{const t=function(t){t.ghostPositionPx=t.pointerPositionPx.x-t.pointerOffset-1,t.endCoord=Zs(ms.call(this,t.pointerPositionPx.x,!0),0,this._cols.coordList.length-1)};return{start:function(t){this._domNodes.scrollArea.scrollLeft=0},move:function(e){t.call(this,e),requestAnimationFrame(()=>{oo.call(this,e.pointerPositionPx.x),ro.call(this,e.endCoord)})},end:function(t){this.freezeCols(this.getColIndexByCoord(t.endCoord))},prepare:function(e){var i=e.pointerPositionPx.x;i-=this.getColPositionInViewport(e.coords.x),(this._panesXids.left.length||null==this._freezeLineColAfterId)&&(i+=6),e.pointerOffset=i,t.call(this,e),requestAnimationFrame(()=>{no.call(this,e.ghostPositionPx),ho.call(this,e.coords.x)})},release:function(t){requestAnimationFrame(()=>{lo.call(this),ao.call(this)})}}})();function uo(t){return[t[0].x,t[1].x]}function po(t){this._domNodes.guideForResizeCols.style.transform="translateX("+t+"px)"}function fo(t){this._domNodes.guideForResizeCols.style.opacity=this._domNodes.guideForResizeCols._opacity,po.call(this,t)}function go(){this._domNodes.guideForResizeCols.style.opacity=0}function _o(t,e){if(null==t||null==e)return!1;for(var i=!1,s=0;s<e.length;s++)if(Ss(t,e[s])){i=!0;break}return i}var yo=(()=>{const t=function(t){var e=t.pointerPositionPx.x-(t.pointerOffset-1),i=this._cd.viewportWidth,s=this.getColPositionInViewport(t.coords.x)+32-4;e<s?e=s:e+4>i&&(e=i-3),e<this._cd.rowHeaderSpace&&(e=this._cd.rowHeaderSpace),t.guidePositionPx=e,t.size=e-this.getColPositionInViewport(t.coords.x)};return{start:function(t){},move:function(e){t.call(this,e),requestAnimationFrame(()=>{po.call(this,e.guidePositionPx)})},end:function(t){_o(t.coords.x,this.getColSelection())?this.resizeCols(this.getColSelection(),t.size):this.resizeCols(t.coords.x,t.size)},prepare:function(e){var i=e.pointerPositionPx.x;i-=this.getColPositionInViewport(e.coords.x),i-=this.getColWidthById(this._cols.coordList[e.coords.x])-4,e.pointerOffset=i,t.call(this,e),requestAnimationFrame(()=>{fo.call(this,e.guidePositionPx)})},release:function(t){requestAnimationFrame(()=>{go.call(this)})}}})();function mo(t){this._domNodes.ghostForMoveCols.style.transform="translateX("+t+"px)"}function xo(t){N(this._domNodes.ghostForMoveCols,{width:xt.call(this,t)+"px",opacity:this._domNodes.ghostForMoveCols._opacity}),mo.call(this,this.getColPositionInViewport(t[0]))}function vo(){this._domNodes.ghostForMoveCols.style.opacity=0}function wo(t){if(t<this._cols.coordList.length)var e=this.getColPositionInViewport(t);else{var i=this._cols.coordList.length-1;e=this.getColPositionInViewport.call(this,i);e+=this.getColWidthById(this._cols.coordList[i])}this._domNodes.guideForMoveCols.style.transform="translateX("+e+"px)"}function Co(t){N(this._domNodes.guideForMoveCols,{height:this._cd.viewportHeight+"px",opacity:this._domNodes.guideForMoveCols._opacity}),wo.call(this,t[0])}function bo(){this._domNodes.guideForMoveCols.style.opacity=0}function So(t,e="document",i=null){if(null==t)return null;var s={x:t.x,y:t.y};if("document"==e)var o=Io.call(this);else if("cellSelection"==e){if(null==i)var n=this._selection[this._activeRangeIndex].range;else n=this._selection[i].range;if(null!=n)o=Lo.call(this,n);else o=Io.call(this,n)}var l=s.y<o.top,r=s.x>o.right,h=s.y>o.bottom,a=s.x<o.left;return l&&(s.y=o.top),a&&(s.x=o.left),r&&(s.x=o.right),h&&(s.y=o.bottom),s}const Io=function(){return{top:0,right:this._cols.coordList.length-1,bottom:this._rows.coordList.length-1,left:0}},Lo=function(t){return{top:t[0].y,right:t[1].x,bottom:t[1].y,left:t[0].x}};function Ro(t){if(null==t)return null;if(i(t)){if(u(t[0])){var e=null,s=null;if(1==t.length)var o=t[0];else o=t[1];return t[0]>o?(e=o,s=t[0]):(e=t[0],s=o),[e,s]}var n={x:null,y:null},l={x:null,y:null};return t[0].x<t[1].x?(n.x=t[0].x,l.x=t[1].x):(n.x=t[1].x,l.x=t[0].x),t[0].y<t[1].y?(n.y=t[0].y,l.y=t[1].y):(n.y=t[1].y,l.y=t[0].y),[n,l]}return u(t)?[t,t]:null}var Po={start:function(t){},move:function(t){var e=No.call(this,t.pointerPosition);t.dragDirection=e.dragDirection,t.dragAmount=e.dragAmount,ji.call(this,"fill",e.targetCellRange,t)},end:function(t){if(null!=t.dragDirection&&null!=t.dragAmount){var e=this._selection[this._selection.length-1].range;this.fillCells(e,t.dragDirection,t.dragAmount)}},prepare:function(t){},release:function(t){}};const No=function(t){var e=this._selection[this._selection.length-1].range,i=0,s=0,o="",n="";if(t.y<e[0].y){var l=e[0].y-1;i=e[0].y-t.y,n="up"}else if(t.y>e[1].y){l=e[1].y+1;i=t.y-e[1].y,n="down"}if(t.x<e[0].x){var r=e[0].x-1;s=e[0].x-t.x,o="left"}else if(t.x>e[1].x){r=e[1].x+1;s=t.x-e[1].x,o="right"}if("xy"==this.fillCellsDirection){if(0==s&&0==i)return{dragDirection:void 0,dragAmount:void 0,targetCellRange:null};if(i>=s){var h={x:e[0].x,y:l},a={x:e[1].x,y:t.y};c=n,d=i}else{h={x:r,y:e[0].y},a={x:t.x,y:e[1].y};c=o,d=s}}else if("y"==this.fillCellsDirection){if(0==i)return{dragDirection:void 0,dragAmount:void 0};h={x:e[0].x,y:l},a={x:e[1].x,y:t.y};var c=n,d=i}else if("x"==this.fillCellsDirection){if(0==s)return{dragDirection:void 0,dragAmount:void 0};h={x:r,y:e[0].y},a={x:t.x,y:e[1].y},c=o,d=s}return{dragDirection:c,dragAmount:d,targetCellRange:Ro([h,a=So.call(this,a)])}};var Ho={resizeCols:{handler:yo,edgeDetection:!1},freezeCols:{handler:co,edgeDetection:!1},moveCols:{handler:{start:function(t){t.pointerOffset=t.pointerPositionPx.x-this.getColPositionInViewport(t.ranges[t.ranges.length-1].range[0].x)},move:function(t){var e,i=t.pointerPositionPx.x-t.pointerOffset,s=xt.call(this,t.range);i<this._cd.rowHeaderSpace&&(i=this._cd.rowHeaderSpace),i>this._cd.viewportWidth-s&&(i=this._cd.viewportWidth-s),(e=Ss(t.pointerPosition.x,t.range)?t.range[0]:t.pointerPosition.x<t.range[0]?t.pointerPosition.x:t.pointerPosition.x+1)<0&&(e=0),t.endCoord=e||0,requestAnimationFrame(()=>{mo.call(this,i),wo.call(this,e)})},end:function(t){this.moveCols(t.range,t.endCoord)},prepare:function(t){var e=t.ranges[t.ranges.length-1];t.range=uo.call(this,e.range),requestAnimationFrame(()=>{xo.call(this,t.range),Co.call(this,t.range)})},release:function(t){requestAnimationFrame(()=>{vo.call(this),bo.call(this)})}},edgeDetection:"x"},moveRows:{handler:$s,edgeDetection:"y"},freezeRows:{handler:so,edgeDetection:!1},fillCells:{handler:Po,edgeDetection:"xy"},selectCells:{handler:{start:function(t){},move:function(t){var e=!t.e[this._commandKey];this.setCellRangeExtreme(t.pointerPosition,e)},end:function(t){},prepare:function(t){},release:function(t){}},edgeDetection:"xy"},selectRows:{handler:{start:function(t){},move:function(t){var e=!t.e[this._commandKey];this.setRowRangeExtreme(t.pointerPosition.y,e)},end:function(t){},prepare:function(t){},release:function(t){}},edgeDetection:"y"},selectCols:{handler:{start:function(t){},move:function(t){var e=!t.e[this._commandKey];this.setColRangeExtreme(t.pointerPosition.x,e)},end:function(t){},prepare:function(t){},release:function(t){}},edgeDetection:"x"}};function zo(){window.getSelection?window.getSelection().removeAllRanges():document.selection&&document.selection.empty()}function ko(){}function Ao(){this._domNodes.hintForResizeCols.style.opacity=0}function To(){this._domNodes.hintForFreezeCols.style.opacity=0}function Fo(){this._domNodes.hintForFreezeRows.style.opacity=0}function Bo(){for(var t=["next","prev"],e=0;e<t.length;e++)N(this._domNodes["hintForShowCols"+Ps(t[e])],{opacity:0})}function Mo(){for(var t=["next","prev"],e=0;e<t.length;e++)N(this._domNodes["hintForShowRows"+Ps(t[e])],{opacity:0})}function Eo(){requestAnimationFrame(()=>{Ao.call(this),To.call(this),Fo.call(this),Bo.call(this),Mo.call(this)}),this._hoverArea=null}function Oo(t=null){if(null==t)return this._domNodes.eventArea.style.cursor="",void(this._domNodes.eventArea._mouseCursorState=null);var e=this.mouseCursorStatesDrag[t];e&&(this._domNodes.eventArea.style.cursor=e)}function Xo(t,e,i,s){if(-1==s.indexOf("center"))return 0;var o=0,n=this._cd.panesX.left.space,l=n+this._cd.panesX.center.space;return t>l?o=t-l:t<n&&(o=t-n),o}function Vo(t,e,i,s){if(-1==s.indexOf("center"))return 0;var o=0,n=this._cd.panesY.center.offset,l=n+this._cd.panesY.center.space;return t>l?o=t-l:t<n&&(o=t-n),o}function Yo(t="xy"){var e=Math.floor(this._edgeOffsetX/2),i=Math.floor(this._edgeOffsetY/2);this._edgeOffsetX<-40?e=-40:this._edgeOffsetX>40&&(e=40),this._edgeOffsetY<-40?i=-40:this._edgeOffsetY>40&&(i=40),0!=this._edgeOffsetX&&"y"!=t&&(this._domNodes.scrollArea.scrollLeft+=e),0!=this._edgeOffsetY&&"x"!=t&&(this._domNodes.scrollArea.scrollTop+=i),this._domNodes.display._edgeDetectTimeout=setTimeout(this._domNodes.display._edgeDetectFunction,50)}function Ko(t="xy"){this._edgeOffsetX=0,this._edgeOffsetY=0,t&&(this._domNodes.display._edgeDetectFunction=Yo.bind(this,t),this._domNodes.display._edgeDetectTimeout=setTimeout(this._domNodes.display._edgeDetectFunction,50))}function Wo(t=null){if(null==t)return this._domNodes.eventArea.style.cursor="",void(this._domNodes.eventArea._mouseCursorState=null);var e=this.mouseCursorStatesIdle[t];e&&(this._domNodes.eventArea.style.cursor=e)}function Do(t){N(this._domNodes.hintForResizeCols,{transform:"translateX("+t+"px)",opacity:this._domNodes.hintForResizeCols._opacity})}function jo(t){N(this._domNodes.hintForFreezeCols,{transform:"translateX("+t+"px)",opacity:this._domNodes.hintForFreezeCols._opacity})}function Uo(t){N(this._domNodes.hintForFreezeRows,{transform:"translateY("+t+"px)",opacity:this._domNodes.hintForFreezeRows._opacity})}function Go(t){for(var e,i=["next","prev"],s=0;s<i.length;s++){e=this._domNodes["hintForShowCols"+Ps(i[s])];var o=t["objectPosition"+Ps(i[s])];N(e,null==o?{opacity:0}:{transform:"translateX("+o.x+"px)",opacity:e._opacity})}}function $o(t){for(var e,i=["next","prev"],s=0;s<i.length;s++){e=this._domNodes["hintForShowRows"+Ps(i[s])];var o=t["objectPosition"+Ps(i[s])];N(e,null==o?{opacity:0}:{transform:"translateY("+o.y+"px)",opacity:e._opacity})}}function Zo(t=null){null==t&&(t=this._pointerPositionPx);var e=Es.call(this,t);Ao.call(this),To.call(this),Fo.call(this),Bo.call(this),Mo.call(this),null==e?Wo.call(this,"default"):("hiddenRowGroupIcon"==e.name?$o.call(this,e):"hiddenColGroupIcon"==e.name&&Go.call(this,e),"colHeaderEdge"==e.name?Do.call(this,e.objectPosition.x):e.name.startsWith("freezeLineCol")?jo.call(this,e.objectPosition.x):e.name.startsWith("freezeLineRow")&&Uo.call(this,e.objectPosition.y),Wo.call(this,e.name))}function qo(){null!=this._domNodes.display._edgeDetectTimeout&&(clearTimeout(this._domNodes.display._edgeDetectTimeout),this._domNodes.display._edgeDetectTimeout=null),this._edgeOffsetX=0,this._edgeOffsetY=0}function Jo(t){qo.call(this),document.removeEventListener("mousemove",this._domNodes.display[t+"MoveFunc"]),document.removeEventListener("mouseup",this._domNodes.display[t+"EndFunc"]),this._currentDragAction=null,Zo.call(this,this._domNodes.display[t+"Properties"].pointerPositionPx),vi.call(this,"eventArea","mousemove"),vi.call(this,"eventArea","mouseleave"),this.redraw()}function Qo(t,e={x:0,y:0}){t=sn.call(this,t),tn.call(this,t,e),en.call(this,t,e)}const tn=function(t,e){ns(this._viewportPosition,t)||(this._viewportPosition=t,this._viewportOverflowPx=e,Xt.call(this),Vt.call(this),this._isViewportConnectedTo={top:ls.call(this),left:rs.call(this)})},en=function(t,e){this._domNodes.display._setViewportPositionOnScroll=!1;var i=40*(t.x-this._panesXids.left.length),s=40*(t.y-this._panesYids.top.length);this._domNodes.scrollArea.scrollLeft=i,this._domNodes.scrollArea.scrollTop=s},sn=function(t){return t.x<this._panesXids.left.length&&(t.x=this._panesXids.left.length),t.y<this._panesYids.top.length&&(t.y=this._panesYids.top.length),t.x>this._lastColView.startIndex&&(t.x=this._lastColView.startIndex),t.y>this._lastRowView.startIndex&&(t.y=this._lastRowView.startIndex),t};function on(t,e,i){t in Ho&&("allow"+Ps(t)in this&&!this["allow"+Ps(t)]||(i.panesY=[i.paneY],i.panesX=[i.paneX],zo.call(this),ko.call(this),this._domNodes.display[t+"Properties"]=fs(i),this._domNodes.display[t+"Flags"]={hasMoved:!1},t+"MoveFunc"in this._domNodes.display||nn.call(this,t,e,i),t+"EndFunc"in this._domNodes.display||ln.call(this,t,e,i),wi.call(this,"eventArea","mousemove"),wi.call(this,"eventArea","mouseleave"),Eo.call(this),Oo.call(this,t),this._currentDragAction=t,Ho[t].handler.prepare.call(this,this._domNodes.display[t+"Properties"]),document.addEventListener("mousemove",this._domNodes.display[t+"MoveFunc"]),document.addEventListener("mouseup",this._domNodes.display[t+"EndFunc"])))}const nn=function(t,e,i){this._domNodes.display[t+"MoveFunc"]=function(e=null){var i=this._domNodes.display[t+"Properties"],s=this._domNodes.display[t+"Flags"];if(null!=e&&(i.e=e),s.hasMoved||(Ko.call(this,Ho[t].edgeDetection),Ho[t].handler.start.call(this,i),s.hasMoved=!0),null==e)var o=i.pointerPositionPx;else o=gs.call(this,e.clientX,e.clientY);this._pointerPositionPx=o;var n=i.paneY,l=i.paneX,r=vs.call(this,this._pointerPositionPx),h=this.getPanePositionXfromCellCoords(r),a=this.getPanePositionYfromCellCoords(r),c=this.getColSectionFromCellCoords(r),d=this.getRowSectionFromCellCoords(r),u=null,p=null;"top"==i.paneY&&"center"==a&&!this._isViewportConnectedTo.top&&Ho[t].edgeDetection.includes("y")&&1==i.panesY.length&&(u=this._panesYids.top.length),"left"==i.paneX&&"center"==h&&!this._isViewportConnectedTo.left&&Ho[t].edgeDetection.includes("x")&&1==i.panesX.length&&(p=this._panesXids.left.length),i.panesY.indexOf("center")>-1&&"top"==a&&!this._isViewportConnectedTo.top&&(r.y=this._viewportPosition.y),i.panesX.indexOf("center")>-1&&"left"==h&&!this._isViewportConnectedTo.left&&(r.x=this._viewportPosition.x),null===p&&null===u||Qo.call(this,{x:null!==p?p:this._viewportPosition.x,y:null!==u?u:this._viewportPosition.y}),null!==u&&(i.pointerPosition.y=xs.call(this,o.y)),null!==p&&(i.pointerPosition.x=ms.call(this,o.x)),i.pointerPositionPx=o,i.pointerPosition=r,i.newPaneX=h,i.newPaneY=a,this._isViewportConnectedTo.top&&"top"==a?i.panesY=["top"]:a!=i.panesY[i.panesY.length-1]&&i.panesY.push(a),this._isViewportConnectedTo.left&&"left"==h?i.panesX=["left"]:h!=i.panesX[i.panesX.length-1]&&i.panesX.push(h),i.newColSection=c,i.newRowSection=d,Ho[t].handler.move.call(this,i),this._edgeOffsetX=Xo.call(this,o.x,l,h,i.panesX),this._edgeOffsetY=Vo.call(this,o.y,n,a,i.panesY)}.bind(this)},ln=function(t,e,i){this._domNodes.display[t+"EndFunc"]=function(e){Jo.call(this,t),Ho[t].handler.release.call(this,this._domNodes.display[t+"Properties"]),this._domNodes.display[t+"Flags"].hasMoved&&Ho[t].handler.end.call(this,this._domNodes.display[t+"Properties"]),delete this._domNodes.display[t+"Properties"]}.bind(this)};function rn(t,e){3!=t.which&&on.call(this,"freezeRows",t,e)}function hn(t,e){3!=t.which&&on.call(this,"moveRows",t,e)}function an(t,e){3==t.which&&this.getRowRangesFromCoord(e.coords.y).length||("mouse"==e.pointer?(t.shiftKey?this.setRowRangeExtreme(e.coords.y,!0):t[this._commandKey]?this.addRowRangeToSelection([e.coords.y,e.coords.y]):this.setRowSelection(e.coords.y,!0,!1),on.call(this,"selectRows",t,e)):"touch"==e.pointer&&this.setRowSelection(e.coords.y,!0,!1))}function cn(t,e){3!=t.which&&on.call(this,"freezeCols",t,e)}function dn(t,e){3!=t.which&&on.call(this,"resizeCols",t,e)}function un(t,e){3!=t.which&&on.call(this,"moveCols",t,e)}function pn(t,e){3==t.which&&this.getColRangesFromCoord(e.coords.x).length||("mouse"==e.pointer?(t.shiftKey?this.setColRangeExtreme(e.coords.x,!0):t[this._commandKey]?this.addColRangeToSelection([e.coords.x,e.coords.x]):this.setColSelection(e.coords.x,!0,!1),on.call(this,"selectCols",t,e)):"touch"==e.pointer&&this.setColSelection(e.coords.x,!0,!1))}function fn(t,e){3!=t.which&&on.call(this,"freezeCols",t,e)}function gn(t,e){3!=t.which&&on.call(this,"freezeRows",t,e)}function _n(t,e){3==t.which&&this.getAnyRangesFromCellCoords(e.coords).length||("mouse"==e.pointer?(t.shiftKey?this.setCellRangeExtreme(e.coords,!0):t[this._commandKey]?this.addCellRangeToSelection([e.coords,e.coords]):this.setCellSelection(e.coords),on.call(this,"selectCells",t,e)):this.setCellSelection(e.coords))}function yn(t,e){3==t.which&&this.getAnyRangesFromCellCoords(e.coords).length||on.call(this,"fillCells",t,e)}function mn(t){var e=gs.call(this,t.clientX,t.clientY),i=Es.call(this,e);this._domNodes.display._initialMouseHitArea=fs(i),null!=i&&(i.pointer="mouse","jointHeader"==i.name?Vs.call(this,t,i):"fillHandle"==i.name?yn.call(this,t,i):"freezeLinePlaceholderCol"==i.name?fn.call(this,t,i):"freezeLinePlaceholderRow"==i.name?gn.call(this,t,i):"freezeLineRow"==i.name?rn.call(this,t,i):"hiddenRowGroupIcon"==i.name?Xs.call(this,t,i):"selectedRowHeader"==i.name?hn.call(this,t,i):"rowHeader"==i.name?an.call(this,t,i):"freezeLineCol"==i.name?cn.call(this,t,i):"hiddenColGroupIcon"==i.name?Os.call(this,t,i):"colHeaderEdge"==i.name?dn.call(this,t,i):"selectedColHeader"==i.name?un.call(this,t,i):"colHeader"==i.name?pn.call(this,t,i):"cell"==i.name&&_n.call(this,t,i))}function xn(t){this._domNodes.display._touchStartFired?this._domNodes.display._touchStartFired=!1:mn.call(this,t)}function vn(t){this._pointerPositionPx=gs.call(this,t.clientX,t.clientY),this._pointerPosition=vs.call(this,this._pointerPositionPx),Zo.call(this,this._pointerPositionPx)}function wn(t){Eo.call(this)}function Cn(t){if(!(t.ctrlKey||t.metaKey||t.shiftKey)){var e=this._domNodes.display._initialMouseHitArea;if(e){this._pointerPositionPx=gs.call(this,t.clientX,t.clientY);var i=Es.call(this,this._pointerPositionPx);null!=i&&(this.allowResizeCols&&"colHeaderEdge"==i.name&&"colHeaderEdge"==e.name&&ns(i.coords.x,e.coords.x)?_o(i.coords.x,this.getColSelection())?this.resizeColsToFit(this.getColSelection()):this.resizeColsToFit(i.coords.x):this.allowEditCells&&"cell"==i.name&&"cell"==e.name&&ns(i.coords,e.coords)&&this.openCellEditor("edit"),this._domNodes.display._initialMouseHitArea=void 0)}}}function bn(t){for(var e=[],i=0;i<t.length;i++)"string"==typeof t[i]?!(t[i]in this._presetContextMenuItems)||"include"in this._presetContextMenuItems[t[i]]&&!this._presetContextMenuItems[t[i]].include.call(this)||e.push(this._presetContextMenuItems[t[i]]):e.push(t[i]);return e}function Sn(t={},e=null){(t.contextMenu=this.constructor.contextMenu,t.items=bn.call(this,this.contextMenuItems),t.items.length)&&(this.events.dispatch("beforeopencontextmenu",t)&&(this.constructor.contextMenu.open(this,t.items,t.snapPointX,t.snapPointY,this._handlers.contextMenu.selectItem,this._handlers.contextMenu.close),ts.call(this,"contextMenuOpen"),this.events.dispatch("opencontextmenu",t)))}function In(t){3==t.which&&(this._pointerPositionPx=gs.call(this,t.clientX,t.clientY),null==_s.call(this,this._pointerPositionPx)&&null==ys.call(this,this._pointerPositionPx)&&Sn.call(this,{snapPointX:t.pageX-(this._isFullscreen?window.scrollX:0),snapPointY:t.pageY-(this._isFullscreen?window.scrollY:0)},t))}function Ln(t){}function Rn(t){}function Pn(t){}function Nn(){var t=this._selection[this._activeRangeIndex].range;1==this._selection.length&&Vi.call(this,t)?ts.call(this,"traverseSingleCell"):ts.call(this,"traverseMultiCell")}function Hn(t={},e=null){t.contextMenu.execClose(),this._isActive&&Nn.call(this),this.events.dispatch("closecontextmenu",t)}function zn(t={}){t.contextMenu.close(),t.item.method.call(this),this.events.dispatch("contextmenuselectitem",t)}function kn(){this._handlers={contextMenu:{open:Sn.bind(this),selectItem:zn.bind(this),close:Hn.bind(this)}},this._listeners={document:{fullscreenchange:Hi.bind(this),webkitfullscreenchange:zi.bind(this),keydown:ki.bind(this),mousedown:Fi.bind(this)},window:{resize:Bi.bind(this)},container:{resize:Ei.bind(this)},lineHeightMeter:{resize:Mi.bind(this)},component:{contextmenu:Oi.bind(this)},cellEditorInputField:{copy:$i.bind(this),paste:qi.bind(this),cut:Qi.bind(this),mousedown:es.bind(this),input:ss.bind(this)},scrollArea:{scroll:ds.bind(this),scroll_debounced:Dt((function(t){ps.call(this)}),100).bind(this)},eventArea:{mousedown:xn.bind(this),mousemove:vn.bind(this),mouseleave:wn.bind(this),dblclick:Cn.bind(this),contextmenu:In.bind(this),touchstart_passive:Ln.bind(this),touchmove_passive:Rn.bind(this),touchend_passive:Pn.bind(this)}}}function An(){var t={document:["fullscreenchange","webkitfullscreenchange","keydown","mousedown"],component:["contextmenu"],cellEditorInputField:["copy","paste","cut","mousedown","input"],scrollArea:["scroll","scroll_debounced"],eventArea:["mousedown","mousemove","mouseleave","dblclick","contextmenu"]};for(var e in t)for(var i=0;i<t[e].length;i++)vi.call(this,e,t[e][i]);this._domNodes.container._resizeSensor.events.on("resize",this._listeners.container.resize),this._domNodes.lineHeightMeter._resizeSensor.events.on("resize",this._listeners.lineHeightMeter.resize)}function Tn(){Fn.call(this,"topBar"),Fn.call(this,"bottomBar")}const Fn=function(t){if("topBar"==t)var e=this._validatedTopBar,i=this._topBarNodes;else if("bottomBar"==t)e=this._validatedBottomBar,i=this._bottomBarNodes;for(var s=function(t){var s=e[t].listeners;for(var o in s){var n=o.split("."),l=n[0],r=n[1],h=s[o].bind(this,i[t].nodes);i[t].nodes[l].addEventListener(r,h)}},o=function(t){var s=e[t].events;for(var o in s){var n=s[o].bind(this,i[t].nodes);this.events.on(o,n)}},l=function(t){if("keys"in e[t])for(var s in e[t].keys)for(var o=0;o<e[t].keys[s].length;o++){var l=e[t].keys[s][o];if(n(l)){var r=l.action.bind(this,i[t].nodes);this.keys.on(l.keys,r,l.repeat,i[t].nodes[s])}else{var h=this._presetKeyActions[l];this.keys.on(h.keys,h.action,h.repeat,i[t].nodes[s])}}},r=0;r<e.length;r++)s.call(this,r),o.call(this,r),l.call(this,r)};function Bn(){for(var t in this._domNodes.canvas){var[e,i]=t.split("-");En.call(this,e,i),Mn.call(this,e,i)}}const Mn=function(t,e){var i=this._domNodes.canvas[t+"-"+e];i._context=i.getContext("2d",{alpha:!1}),i._context.msImageSmoothingEnabled=!1,i._context.webkitImageSmoothingEnabled=!1,i._context.imageSmoothingEnabled=!1},En=function(t,e){var i=this._domNodes.canvas[t+"-"+e],s=i._displayWidth/1,o=i._displayHeight/this.rowHeight;i._drawWidth=s,i._drawHeight=o,i.width=s,i.height=o};function On(){for(var t,e,i=Array.prototype.slice.call(arguments),s=[0,0,0,0];e=i.shift();)void 0===e[3]&&(e[3]=1),s[3]&&e[3]?((t=[0,0,0,0])[3]=1-(1-e[3])*(1-s[3]),t[0]=Math.round(e[0]*e[3]/t[3]+s[0]*s[3]*(1-e[3])/t[3]),t[1]=Math.round(e[1]*e[3]/t[3]+s[1]*s[3]*(1-e[3])/t[3]),t[2]=Math.round(e[2]*e[3]/t[3]+s[2]*s[3]*(1-e[3])/t[3])):t=e||s,s=t;return t}function Xn(t){if(""!==t){if("transparent"===t.toLowerCase())return[0,0,0,0];if("#"===t[0])return t.length<7&&(t="#"+t[1]+t[1]+t[2]+t[2]+t[3]+t[3]+(t.length>4?t[4]+t[4]:"")),[parseInt(t.substr(1,2),16),parseInt(t.substr(3,2),16),parseInt(t.substr(5,2),16),t.length>7?parseInt(t.substr(7,2),16)/255:1];if(-1===t.indexOf("rgb")){var e=document.body.appendChild(document.createElement("fictum")),i="rgb(1, 2, 3)";if(e.style.color=i,e.style.color!==i)return;if(e.style.color=t,e.style.color===i||""===e.style.color)return;t=getComputedStyle(e).color,document.body.removeChild(e)}return 0===t.indexOf("rgb")?(-1===t.indexOf("rgba")&&(t+=",1"),t.match(/[\.\d]+/g).map((function(t){return+t}))):void 0}}function Vn(){var t={top:this._panesYids.top,center:this._rowView};for(var e in this._domNodes.canvas){var i=this._domNodes.canvas[e];i._context.fillStyle=this.getThemeSetting("sheet"),i._context.fillRect(0,0,i._drawWidth,i._drawHeight);for(var s=0;s<i._drawHeight&&!(s>t[i._panePositionY].length-1);s++)Yn.call(this,i,s,t[i._panePositionY][s],i._panePositionX),s==t[i._panePositionY].length-1&&Yn.call(this,i,s+1,t[i._panePositionY][s],i._panePositionX)}}const Yn=function(t,i,s,o){for(var n=this.getRowCoordById(s),l={left:this._panesXids.left,center:this._colView},r=0,h=0;h<l[o].length;h++){var a=this.getColCoordById(l[o][h]),c=this.getColWidthById(l[o][h]),d=Math.ceil(c/1);h==l[o].length-1&&(d+=1);var u=e[(n+a)%2]||this.getThemeSetting("sheet"),p=u;if(this._searchCellsFound.length)if(this._cellStore[s-1][l[o][h]-1]._found===this._searchStr){var f=Xn(u),g=Xn(this.getThemeSetting("cell+found"));g[3]=this.getThemeSetting("cell+found|opacity");var _=On(f,g);p="rgb("+_[0]+","+_[1]+","+_[2]+")"}t._context.fillStyle=p,t._context.fillRect(r,i,d,1),r+=d}};function Kn(){Wn.call(this),Dn.call(this),jn.call(this)}const Wn=function(){this._domNodes["column-top"].innerHTML=$e.call(this),this._domNodes["column-center"].innerHTML=Ze.call(this)},Dn=function(){for(var t=A(),e=this._cd.rowHeaderSpace,i=0;i<this._panesXids.left.length;i++){var s=this._panesXids.left[i]-1,o=this._cols.store[s],n=this._columnNodes[s];n["column-top"].textContent=ei.call(this,o.id),n["column-center"].textContent=ii.call(this,o.id),n.column.style.transform="translateX("+e+"px)",n.column.style.opacity=1,t.appendChild(n.column),e+=o.width}this._domNodes["pane-left"].insertBefore(t,this._domNodes["pane-left"].firstChild);for(i=0;i<this._domNodes["pane-left"].children.length;i++){var l=this._domNodes["pane-left"].children[i]._colId;this._domNodes["pane-left"].children[i]==this._domNodes.rowHeaderColumn||this._panesXids.left.indexOf(l)>-1||(this._domNodes["pane-left"].children[i].style.opacity=0)}},jn=function(){for(var t=A(),e=0,i=0;i<this._colView.length;i++){var s=this._colView[i]-1,o=this._cols.store[s],n=this._columnNodes[s];n["column-top"].textContent=ei.call(this,o.id),n["column-center"].textContent=ii.call(this,o.id),n.column.style.transform="translateX("+e+"px)",n.column.style.opacity=1,t.appendChild(n.column),e+=o.width}this._domNodes["pane-center"].insertBefore(t,this._domNodes["pane-center"].firstChild);for(i=0;i<this._domNodes["pane-center"].children.length;i++){var l=this._domNodes["pane-center"].children[i]._colId;this._colView.indexOf(l)>-1||(this._domNodes["pane-center"].children[i].style.opacity=0)}};function Un(){for(var t,e,i=1==this._selection.length,s=0;s<this._selection.length;s++)t=Vi.call(this,this._selection[s].range),e=s==this._activeRangeIndex,Gn.call(this,this._selection[s].range,s,t,i,e);for(;this._domNodes.cellRangeContainer.children.length>this._selection.length;)this._domNodes.cellRangeContainer.removeChild(this._domNodes.cellRangeContainer.lastChild),this._domNodes.cellRangeForegroundContainer.removeChild(this._domNodes.cellRangeForegroundContainer.lastChild)}const Gn=function(t,e,i,s,o){e>this._domNodes.cellRangeContainer.children.length-1&&(this._domNodes.cellRangeContainer.appendChild(ee(this._templates.cellRange)),this._domNodes.cellRangeForegroundContainer.appendChild(ee(this._templates.cellRangeForeground)));var n=Yi.call(this,t);$n.call(this,e,n,i,s,o),Zn.call(this,e,n,i,s,o)},$n=function(t,e,i,s,o){var n=this._domNodes.cellRangeContainer.children[t];n.style.opacity=null==e||i&&s?0:n._opacity;var l="translate("+(e.x.offset-0)+"px,"+(e.y.offset-0)+"px)",r="scale("+e.x.size/100+","+e.y.size/100+")";n.style.transform=l+" "+r},Zn=function(t,e,i,s,o){var n=this._domNodes.cellRangeForegroundContainer.children[t],l=n._borderStyle||"solid";null==e||i&&s||o&&String(this._currentDragAction).startsWith("select")?n.style.opacity=0:n.style.opacity=n._opacity;var r="translate("+(e.x.offset-0)+"px,"+(e.y.offset-0)+"px)";n.style.transform=r,n.style.width=e.x.size+"px",n.style.height=e.y.size+"px",n.style["border-left-style"]=e.x.lineLeft?l:"none",n.style["border-right-style"]=e.x.lineRight?l:"none",n.style["border-top-style"]=e.y.lineTop?l:"none",n.style["border-bottom-style"]=e.y.lineBottom?l:"none"};function qn(t){return[t,t]}function Jn(t){var e=!1,i=!1;return(t.y>=0&&t.y<this._panesYids.top.length||t.y>=this._viewportPosition.y&&t.y<this._viewportPosition.y+this._rowView.length)&&(e=!0),(t.x>=0&&t.x<this._panesXids.left.length||t.x>=this._viewportPosition.x&&t.x<this._viewportPosition.x+this._colView.length)&&(i=!0),!(!e||!i)}function Qn(){var t=this._domNodes.cellCursor;if(this._selection.length&&!this._domNodes.cellEditor._isOpen){var e=qn(this._cellCursorPosition),i=Yi.call(this,e),s=(t=this._domNodes.cellCursor)._borderStyle||"solid";if(null!=e){t.style.opacity=t._opacity||"",i.y.lineTop&&0!=i.x.size?t.style["border-top-style"]=s:t.style["border-top-style"]="none",i.y.lineBottom&&0!=i.x.size?t.style["border-bottom-style"]=s:t.style["border-bottom-style"]="none",i.x.lineLeft&&0!=i.y.size?t.style["border-left-style"]=s:t.style["border-left-style"]="none",i.x.lineRight&&0!=i.y.size?t.style["border-right-style"]=s:t.style["border-right-style"]="none";var o="translate("+i.x.offset+"px,"+i.y.offset+"px)";t.style.transform=o,t.style.width=i.x.size+"px",t.style.height=i.y.size+"px",Jn.call(this,this._cellCursorPosition)?this._domNodes.cellCursor.style.opacity=this._domNodes.cellCursor._opacity:this._domNodes.cellCursor.style.opacity=0}else t.style.opacity=0}else t.style.opacity=0}function tl(){var t=this._domNodes.searchCursor;if(this._searchCellsFound.length){var e=this._searchCellsFound[this._searchCellIndex],i=qn({x:this.getColCoordById(e[1]),y:this.getRowCoordById(e[0])}),s=Yi.call(this,i),o=t._borderStyle||"solid";if(null!=i){t.style.opacity=t._opacity||"",s.y.lineTop&&0!=s.x.size?t.style["border-top-style"]=o:t.style["border-top-style"]="none",s.y.lineBottom&&0!=s.x.size?t.style["border-bottom-style"]=o:t.style["border-bottom-style"]="none",s.x.lineLeft&&0!=s.y.size?t.style["border-left-style"]=o:t.style["border-left-style"]="none",s.x.lineRight&&0!=s.y.size?t.style["border-right-style"]=o:t.style["border-right-style"]="none";var n="translate("+(s.x.offset-2)+"px,"+(s.y.offset-2)+"px)";t.style.transform=n,t.style.width=s.x.size+4+"px",t.style.height=s.y.size+4+"px",Jn.call(this,i[0])?this._domNodes.searchCursor.style.opacity=this._domNodes.searchCursor._opacity:this._domNodes.searchCursor.style.opacity=0}else t.style.opacity=0}else t.style.opacity=0}function el(t){return[{x:t[0],y:0},{x:t[1],y:this._rows.coordList.length-1}]}function il(t){return[{x:0,y:t[0]},{x:this._cols.coordList.length-1,y:t[1]}]}function sl(){for(var t=De(this._selection,{type:"col"}),e=De(this._selection,{type:"row"}),i=t.length,s=this._selection.length-t.length,o=e.length,n=this._selection.length-e.length,l=0;l<t.length;l++)rl.call(this,t[l].range,l);var r=0;for(l=0;l<this._selection.length;l++)"col"!=this._selection[l].type&&(ll.call(this,this._selection[l].range,r),r++);for(l=0;l<e.length;l++)nl.call(this,e[l].range,l);for(r=0,l=0;l<this._selection.length;l++)"row"!=this._selection[l].type&&(ol.call(this,this._selection[l].range,r),r++);for(;this._domNodes.colHeaderRangeHighlightContainer.children.length>s;)this._domNodes.colHeaderRangeHighlightContainer.removeChild(this._domNodes.colHeaderRangeHighlightContainer.lastChild);for(;this._domNodes.colHeaderRangeSelectedContainer.children.length>i;)this._domNodes.colHeaderRangeSelectedContainer.removeChild(this._domNodes.colHeaderRangeSelectedContainer.lastChild);for(;this._domNodes.rowHeaderRangeHighlightContainer.children.length>n;)this._domNodes.rowHeaderRangeHighlightContainer.removeChild(this._domNodes.rowHeaderRangeHighlightContainer.lastChild);for(;this._domNodes.rowHeaderRangeSelectedContainer.children.length>o;)this._domNodes.rowHeaderRangeSelectedContainer.removeChild(this._domNodes.rowHeaderRangeSelectedContainer.lastChild)}const ol=function(t,e){var i=Yi.call(this,t);e>this._domNodes.rowHeaderRangeHighlightContainer.children.length-1&&this._domNodes.rowHeaderRangeHighlightContainer.appendChild(ee(this._templates.rowHeaderRangeHighlight));var s=this._domNodes.rowHeaderRangeHighlightContainer.children[e];s.style.opacity=null==i?0:s._opacity;var o="translate(0px,"+(i.y.offset-0)+"px)",n="scale("+this.rowHeaderWidth/100+","+i.y.size/100+")";s.style.transform=o+" "+n},nl=function(t,e){var i=Yi.call(this,t);e>this._domNodes.rowHeaderRangeSelectedContainer.children.length-1&&this._domNodes.rowHeaderRangeSelectedContainer.appendChild(ee(this._templates.rowHeaderRangeSelected));var s=this._domNodes.rowHeaderRangeSelectedContainer.children[e];s.style.opacity=null==i?0:s._opacity;var o="translate(0px,"+(i.y.offset-0)+"px)",n="scale("+this.rowHeaderWidth/100+","+i.y.size/100+")";s.style.transform=o+" "+n},ll=function(t,e){var i=Yi.call(this,t);e>this._domNodes.colHeaderRangeHighlightContainer.children.length-1&&this._domNodes.colHeaderRangeHighlightContainer.appendChild(ee(this._templates.colHeaderRangeHighlight));var s=this._domNodes.colHeaderRangeHighlightContainer.children[e];s.style.opacity=null==i?0:s._opacity;var o="translate("+(i.x.offset-0)+"px,0px)",n="scale("+i.x.size/100+","+this.colHeaderHeight/100+")";s.style.transform=o+" "+n},rl=function(t,e){var i=Yi.call(this,t);e>this._domNodes.colHeaderRangeSelectedContainer.children.length-1&&this._domNodes.colHeaderRangeSelectedContainer.appendChild(ee(this._templates.colHeaderRangeSelected));var s=this._domNodes.colHeaderRangeSelectedContainer.children[e];s.style.opacity=null==i?0:s._opacity;var o="translate("+(i.x.offset-0)+"px,0px)",n="scale("+i.x.size/100+","+this.colHeaderHeight/100+")";s.style.transform=o+" "+n};function hl(t,e,i){for(var s=0;s<t.length;s++)if(t[s][e]==i)return s;return-1}function al(){ul.call(this,"next",cl.call(this)),ul.call(this,"prev",dl.call(this))}const cl=function(){for(var t=[],e=0;e<this._panesYids.top.length;e++)null!==this._rows.iconList[e][1]&&t.push({groupIndex:this._rows.iconList[e][1],position:this.getRowPositionInViewport(e)+this.getRowHeightById(this._panesYids.top[e])-16+1});for(e=0;e<this._rowView.length;e++){var i=this._viewportPosition.y+e;null!==this._rows.iconList[i][1]&&t.push({groupIndex:this._rows.iconList[i][1],position:this.getRowPositionInViewport(i)+this.getRowHeightById(this._rowView[e])-16+1})}return t},dl=function(){for(var t=[],e=0;e<this._panesYids.top.length;e++)null!==this._rows.iconList[e][0]&&t.push({groupIndex:this._rows.iconList[e][0],position:this.getRowPositionInViewport(e)});for(e=0;e<this._rowView.length;e++){var i=this._viewportPosition.y+e;null!==this._rows.iconList[i][0]&&t.push({groupIndex:this._rows.iconList[i][0],position:this.getRowPositionInViewport(i)})}return t},ul=function(t="next",e=[]){for(var i=this._rows[t+"Nodes"],s=this._domNodes["hiddenRowGroupIcon"+Ps(t)+"Container"],o=this._templates["hiddenRowGroupIcon"+Ps(t)],n=A(),l=[],r=0;r<i.length;r++)l.push(r);var h=[];for(r=0;r<e.length;r++){var a=hl(i,"position",e[r].position);a>-1?(l.splice(l.indexOf(a),1),i[a].node.style.opacity=1):h.push(e[r].position)}for(r=0;r<h.length;r++)if(l.length){var c;i[c=l.shift()].node.style.transform="translateY("+h[r]+"px)",i[c].node.style.opacity=1,i[c].position=h[r]}else{var d=o.cloneNode(!0);d.style.transform="translateY("+h[r]+"px)",i.push({node:d,position:h[r]}),n.appendChild(d)}s.appendChild(n);for(r=0;r<l.length;r++)i[l[r]].node.style.opacity=0};function pl(){_l.call(this,"next",gl.call(this)),_l.call(this,"prev",fl.call(this))}const fl=function(){for(var t=[],e=0;e<this._panesXids.left.length;e++)null!==this._cols.iconList[e][0]&&t.push({groupIndex:this._cols.iconList[e][0],position:this.getColPositionInViewport(e)});for(e=0;e<this._colView.length;e++){var i=this._viewportPosition.x+e;null!==this._cols.iconList[i][0]&&t.push({groupIndex:this._cols.iconList[i][0],position:this.getColPositionInViewport(i)})}return t},gl=function(){for(var t=[],e=0;e<this._panesXids.left.length;e++)null!==this._cols.iconList[e][1]&&t.push({groupIndex:this._cols.iconList[e][1],position:this.getColPositionInViewport(e)+this.getColWidthById(this._panesXids.left[e])-14+1});for(e=0;e<this._colView.length;e++){var i=this._viewportPosition.x+e;null!==this._cols.iconList[i][1]&&t.push({groupIndex:this._cols.iconList[i][1],position:this.getColPositionInViewport(i)+this.getColWidthById(this._colView[e])-14+1})}return t},_l=function(t="next",e=[]){for(var i=this._cols[t+"Nodes"],s=this._domNodes["hiddenColGroupIcon"+Ps(t)+"Container"],o=this._templates["hiddenColGroupIcon"+Ps(t)],n=A(),l=[],r=0;r<i.length;r++)l.push(r);var h=[];for(r=0;r<e.length;r++){var a=hl(i,"position",e[r].position);a>-1?(l.splice(l.indexOf(a),1),i[a].node.style.opacity=1):h.push(e[r].position)}for(r=0;r<h.length;r++)if(l.length){var c;i[c=l.shift()].node.style.transform="translateX("+h[r]+"px)",i[c].node.style.opacity=1,i[c].position=h[r]}else{var d=o.cloneNode(!0);d.style.transform="translateX("+h[r]+"px)",i.push({node:d,position:h[r]}),n.appendChild(d)}s.appendChild(n);for(r=0;r<l.length;r++)i[l[r]].node.style.opacity=0};function yl(){var t=this._domNodes.fillHandle;if(this._selection.length&&!this._domNodes.cellEditor._isOpen){var e=this._selection[this._selection.length-1].range[1],i=this.getColPositionInViewport(e.x),s=this.getRowPositionInViewport(e.y),o=i+this.getColWidthById(this.getColIdByCoord(e.x))-7,n=s+this.getRowHeightById(this.getRowIdByCoord(e.y))-7;t.style.transform="translate("+o+"px, "+n+"px)",!Jn.call(this,e)||String(this._currentDragAction).startsWith("select")?t.style.opacity=0:t.style.opacity=this._domNodes.fillHandle._opacity}else t.style.opacity=0}function ml(){Di.call(this,this._domNodes.fillRange,this._fillRange)}function xl(){if(this._lastColView.startIndex>this._viewportPosition.x)this._domNodes.blankSheetRight.style.opacity=0;else{var t=this._viewportPosition.x+(this._colView.length-1),e=this.getColPositionInViewport(t);e+=this.getColWidthById(this._cols.coordList[t]),e+=1;var i=(this._cd.viewportWidth-e)/100;this._domNodes.blankSheetRight.style.transform="scaleX("+i+")",this._domNodes.blankSheetRight.style.opacity=this._domNodes.blankSheetRight._opacity}if(this._lastRowView.startIndex>this._viewportPosition.y)this._domNodes.blankSheetBottom.style.opacity=0;else{var s=this._viewportPosition.y+(this._rowView.length-1),o=this.getRowPositionInViewport(s);o+=this._actualRowHeight,o+=1;var n=(this._cd.viewportHeight-o)/100;this._domNodes.blankSheetBottom.style.transform="scaleY("+n+")",this._domNodes.blankSheetBottom.style.opacity=n>0?1:0}}function vl(){wl.call(this),Cl.call(this)}const wl=function(){if(null!=this._prevSelection)for(var t,e=0;e<this._prevSelection.selection.length;e++)for(var i=0;i<this._prevSelection.selection[e].colIds.length;i++)t=this._prevSelection.selection[e].colIds[i],this._columnNodes[t-1].columnHeaderLabel.style.color=this.getThemeSetting("header|text")},Cl=function(){for(var t,e=De(this._selection,{type:"col"}),i=0;i<e.length;i++)for(var s=e[i].range[0].x;s<=e[i].range[1].x;s++)t=this.getColIdByCoord(s),this._columnNodes[t-1].columnHeaderLabel.style.color=this.getThemeSetting("header:selected|text")};function bl(){for(var t=[],e=0;e<this._colLines.length;e++)t.push(e);var i=this._cd.rowHeaderSpace,s=[];for(e=0;e<this._panesXids.left.length;e++)i+=this.getColWidthById(this._panesXids.left[e]),(o=hl(this._colLines,"position",i))>-1?(t.splice(t.indexOf(o),1),this._colLines[o].node.style.opacity=1):s.push(i);i=this._cd.panesX.center.offset;for(e=0;e<this._colView.length&&!((i+=this.getColWidthById(this._colView[e]))>this._cd.viewportWidth);e++){var o;(o=hl(this._colLines,"position",i))>-1?(t.splice(t.indexOf(o),1),this._colLines[o].node.style.opacity=1):s.push(i)}var n=A();for(e=0;e<s.length;e++)if(t.length){var l=t.shift();this._colLines[l].node.style.transform="translateX("+s[e]+"px)",this._colLines[l].node.style.opacity=1,this._colLines[l].offset=s[e]}else{var r=ee(this._templates.colLine);r.style.transform="translateX("+s[e]+"px)",n.appendChild(r),this._colLines.push({node:r,offset:s[e]})}this._domNodes.colLines.appendChild(n);for(e=0;e<t.length;e++)this._colLines[t[e]].node.style.opacity=0}function Sl(){for(var t=[],e=0;e<this._rowLines.length;e++)t.push(e);var i=this._cd.colHeaderSpace,s=[];for(e=0;e<this._panesYids.top.length;e++)i+=this.getRowHeightById(this._panesYids.top[e]),(o=hl(this._rowLines,"position",i))>-1?(t.splice(t.indexOf(o),1),this._rowLines[o].node.style.opacity=1):s.push(i);i=this._cd.panesY.center.offset;for(e=0;e<this._rowView.length&&!((i+=this.getRowHeightById(this._rowView[e]))>this._cd.viewportHeight);e++){var o;(o=hl(this._rowLines,"position",i))>-1?(t.splice(t.indexOf(o),1),this._rowLines[o].node.style.opacity=1):s.push(i)}var n=A();for(e=0;e<s.length;e++)if(t.length){var l=t.shift();this._rowLines[l].node.style.transform="translateY("+s[e]+"px)",this._rowLines[l].node.style.opacity=1,this._rowLines[l].offset=s[e]}else{var r=ee(this._templates.rowLine);r.style.transform="translateY("+s[e]+"px)",n.appendChild(r),this._rowLines.push({node:r,offset:s[e]})}this._domNodes.rowLines.appendChild(n);for(e=0;e<t.length;e++)this._rowLines[t[e]].node.style.opacity=0}function Il(){if(this._freezeLineRowAfterId&&!this._sectionsPerPaneY.top.length){var t=this.getRowPositionInViewport(this.getRowCoordById(this._freezeLineRowAfterId)+1);this._domNodes.freezeLinePlaceholder_row.style.transform="translateY("+t+"px)",this._domNodes.freezeLinePlaceholder_row.style.opacity=t?1:0}else this._domNodes.freezeLinePlaceholder_row.style.opacity=0;if(this._freezeLineColAfterId&&!this._sectionsPerPaneX.left.length){var e=this.getColPositionInViewport(this.getColCoordById(this._freezeLineColAfterId)+1);N(this._domNodes.freezeLinePlaceholder_col,{transform:"translateX("+e+"px)",opacity:e?1:0})}else this._domNodes.freezeLinePlaceholder_col.style.opacity=0}function Ll(){Vn.call(this),Kn.call(this),Un.call(this),Qn.call(this),tl.call(this),sl.call(this),al.call(this),pl.call(this),yl.call(this),ml.call(this),xl.call(this),Di.call(this,this._domNodes.copyRange,this._copyRange),Di.call(this,this._domNodes.cutRange,this._cutRange),Di.call(this,this._domNodes.fillRange,this._fillRange),bl.call(this),Il.call(this),vl.call(this),Sl.call(this),this.constructor.contextMenu.redrawLabels()}function Rl(){Pl.call(this),qe.call(this),li.call(this),Nl.call(this),F.call(this,We.call(this)),Bn.call(this),this._domNodes.container.appendChild(this._domNodes.component),kn.call(this),An.call(this),Tn.call(this),requestAnimationFrame(()=>{Ll.call(this)}),Ci.call(this),ts.call(this,"traverseSingleCell"),setTimeout(()=>{this._isReady=!0,this.events.dispatch("ready",{})},0)}const Pl=function(){this._domNodes.container._resizeSensor=new jt(this._domNodes.container,this),this._domNodes.lineHeightMeter._resizeSensor=new jt(this._domNodes.lineHeightMeter,this)},Nl=function(){this._templates={},this._templates.colHeaderRangeHighlight=F.call(this,ri.call(this)),this._templates.colHeaderRangeSelected=F.call(this,hi.call(this)),this._templates.rowHeaderRangeHighlight=F.call(this,ai.call(this)),this._templates.rowHeaderRangeSelected=F.call(this,ci.call(this)),this._templates.cellRange=F.call(this,gi.call(this)),this._templates.cellRangeForeground=F.call(this,_i.call(this)),this._templates.hiddenRowGroupIconPrev=F.call(this,di.call(this)),this._templates.hiddenRowGroupIconNext=F.call(this,ui.call(this)),this._templates.hiddenColGroupIconPrev=F.call(this,pi.call(this)),this._templates.hiddenColGroupIconNext=F.call(this,fi.call(this)),this._templates.colLine=F.call(this,yi.call(this)),this._templates.rowLine=F.call(this,mi.call(this))};function Hl(t=null,e={}){this._container=t,this._componentIndex=this.constructor.instances.length,S.call(this,e),"loading"==document.readyState?document.addEventListener("DOMContentLoaded",()=>{tt.call(this)}):tt.call(this),"complete"==document.readyState?(Kt.call(this),Rl.call(this)):window.addEventListener("load",()=>{Kt.call(this),Rl.call(this)}),this.constructor.instances.push(this)}class zl{constructor(t,e=document){this._actionKeys={backspace:8,tab:9,enter:13,break:19,pause:19,esc:27,escape:27,space:32,pageup:33,pagedown:34,end:35,home:36,left:37,up:38,right:39,down:40,ins:45,insert:45,del:46,delete:46,plus:61},this._characterKeys=kl(),this._lookupCharacterKeys=El(this._characterKeys),this._modifierKeys={shift:"shiftKey",ctrl:t.constructor._isMacOS?"metaKey":"ctrlKey",alt:"altKey"},this._nonInputKeyCodes=[8,9,13,16,17,18,19,20,27,33,34,35,36,37,38,39,40,44,45,46,91,92,93,112,113,114,115,116,117,118,119,120,121,122,123,144,145,182,183],this._modifierKeyCodes=[16,17,18,91,93],this._metaKeyCodes=[91,93],this._context=t,this.trackedActionKeys=[],this.trackedCharacterKeys=[],this.trackedModifierKeys=[],this.pressedActionKeys={},this.pressedCharacterKeys={},this.pressedModifierKeys={},this.identifyKeyActionTimeout=null,this.keysToPrevent={},this.prevKeyAction=null,this.keyActions=[],this.keys={},this.keyHoldDelay=350,this.keyHoldInterval=60,this._isSuspended=!1,this._keyDownListener=Al.bind(this),this._keyUpListener=Tl.bind(this),this._identifyKeyAction=Bl.bind(this),this._scope=e,this._scope.addEventListener("keydown",this._keyDownListener),this._scope.addEventListener("keyup",this._keyUpListener)}on(t,e,i=!0,s=null){for(var o=!1,n="",l=[],r=[],h=[],a=(t=t.split("+"),[]),c=0;c<t.length;c++){var d=t[c].trim();d in this._modifierKeys?l.push(d):d in this._actionKeys?r.push(d):d in this._characterKeys&&h.push(d),a.push(d)}if(Ml({modifierKeys:l,actionKeys:r,characterKeys:h})&&(o=!0,n=a.join("+")),o){if(void 0===this.keys[n]){this.keys[n]={actions:[]},this.keyActions.push({actionKeys:r,characterKeys:h,modifierKeys:l,keyString:n});for(c=0;c<r.length;c++)this._actionKeys[r[c]]in this.keysToPrevent||(this.keysToPrevent[this._actionKeys[r[c]]]=[]),this.keysToPrevent[this._actionKeys[r[c]]].push(n);for(c=0;c<h.length;c++)this._characterKeys[h[c]]in this.keysToPrevent||(this.keysToPrevent[this._characterKeys[h[c]]]=[]),this.keysToPrevent[this._characterKeys[h[c]]].push(n)}for(c=0;c<this.keys[n].actions.length;c++)if(this.keys[n].actions[c].callback==e&&this.keys[n].actions[c].repeatable==i&&this.keys[n].actions[c].target==s)return;this.keys[n].actions.push({callback:e,repeatable:i,target:s});var u=null;for(c=0;c<a.length;c++)a[c]in this._modifierKeys?-1==this.trackedModifierKeys.indexOf(this._modifierKeys[a[c]])&&this.trackedModifierKeys.push(this._modifierKeys[a[c]]):a[c]in this._actionKeys?(u=this._actionKeys[a[c]],-1==this.trackedActionKeys.indexOf(u)&&this.trackedActionKeys.push(u)):a[c]in this._characterKeys&&(u=this._characterKeys[a[c]],-1==this.trackedCharacterKeys.indexOf(u)&&this.trackedCharacterKeys.push(u))}}off(t,e,i,s){for(var o=[],n=[],l=[],r=(t=t.split("+"),[]),h=0;h<t.length;h++){var a=t[h].trim();a in this._modifierKeys?l.push(a):a in this._actionKeys?o.push(a):a in this._characterKeys&&n.push(a),r.push(a)}if(Ml({modifierKeys:l,actionKeys:o,characterKeys:n})){var c=r.join("+");if(void 0!==this.keys[c]){var d=[];for(h=0;h<this.keys[c].actions.length;h++)this.keys[c].actions[h].callback==e&&this.keys[c].actions[h].repeatable==i&&this.keys[c].actions[h].target==s||d.push(this.keys[c].actions[h]);if(this.keys[c].actions=d,!this.keys[c].actions.length){delete this.keys[c];for(h=0;h<this.keyActions.length;h++)if(this.keyActions[h].keyString==c){for(var u=0;u<this.keyActions[h].actionKeys.length;u++){if(this._actionKeys[this.keyActions[h].actionKeys[u]]in this.keysToPrevent)(p=this.keysToPrevent[this._actionKeys[this.keyActions[h].actionKeys[u]]].indexOf(c))>-1&&this.keysToPrevent[this._actionKeys[this.keyActions[h].actionKeys[u]]].splice(p,1),this.keysToPrevent[this._actionKeys[this.keyActions[h].actionKeys[u]]].length||delete this.keysToPrevent[this._actionKeys[this.keyActions[h].actionKeys[u]]]}for(u=0;u<this.keyActions[h].characterKeys.length;u++){var p;if(this._characterKeys[this.keyActions[h].characterKeys[u]]in this.keysToPrevent)(p=this.keysToPrevent[this._characterKeys[this.keyActions[h].characterKeys[u]]].indexOf(c))>-1&&this.keysToPrevent[this._characterKeys[this.keyActions[h].characterKeys[u]]].splice(p,1),this.keysToPrevent[this._characterKeys[this.keyActions[h].characterKeys[u]]].length||delete this.keysToPrevent[this._characterKeys[this.keyActions[h].characterKeys[u]]]}this.keyActions.splice(h,1);break}}}}}suspend(){this._scope.removeEventListener("keydown",this._keyDownListener),this._scope.removeEventListener("keyup",this._keyUpListener)}resume(){this._scope.addEventListener("keydown",this._keyDownListener),this._scope.addEventListener("keyup",this._keyUpListener)}}const kl=function(){for(var t={},e=[{startIndex:65,series:"abcdefghijklmnopqrstuvwxyz"},{startIndex:48,series:"0123456789"}],i=0;i<e.length;i++)for(var s=0;s<e[i].series.length;s++)t[e[i].series[s]]=e[i].startIndex+s;return t["\\"]=220,t},Al=function(t){var e=t.which||t.keyCode;if(!(this._modifierKeyCodes.indexOf(e)>-1&&null===this.identifyKeyActionTimeout)){this._scope!=document||Ol.call(this)||!(e in this.keysToPrevent)||e in this._lookupCharacterKeys||t.preventDefault();for(var i=0;i<this.trackedModifierKeys.length;i++){var s=this.trackedModifierKeys[i];s in t&&1==t[s]?this.pressedModifierKeys[s]=!0:s in this.pressedModifierKeys&&delete this.pressedModifierKeys[s]}this.trackedActionKeys.indexOf(e)>-1&&!this.pressedActionKeys[e]&&(this.pressedActionKeys[e]=!0),this.trackedCharacterKeys.indexOf(e)>-1&&!this.pressedCharacterKeys[e]&&(this.pressedCharacterKeys[e]=!0),null===this.identifyKeyActionTimeout&&Bl.call(this,t)}},Tl=function(t){var e=t.which||t.keyCode;this.pressedActionKeys[e]&&delete this.pressedActionKeys[e],this.pressedCharacterKeys[e]&&delete this.pressedCharacterKeys[e],this._metaKeyCodes.indexOf(e)>-1&&(this.pressedCharacterKeys={},this.pressedActionKeys={}),0==Object.keys(this.pressedActionKeys).length&&0==Object.keys(this.pressedCharacterKeys).length&&Fl.call(this)},Fl=function(){clearTimeout(this.identifyKeyActionTimeout),this.identifyKeyActionTimeout=null,this.pressedActionKeys={},this.pressedCharacterKeys={},this.pressedModifierKeys={},this.prevKeyAction=null},Bl=function(t=null){if(document.hasFocus()){for(var e=[],i=0;i<this.keyActions.length;i++){for(var s=0,o=0;o<this.keyActions[i].modifierKeys.length;o++)this.pressedModifierKeys[this._modifierKeys[this.keyActions[i].modifierKeys[o]]]&&s++;for(o=0;o<this.keyActions[i].actionKeys.length;o++)this.pressedActionKeys[this._actionKeys[this.keyActions[i].actionKeys[o]]]&&s++;for(o=0;o<this.keyActions[i].characterKeys.length;o++)this.pressedCharacterKeys[this._characterKeys[this.keyActions[i].characterKeys[o]]]&&s++;s>0&&s==this.keyActions[i].actionKeys.length+this.keyActions[i].characterKeys.length+this.keyActions[i].modifierKeys.length&&e.push(this.keyActions[i])}if(e.length>1&&e.sort((function(t,e){return e.actionKeys.length+e.modifierKeys.length-(t.actionKeys.length+t.modifierKeys.length)})),e.length?(e[0]==this.prevKeyAction?this.keyActionRepeatCounter++:this.keyActionRepeatCounter=0,this.keys[e[0].keyString].actions.forEach(e=>{null!=e.target||Ol.call(this)?e.target==t.target&&document.activeElement==e.target&&(0==e.repeatable&&(this.keyActionRepeatCounter=0),1!=e.repeatable&&0!=this.keyActionRepeatCounter||(e.callback.call(this._context,t),t.preventDefault())):(0==e.repeatable&&(this.keyActionRepeatCounter=0),1!=e.repeatable&&0!=this.keyActionRepeatCounter||e.callback.call(this._context,t))}),this._context.constructor._isMacOS&&e[0].modifierKeys.indexOf("ctrl")>-1&&(this.pressedCharacterKeys={},this.pressedActionKeys={}),this.prevKeyAction=e[0]):(this.keyActionRepeatCounter=0,this.prevKeyAction=null),0==this.keyActionRepeatCounter)var n=this.keyHoldDelay;else n=this.keyHoldInterval;this.identifyKeyActionTimeout=setTimeout(()=>{this._identifyKeyAction.call(this,t)},n)}},Ml=function(t){var e=!0;return(t.modifierKeys.length&&!t.actionKeys.length&&!t.characterKeys.length||!t.modifierKeys.length&&!t.actionKeys.length&&t.characterKeys.length||t.actionKeys.length&&t.characterKeys.length)&&(e=!1),e},El=function(t){var e={};for(var i in t)e[String(t[i])]=i;return e},Ol=function(){for(var t=["input","button","img","a"],e=!1,i=0;i<t.length;i++)if(document.activeElement.tagName.toLowerCase()==t[i]){e=!0;break}return e};zl._lastAction=null;class Xl{constructor(t){this.commands=[],this.index=-1,this.limit=0,this.isExecuting=!1,this.callback,this._context=t}add(t){return this.isExecuting?this:(this.commands.splice(this.index+1,this.commands.length-this.index),this.commands.push(t),this.limit&&this.commands.length>this.limit&&Yl(this.commands,0,-(this.limit+1)),this.index=this.commands.length-1,this.callback&&this.callback(),this)}setCallback(t){this.callback=t}undo(){var t=this.commands[this.index];return t&&this._context.events.dispatch("beforeundo",{command:t})?(Vl.call(this,t,"undo"),this.index-=1,this._context.events.dispatch("undo",{command:t}),this.callback&&this.callback(),this):this}redo(){var t=this.commands[this.index+1];return t&&this._context.events.dispatch("beforeredo",{command:t})?(Vl.call(this,t,"redo"),this.index+=1,this._context.events.dispatch("redo",{command:t}),this.callback&&this.callback(),this):this}clear(){var t=this.commands.length;this.commands=[],this.index=-1,this.callback&&t>0&&this.callback()}hasUndo(){return-1!==this.index}hasRedo(){return this.index<this.commands.length-1}getCommands(){return this.commands}getIndex(){return this.index}setLimit(t){this.limit=t}}const Vl=function(t,e){return t&&"function"==typeof t[e]?(this.isExecuting=!0,t[e].call(this._context),this.isExecuting=!1,this):this},Yl=function(t,e,i){return t.splice(e,!i||1+i-e+(!(i<0^e>=0)&&(i<0||-1)*t.length)),t.length};var Kl={inputBar:{name:"inputBar",grow:1,node:function(){var t={name:"inputField",tag:"input",style:W[".dgxl-inputField"].call(this),type:"text"};return this.allowEditCells||(t.disabled="disabled"),{name:"inputWrapper",style:W[".dgxl-inputWrapper"].call(this),children:[{name:"inputInfo",style:W[".dgxl-inputInfo"].call(this),text:""},t]}},events:{setselection:function(t,e){setTimeout(()=>{this.getRowIdByCoord(e.cellCursorPosition.y),this.getColIdByCoord(e.cellCursorPosition.x),t.inputField.value=this.getCellValue(e.cellCursorPosition),t.inputInfo.textContent=this.getSpreadsheetCoords(e.cellCursorPosition)},0)},closeeditor:function(t,e){t.inputField.value=this.getCellValue(this._cellCursorPosition)},celleditorinput:function(t,e){t.inputField.value=e.value}},listeners:{"inputField.input":function(t,e){this.setCellEditorValue(e.target.value)},"inputField.focus":function(t,e){t.inputWrapper.classList.add("dgxl-hasFocus"),N(t.inputWrapper,W[".dgxl-inputWrapper.dgxl-hasFocus"].call(this))},"inputField.blur":function(t,e){t.inputWrapper.classList.remove("dgxl-hasFocus"),N(t.inputWrapper,W["reset|.dgxl-inputWrapper.dgxl-hasFocus"].call(this))}},keys:{inputField:["tab_navigateNext","shiftTab_navigatePrev","enter_navigateNext","shiftEnter_navigatePrev",{keys:"esc",action:function(t,e){this.closeCellEditor(),t.inputField.value="",t.inputField.blur()},repeat:!1}]},update:function(t){}},searchBar:{name:"searchBar",grow:1,node:function(){var t='<svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 0 24 24" width="24px" style="'+z(W[".dgxl-part button svg"].call(this))+'"><path d="M0 0h24v24H0V0z" fill="none"/><path d="M12 8l-6 6 1.41 1.41L12 10.83l4.59 4.58L18 14l-6-6z"/></svg>',e='<svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 0 24 24" width="24px" style="'+z(W[".dgxl-part button svg"].call(this))+'"><path d="M24 24H0V0h24v24z" fill="none" opacity=".87"/><path d="M16.59 8.59L12 13.17 7.41 8.59 6 10l6 6 6-6-1.41-1.41z"/></svg>';return{style:{display:"flex","flex-grow":1,"grid-gap":"2px"},children:[{name:"inputWrapper",style:W[".dgxl-inputWrapper"].call(this),children:[{name:"inputInfo",style:W[".dgxl-inputInfo"].call(this),text:""},{name:"inputField",tag:"input",style:W[".dgxl-inputField"].call(this),placeholder:"Search",value:""}]},{name:"searchCellButtonPrev",tag:"button",style:W[".dgxl-part button"].call(this),html:t,disabled:!0},{name:"searchCellButtonNext",tag:"button",style:W[".dgxl-part button"].call(this),html:e,disabled:!0}]}},listeners:{"inputField.input":function(t,e){this.search(e.target.value)},"searchCellButtonPrev.click":function(t,e){this.searchPrev()},"searchCellButtonNext.click":function(t,e){this.searchNext()},"inputField.focus":function(t,e){t.inputWrapper.classList.add("dgxl-hasFocus"),N(t.inputWrapper,W[".dgxl-inputWrapper.dgxl-hasFocus"].call(this))},"inputField.blur":function(t,e){t.inputWrapper.classList.remove("dgxl-hasFocus"),N(t.inputWrapper,W["reset|.dgxl-inputWrapper.dgxl-hasFocus"].call(this))}},keys:{inputField:[{keys:"enter",action:function(t){this.searchNext()},repeat:!0},{keys:"shift+enter",action:function(t){this.searchPrev()},repeat:!0},{keys:"esc",action:function(t,e){this.clearSearch(),t.inputField.value="",t.inputField.blur()}}]},update:function(t){t.inputField.value=this._searchStr;var e=`$n=${this._searchCellIndex+1} from $total=${this._searchCellsFound.length}`;this._searchCellsFound.length?(t.inputInfo.textContent=this.getLocaleSetting(e),t.searchCellButtonNext.removeAttribute("disabled"),t.searchCellButtonPrev.removeAttribute("disabled")):(this._searchStr?t.inputInfo.textContent=this.getLocaleSetting(e):t.inputInfo.textContent="",t.searchCellButtonNext.setAttribute("disabled",!0),t.searchCellButtonPrev.setAttribute("disabled",!0))}},fullscreenButton:{name:"fullscreenButton",node:function(){var t='<svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 0 24 24" width="24px" style="'+z(W[".dgxl-part button svg"].call(this))+'"><path d="M0 0h24v24H0V0z" fill="none"/><path d="M7 14H5v5h5v-2H7v-3zm-2-4h2V7h3V5H5v5zm12 7h-3v2h5v-5h-2v3zM14 5v2h3v3h2V5h-5z"/></svg>',e='<svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 0 24 24" width="24px" style="'+z(W[".dgxl-part button svg"].call(this))+'"><path d="M0 0h24v24H0V0z" fill="none"/><path d="M5 16h3v3h2v-5H5v2zm3-8H5v2h5V5H8v3zm6 11h2v-3h3v-2h-5v5zm2-11V5h-2v5h5V8h-3z"/></svg>';return{tag:"button",name:"fullscreenButton",style:W[".dgxl-part button"].call(this),html:t,_iconEnter:t,_iconLeave:e}},listeners:{"fullscreenButton.click":function(t){this.toggleFullscreen()}},events:{fullscreenenter:function(t){this.constructor._isIOS&&t.fullscreenButton.setAttribute("disabled",!0),t.fullscreenButton.innerHTML=t.fullscreenButton._iconLeave},fullscreenleave:function(t){this.constructor._isIOS&&t.fullscreenButton.removeAttribute("disabled"),t.fullscreenButton.innerHTML=t.fullscreenButton._iconEnter}}},credits:{name:"credits",node:function(){return{name:"credits",style:{display:"flex","align-items":"center",height:"100%","aspect-ratio":1},html:'<a style="display:flex;height:100%;aspect-ratio:1;" title="Excel-like experience by DataGridXL" href="https://datagridxl.com"><img style="height:100%;aspect-ratio:1;" src="'+"data:image/svg+xml,%0A%3Csvg version='1.2' baseProfile='tiny-ps' xmlns='http://www.w3.org/2000/svg' viewBox='0 0 179 179' width='16' height='16'%3E%3Ctitle%3ENew Project-svg%3C/title%3E%3Cstyle%3E tspan %7B white-space:pre %7D .shp0 %7B fill: %23138046 %7D .shp1 %7B fill: %23000000 %7D .shp2 %7B fill: %23ffffff %7D %3C/style%3E%3Cg id='NEW'%3E%3Cpath id='Layer 3 copy' class='shp0' d='M20 0L159 0C170.06 0 179 8.94 179 20L179 159C179 170.06 170.06 179 159 179L20 179C8.94 179 0 170.06 0 159L0 20C0 8.94 8.94 0 20 0Z' /%3E%3Cpath id='datagrid ' fill-rule='evenodd' class='shp1' d='M-582.44 64.02C-570.4 64.02 -559.34 70.18 -554.02 79L-554.02 38.4L-541.14 38.4L-541.14 142L-554.02 142L-554.02 127.58C-558.64 136.12 -568.58 143.26 -582.58 143.26C-603.16 143.26 -618.98 127.16 -618.98 103.36C-618.98 79.42 -603.16 64.02 -582.44 64.02ZM-580.06 75.08C-594.06 75.08 -605.96 85.3 -605.96 103.36C-605.96 121.42 -594.06 132.06 -580.06 132.06C-566.06 132.06 -554.02 121.56 -554.02 103.5C-554.02 85.72 -566.06 75.08 -580.06 75.08ZM-487.94 64.02C-473.66 64.02 -463.86 71.3 -459.38 79.28L-459.38 65.28L-446.5 65.28L-446.5 142L-459.38 142L-459.38 127.72C-464 135.98 -473.94 143.26 -488.08 143.26C-508.52 143.26 -524.34 127.16 -524.34 103.36C-524.34 79.42 -508.52 64.02 -487.94 64.02ZM-485.42 75.08C-499.42 75.08 -511.32 85.3 -511.32 103.36C-511.32 121.42 -499.42 132.06 -485.42 132.06C-471.42 132.06 -459.38 121.56 -459.38 103.5C-459.38 85.72 -471.42 75.08 -485.42 75.08ZM-422.14 75.78L-432.08 75.78L-432.08 65.28L-422.14 65.28L-422.14 45.96L-409.4 45.96L-409.4 65.28L-389.38 65.28L-389.38 75.78L-409.4 75.78L-409.4 121C-409.4 128.56 -406.6 131.22 -398.76 131.22L-389.38 131.22L-389.38 142L-400.86 142C-414.44 142 -422.14 136.4 -422.14 121L-422.14 75.78ZM-342.34 64.02C-328.06 64.02 -318.26 71.3 -313.78 79.28L-313.78 65.28L-300.9 65.28L-300.9 142L-313.78 142L-313.78 127.72C-318.4 135.98 -328.34 143.26 -342.48 143.26C-362.92 143.26 -378.74 127.16 -378.74 103.36C-378.74 79.42 -362.92 64.02 -342.34 64.02ZM-339.82 75.08C-353.82 75.08 -365.72 85.3 -365.72 103.36C-365.72 121.42 -353.82 132.06 -339.82 132.06C-325.82 132.06 -313.78 121.56 -313.78 103.5C-313.78 85.72 -325.82 75.08 -339.82 75.08ZM-247.7 64.02C-233.7 64.02 -223.62 71.02 -219.14 79.28L-219.14 65.28L-206.26 65.28L-206.26 143.68C-206.26 164.82 -220.4 179.8 -242.94 179.8C-263.1 179.8 -277.52 169.58 -280.04 153.2L-267.44 153.2C-264.64 162.44 -255.54 168.74 -242.94 168.74C-229.36 168.74 -219.14 160.06 -219.14 143.68L-219.14 127.58C-223.76 135.84 -233.7 143.26 -247.7 143.26C-268.28 143.26 -284.1 127.16 -284.1 103.36C-284.1 79.42 -268.28 64.02 -247.7 64.02ZM-245.18 75.08C-259.18 75.08 -271.08 85.3 -271.08 103.36C-271.08 121.42 -259.18 132.06 -245.18 132.06C-231.18 132.06 -219.14 121.56 -219.14 103.5C-219.14 85.72 -231.18 75.08 -245.18 75.08ZM-171.96 142L-184.7 142L-184.7 65.28L-171.96 65.28L-171.96 77.74C-167.62 69.2 -159.36 63.88 -147.18 63.88L-147.18 77.04L-150.54 77.04C-162.72 77.04 -171.96 82.5 -171.96 100.28L-171.96 142ZM-132.48 65.28L-119.74 65.28L-119.74 142L-132.48 142L-132.48 65.28ZM-134.58 44.14C-134.58 39.24 -130.8 35.46 -125.9 35.46C-121.28 35.46 -117.5 39.24 -117.5 44.14C-117.5 49.04 -121.28 52.82 -125.9 52.82C-130.8 52.82 -134.58 49.04 -134.58 44.14ZM-66.26 64.02C-54.22 64.02 -43.16 70.18 -37.84 79L-37.84 38.4L-24.96 38.4L-24.96 142L-37.84 142L-37.84 127.58C-42.46 136.12 -52.4 143.26 -66.4 143.26C-86.98 143.26 -102.8 127.16 -102.8 103.36C-102.8 79.42 -86.98 64.02 -66.26 64.02ZM-63.88 75.08C-77.88 75.08 -89.78 85.3 -89.78 103.36C-89.78 121.42 -77.88 132.06 -63.88 132.06C-49.88 132.06 -37.84 121.56 -37.84 103.5C-37.84 85.72 -49.88 75.08 -63.88 75.08Z' /%3E%3Cpath id='XL ' class='shp2' d='M62 79L75.5 57L95.5 57L73 92L96 127L76 127L62 105L48 127L28 127L51 92L28.5 57L48.4 57L62 79ZM119 57L119 113L155.5 113L155.5 127L101 127L101 57L119 57Z' /%3E%3C/g%3E%3C/svg%3E\"></a>"}}}},Wl={tab_navigateNext:{keys:"tab",action:function(){this.moveCellCursorInsideSelection({x:1,y:0})},repeat:!0},shiftTab_navigatePrev:{keys:"shift+tab",action:function(){this.moveCellCursorInsideSelection({x:-1,y:0})},repeat:!0},enter_navigateNext:{keys:"enter",action:function(){this.moveCellCursorInsideSelection({x:0,y:1})},repeat:!0},shiftEnter_navigatePrev:{keys:"shift+enter",action:function(){this.moveCellCursorInsideSelection({x:0,y:-1})},repeat:!0},enter_openCellEditor:{keys:"enter",action:function(){this.openCellEditor("edit")},repeat:!1,active:function(){return this.allowEditCells}},pageDown_moveCellCursorOneViewportDown:{keys:"pagedown",action:function(){this.moveCellCursorOneViewportDown()},repeat:!0},pageUp_moveCellCursorOneViewportUp:{keys:"pageup",action:function(){this.moveCellCursorOneViewportUp()},repeat:!0},home_moveCellCursorToRowStart:{keys:"home",action:function(){this.moveCellCursorToRowStart()},repeat:!1},end_moveCellCursorToRowEnd:{keys:"end",action:function(){this.moveCellCursorToRowEnd()},repeat:!1},ctrlLeftArrow_moveCellCursorToRowStart:{keys:"ctrl+left",action:function(){this.moveCellCursorToRowStart()},repeat:!1},ctrlRightArrow_moveCellCursorToRowEnd:{keys:"ctrl+right",action:function(){this.moveCellCursorToRowEnd()},repeat:!1},ctrlUpArrow_moveCellCursorToColStart:{keys:"ctrl+up",action:function(){this.moveCellCursorToColStart()},repeat:!1},ctrlDownArrow_moveCellCursorToColEnd:{keys:"ctrl+down",action:function(){this.moveCellCursorToColEnd()},repeat:!1},ctrlHome_moveCellCursorToSheetStart:{keys:"ctrl+home",action:function(){this.moveCellCursorToSheetStart()},repeat:!1},ctrlEnd_moveCellCursorToSheetEnd:{keys:"ctrl+end",action:function(){this.moveCellCursorToSheetEnd()},repeat:!1},rightArrow_moveCellCursorRight:{keys:"right",action:function(){this.moveCellCursor({x:1,y:0})},repeat:!0},downArrow_moveCellCursorDown:{keys:"down",action:function(){this.moveCellCursor({x:0,y:1})},repeat:!0},leftArrow_moveCellCursorLeft:{keys:"left",action:function(){this.moveCellCursor({x:-1,y:0})},repeat:!0},upArrow_moveCellCursorUp:{keys:"up",action:function(){this.moveCellCursor({x:0,y:-1})},repeat:!0},shiftRightArrow_modifyActiveRangeRightwards:{keys:"shift+right",action:function(){this.modifyActiveRange("right")},repeat:!0},shiftDownArrow_modifyActiveRangeDownwards:{keys:"shift+down",action:function(){this.modifyActiveRange("down")},repeat:!0},shiftLeftArrow_modifyActiveRangeLeftwards:{keys:"shift+left",action:function(){this.modifyActiveRange("left")},repeat:!0},shiftUpArrow_modifyActiveRangeUpwards:{keys:"shift+up",action:function(){this.modifyActiveRange("up")},repeat:!0},ctrlZ_undo:{keys:"ctrl+z",action:function(t){this.undo(),t.preventDefault()},repeat:!1},ctrlY_redo:{keys:"ctrl+y",action:function(t){this.redo(),t.preventDefault()},repeat:!1},ctrlShiftZ_redo:{keys:"ctrl+shift+z",action:function(t){this.redo(),t.preventDefault()},repeat:!1},ctrlA_selectAll:{keys:"ctrl+a",action:function(t){this.selectAll(!1)},repeat:!1},backspace_clearCellValues:{keys:"backspace",action:function(){this.clearCellValues(this._selection)},repeat:!1,active:function(){return this.allowEditCells}},delete_clearCellValues:{keys:"delete",action:function(){this.clearCellValues(this._selection)},repeat:!1,active:function(){return this.allowEditCells}},esc_closeCellEditor:{keys:"esc",action:function(){this.closeCellEditor()},repeat:!1},ctrlShiftSlash_openContextMenu:{keys:"ctrl+shift+\\",action:function(){this.openContextMenu()},repeat:!1},esc_closeContextMenu:{keys:"esc",action:function(){this.constructor.contextMenu.close()},repeat:!1},downArrow_moveContextMenuCursorDown:{keys:"down",action:function(){this.constructor.contextMenu.moveCursorDown()},repeat:!0},upArrow_moveContextMenuCursorUp:{keys:"up",action:function(){this.constructor.contextMenu.moveCursorUp()},repeat:!0},enter_hitContextMenuItem:{keys:"enter",action:function(){this.constructor.contextMenu.triggerHit()},repeat:!1}};function Dl(){if(null==this._cellCursorPosition)var t=null;else t=[this.getRowIdByCoord(this._cellCursorPosition.y),this.getColIdByCoord(this._cellCursorPosition.x)];for(var e={selection:[],cellCursorPosition:this._cellCursorPosition,cellCursorPositionId:t,activeRangeIndex:this._activeRangeIndex},i=0;i<this._selection.length;i++){var s=[{x:this._selection[i].range[0].x,y:this._selection[i].range[0].y},{x:this._selection[i].range[1].x,y:this._selection[i].range[1].y}];e.selection.push({range:s,type:this._selection[i].type,colIds:jl.call(this,s),rowIds:Ul.call(this,s)})}return e}const jl=function(t){for(var e=[],i=t[0].x;i<=t[1].x;i++)e.push(this.getColIdByCoord(i));return e},Ul=function(t){for(var e=[],i=t[0].y;i<=t[1].y;i++)e.push(this.getRowIdByCoord(i));return e};var Gl={cut:{label:"Cut",method:function(){this.cut()},shortcut:"Ctrl+X",shortcutMac:"⌘X",include:function(){return this.allowCut}},copy:{label:"Copy",method:function(){this.copy()},shortcut:"Ctrl+C",shortcutMac:"⌘C",include:function(){return this.allowCopy}},paste:{label:"Paste",method:function(){this.paste()},shortcut:"Ctrl+V",shortcutMac:"⌘V",include:function(){return this.allowPaste}},delete_rows:{label:"Delete Row(s)",method:function(){this.deleteRows(this.getRowSelection())},disabled:function(){return!this.getRowSelection().length},include:function(){return this.allowDeleteRows}},insert_rows_before:{label:function(){var t=this.getRowSelection();if(!t.length)return"Insert Row (up)";var e=t[0][1]-t[0][0]+1;return 1==e?"Insert Row (up)":`Insert $n=${e} Rows (up)`},method:function(){var t=this.getRowSelection(),e=t[0][1]-t[0][0]+1;this.insertEmptyRows(e,this.getRowSelection()[0][0])},disabled:function(){},include:function(){return this.allowInsertRows&&1==this.getRowSelection().length}},insert_rows_after:{label:function(){var t=this.getRowSelection();if(!t.length)return"Insert Row (down)";var e=t[0][1]-t[0][0]+1;return 1==e?"Insert Row (down)":`Insert $n=${e} Rows (down)`},method:function(){var t=this.getRowSelection(),e=t[0][1]-t[0][0]+1;this.insertEmptyRows(e,this.getRowSelection()[0][1]+1)},disabled:function(){},include:function(){return this.allowInsertRows&&1==this.getRowSelection().length}},hide_rows:{label:function(){var t=this.getRowSelection();if(!t.length)return"Hide Row";var e=t[0][1]-t[0][0]+1;return 1==e?"Hide Row":`Hide $n=${e} Rows`},method:function(){this.hideRows(this.getRowSelection())},disabled:function(){return!this.getRowSelection().length},include:function(){return this.allowHideRows}},delete_cols:{label:"Delete Column(s)",method:function(){this.deleteCols(this.getColSelection())},disabled:function(){return!this.getColSelection().length},include:function(){return this.allowDeleteCols}},insert_cols_before:{label:function(){var t=this.getColSelection();if(!t.length)return"Insert Column (left)";var e=t[0][1]-t[0][0]+1;return 1==e?"Insert Column (left)":`Insert $n=${e} Columns (left)`},method:function(){var t=this.getColSelection(),e=t[0][1]-t[0][0]+1;this.insertEmptyCols(e,this.getColSelection()[0][0])},disabled:function(){},include:function(){return this.allowInsertCols&&1==this.getColSelection().length}},insert_cols_after:{label:function(){var t=this.getColSelection();if(!t.length)return"Insert Column (right)";var e=t[0][1]-t[0][0]+1;return 1==e?"Insert Column (right)":`Insert $n=${e} Columns (right)`},method:function(){var t=this.getColSelection(),e=t[0][1]-t[0][0]+1;this.insertEmptyCols(e,this.getColSelection()[0][1]+1)},disabled:function(){},include:function(){return this.allowInsertCols&&1==this.getColSelection().length}},hide_cols:{label:function(){var t=this.getColSelection();if(!t.length)return"Hide Column";var e=t[0][1]-t[0][0]+1;return 1==e?"Hide Column":`Hide $n=${e} Columns`},method:function(){this.hideCols(this.getColSelection())},disabled:function(){return!this.getColSelection().length},include:function(){return this.allowHideCols}},sort_asc:{label:"Sort A to Z",method:function(){this.sort(this._cellCursorPosition.x,"asc")},disabled:function(){return!this.getColSelection().length},include:function(){return this.allowSort}},sort_desc:{label:"Sort Z to A",method:function(){this.sort(this._cellCursorPosition.x,"desc")},disabled:function(){return!this.getColSelection().length},include:function(){return this.allowSort}}},$l={numbers:{indexToLabel:function(t){return String(1+t)},labelToIndex:function(t){return Number(t)-1}},letters:{indexToLabel:function(t){var e="";for(t++;t-- >0;t=(t-t%26)/26)e=String.fromCharCode(t%26+65)+e;return e},labelToIndex:function(t){for(var e=0,i=0;i<t.length;i++)e=26*e+t.charCodeAt(i)-64;return e-1}}},Zl=["searchBar"],ql=["fullscreenButton","inputBar","credits"];function Jl(t,e,i,s){return i.title?i.title||"":this.colHeaderLabelType in s?(this.colHeaderLabelPrefix||"")+s[this.colHeaderLabelType]+(this.colHeaderLabelSuffix||""):(this.colHeaderLabelPrefix||"")+(this.colHeaderLabelSuffix||"")}function Ql(t,e,i,s){return i.title?i.title||"":this.rowHeaderLabelType in s?(this.rowHeaderLabelPrefix||"")+s[this.rowHeaderLabelType]+(this.rowHeaderLabelSuffix||""):(this.rowHeaderLabelPrefix||"")+(this.rowHeaderLabelSuffix||"")}var tr={traverseSingleCell:["rightArrow_moveCellCursorRight","downArrow_moveCellCursorDown","leftArrow_moveCellCursorLeft","upArrow_moveCellCursorUp","tab_navigateNext","shiftTab_navigatePrev","enter_openCellEditor","pageDown_moveCellCursorOneViewportDown","pageUp_moveCellCursorOneViewportUp","home_moveCellCursorToRowStart","end_moveCellCursorToRowEnd","ctrlLeftArrow_moveCellCursorToRowStart","ctrlRightArrow_moveCellCursorToRowEnd","ctrlUpArrow_moveCellCursorToColStart","ctrlDownArrow_moveCellCursorToColEnd","ctrlHome_moveCellCursorToSheetStart","ctrlEnd_moveCellCursorToSheetEnd","shiftRightArrow_modifyActiveRangeRightwards","shiftDownArrow_modifyActiveRangeDownwards","shiftLeftArrow_modifyActiveRangeLeftwards","shiftUpArrow_modifyActiveRangeUpwards","backspace_clearCellValues","delete_clearCellValues","ctrlZ_undo","ctrlY_redo","ctrlShiftZ_redo","ctrlA_selectAll","ctrlShiftSlash_openContextMenu"],traverseMultiCell:["rightArrow_moveCellCursorRight","downArrow_moveCellCursorDown","leftArrow_moveCellCursorLeft","upArrow_moveCellCursorUp","tab_navigateNext","shiftTab_navigatePrev","enter_navigateNext","shiftEnter_navigatePrev","pageDown_moveCellCursorOneViewportDown","pageUp_moveCellCursorOneViewportUp","home_moveCellCursorToRowStart","end_moveCellCursorToRowEnd","ctrlLeftArrow_moveCellCursorToRowStart","ctrlRightArrow_moveCellCursorToRowEnd","ctrlUpArrow_moveCellCursorToColStart","ctrlDownArrow_moveCellCursorToColEnd","ctrlHome_moveCellCursorToSheetStart","ctrlEnd_moveCellCursorToSheetEnd","shiftRightArrow_modifyActiveRangeRightwards","shiftDownArrow_modifyActiveRangeDownwards","shiftLeftArrow_modifyActiveRangeLeftwards","shiftUpArrow_modifyActiveRangeUpwards","backspace_clearCellValues","delete_clearCellValues","ctrlZ_undo","ctrlY_redo","ctrlShiftZ_redo","ctrlA_selectAll","ctrlShiftSlash_openContextMenu"],inputModeEnter:["rightArrow_moveCellCursorRight","downArrow_moveCellCursorDown","leftArrow_moveCellCursorLeft","upArrow_moveCellCursorUp","tab_navigateNext","shiftTab_navigatePrev","enter_navigateNext","shiftEnter_navigatePrev","pageDown_moveCellCursorOneViewportDown","pageUp_moveCellCursorOneViewportUp","home_moveCellCursorToRowStart","end_moveCellCursorToRowEnd","ctrlLeftArrow_moveCellCursorToRowStart","ctrlRightArrow_moveCellCursorToRowEnd","ctrlUpArrow_moveCellCursorToColStart","ctrlDownArrow_moveCellCursorToColEnd","ctrlHome_moveCellCursorToSheetStart","ctrlEnd_moveCellCursorToSheetEnd","esc_closeCellEditor"],inputModeEdit:["tab_navigateNext","shiftTab_navigatePrev","enter_navigateNext","shiftEnter_navigatePrev","esc_closeCellEditor"],contextMenuOpen:["esc_closeContextMenu","downArrow_moveContextMenuCursorDown","upArrow_moveContextMenuCursorUp","enter_hitContextMenuItem","ctrlZ_undo","ctrlY_redo","ctrlShiftZ_redo","ctrlA_selectAll"]},er=["cut","copy","paste","hide_cols","hide_rows","insert_cols_before","insert_cols_after","delete_cols","insert_rows_before","insert_rows_after","delete_rows","sort_asc","sort_desc"],ir={component:"#ffffff",button:"#e8eaed","button-icon":"#5f6368",input:"#ffffff","input|text":"#000000","input|border":"#5f6368","input:focus|border":"#0078ff","input-info":"#5f6368",contextmenu:"#ffffff","contextmenu|text":"#000000","contextmenu-item:highlight":"#eeeeee","contextmenu-item-shortcut":"#aaaaaa",blanksheet:"#f3f3f3",sheet:"#ffffff","sheet|text":"#000000",scrollbar:"#ffffff","scrollbar|border":"#999999",gridline:"#555555","gridline-tip":"#000000","gridline|opacity":.2,header:"#f8f9fa","header|text":"#000000","header:highlight":"#e8eaed","header:selected":"#5f6368","header:selected|text":"#ffffff","header-icon":"#000000","cellrange:cut":"#0078ff","cellrange:copy":"#0078ff","cellrange:fill":"#000000",cellcursor:"#0078ff","cellrange:selected":"#0078ff","cellrange:selected|border":"#0078ff","cellrange:selected|opacity":.1,fillhandle:"#0078ff",celleditor:"#0078ff",searchcursor:"#000000","cell+found":"#89bf71","cell+found|opacity":.25,freezeline:"#dadfe8","freezeline-tip":"#bcbcbc",freezelineplaceholder:"#bcbcbc","move?ghost":"#000000","move?ghost|opacity":.15,"move?guide":"#5f6368","move?guide|opacity":1,"freeze?hint":"#a5c6fe","freeze?ghost":"#000000","freeze?ghost|opacity":.15,"freeze?guide":"#000000","freeze?guide|opacity":.3,"resize?hint":"#0078ff","resize?guide":"#0078ff","resize?guide|opacity":1,"show?hint":"#ffffff","show?hint-icon":"#000000","show?hint|border":"#0078ff"},sr={Copy:null,Cut:null,Paste:null,"Delete Row(s)":null,"Hide Row":null,"Hide $n Rows":null,"Hide Column":null,"Hide $n Columns":null,"Insert Row (up)":null,"Insert $n Rows (up)":null,"Insert Row (down)":null,"Insert $n Rows (down)":null,"Delete Column(s)":null,"Insert Column (left)":null,"Insert $n Columns (left)":null,"Insert Column (right)":null,"Insert $n Columns (right)":null,"$n from $total":null,Deselect:null,"Sort A to Z":null,"Sort Z to A":null,Search:null,"Paste not available.":null,"Cannot delete all columns.":null,"Cannot delete all rows.":null,"Cannot hide all columns.":null,"Cannot hide all rows.":null,"Cannot delete all non-frozen columns.":null,"Cannot delete all non-frozen rows.":null,"Cannot move columns in or out of the frozen section. Try turning off frozen columns first.":null,"Cannot move rows in or out of the frozen section. Try turning off frozen rows first.":null},or={default:"default",cell:"default",colHeader:"default",rowHeader:"default",jointHeader:"default",horizontalScrollbar:"default",verticalScrollbar:"default",hiddenColGroupIcon:"default",hiddenRowGroupIcon:"default",freezeLineCol:"grab",freezeLineRow:"grab",freezeLinePlaceholderCol:"grab",freezeLinePlaceholderRow:"grab",freezeLineColEnd:"grab",freezeLineRowEnd:"grab",selectedRowHeader:"grab",selectedColHeader:"grab",fillHandle:"crosshair",colHeaderEdge:"ew-resize",hiddenColGroupIcon:"pointer",hiddenRowGroupIcon:"pointer"},nr={selectCells:"default",selectCols:"default",selectRows:"default",moveCols:"grabbing",moveRows:"grabbing",fillCells:"crosshair",resizeCols:"ew-resize",freezeCols:"grabbing"};function lr(t){return null==t?null:[So.call(this,{x:t[0].x,y:t[0].y}),So.call(this,{x:t[1].x,y:t[1].y})]}function rr(t){for(var e=[],i=0;i<t.length;i++)e.push({range:lr.call(this,Ro(t[i].range)),type:t[i].type});return e}function hr(t){if(l(t)&&"range"in t[0])return t;var e;s(t)?e=t:i(t)?e=[t]:n(t)&&(e=[[{x:t.x,y:t.y},{x:t.x,y:t.y}]]);for(var o=[],r=0;r<e.length;r++)o.push({range:e[r],type:"cell"});return o}function ar(t=null){if(null!=t){var e=rr.call(this,hr(t));this.setCellValues(e,null)}}function cr(t,e=null,i=!1,s=null){var o=[],n=[],l=[],r=[];if(null!=s){var h=[{range:s}];(r=pr.call(this,h,null))[0].action="cut"}var a=pr.call(this,t,e,i);r.length&&a.unshift(r[0]),a.sort((function(t,e){return t.range[0].y-e.range[0].y}));for(var c=0;c<a.length;c++){for(var d=n.length,u=0;u<a[c].rowIds.length;u++)n.indexOf(a[c].rowIds[u])>-1?"rowStartIndex"in a[c]||(a[c].rowStartIndex=n.indexOf(a[c].rowIds[u])):n.push(a[c].rowIds[u]);"rowStartIndex"in a[c]||(a[c].rowStartIndex=d)}a.sort((function(t,e){return t.range[0].x-e.range[0].x}));for(c=0;c<a.length;c++){var p=o.length;for(u=0;u<a[c].colIds.length;u++)o.indexOf(a[c].colIds[u])>-1?"colStartIndex"in a[c]||(a[c].colStartIndex=o.indexOf(a[c].colIds[u])):o.push(a[c].colIds[u]);"colStartIndex"in a[c]||(a[c].colStartIndex=p)}for(c=0;c<n.length;c++){l.push([]);for(u=0;u<o.length;u++)l[c].push(void 0)}a.sort((function(t,e){return"action"in t&&"cut"==t.action?-1:0}));for(c=0;c<a.length;c++)for(var f=a[c].rowStartIndex,g=a[c].colStartIndex,_=0,y=0,m=a[c].range[0].y;m<=a[c].range[1].y;m++){y=0;for(var x=a[c].range[0].x;x<=a[c].range[1].x;x++)l[f+_][g+y]=a[c].values[_][y],y++;_++}var v=[];for(c=0;c<a.length;c++)"action"in a[c]&&"cut"==a[c].action||v.push({range:a[c].range,type:"cell"});return{rowIds:n,colIds:o,values:l,selection:v}}const dr=function(t){for(var e,i=this._cols.store._lastId,s=[],o=t[0].x;o<=t[1].x;o++)null==(e=this.getColIdByCoord(o))&&i++,s.push(e||i);return s},ur=function(t){for(var e,i=this._rows.store._lastId,s=[],o=t[0].y;o<=t[1].y;o++)null==(e=this.getRowIdByCoord(o))&&i++,s.push(e||i);return s},pr=function(t,e,s){for(var o,n,l,r=[],h=0;h<t.length;h++){var a=[{x:t[h].range[0].x,y:t[h].range[0].y},{x:t[h].range[1].x,y:t[h].range[1].y}];if(s&&i(e)){var c=e.length-(1+a[1].y-a[0].y),d=e[0].length-(1+a[1].x-a[0].x);c>0&&(a[1].y+=c),d>0&&(a[1].x+=d)}this.expandSheetOnPaste||(a[1].y=Math.min(a[1].y,this._rows.coordList.length-1),a[1].x=Math.min(a[1].x,this._cols.coordList.length-1)),n=ur.call(this,a),l=dr.call(this,a),o=i(e)?e.length!=n.length||e[0].length!=l.length?gr(a,e):e:fr(a,e),r.push({range:a,rowIds:n,colIds:l,values:o})}return r},fr=function(t,e){for(var i=[],s=0,o=t[0].y;o<=t[1].y;o++){i.push([]);for(var n=t[0].x;n<=t[1].x;n++)i[s].push(e);s++}return i},gr=function(t,e){for(var i=[],s=0,o=0,n=t[0].y;n<=t[1].y;n++){i.push([]),o=0;for(var l=t[0].x;l<=t[1].x;l++){var r=o%e[0].length,h=s%e.length;i[s].push(e[h][r]),o++}s++}return i};function _r(t,e){for(var i=[],s=this._cols.store._lastId,o=0;o<t;o++)s++,this._cols.store.push({id:s,field:void 0,title:void 0,width:this.colWidth,align:this.colAlign,_hide:!1,level:0,parent_id:void 0,_role:"data"}),i.push(s);this._cols.store._lastId=s;for(var n=0;n<this._rows.store.length;n++)for(o=0;o<i.length;o++)this._cellStore[this._rows.store[n].id-1][i[o]-1]={value:null};if(e)l=this._cols.indexList.indexOf(e)+1;else var l=0;this._cols.indexList.splice.apply(this._cols.indexList,[l,0].concat(i));for(o=0;o<i.length;o++)si.call(this,100,i[o]);return i}function yr(t,e){for(var i=[],s=this._rows.store._lastId,o=0;o<t;o++)s++,this._rows.store.push({id:s,title:void 0,_pass:!0}),i.push(s);this._rows.store._lastId=s;for(var n=0;n<this._cols.store.length;n++)for(o=0;o<i.length;o++)null==this._cellStore[i[o]-1]&&(this._cellStore[i[o]-1]=[]),this._cellStore[i[o]-1][this._cols.store[n].id-1]={value:null};if(e)l=this._rows.indexList.indexOf(e)+1;else var l=0;return this._rows.indexList.splice.apply(this._rows.indexList,[l,0].concat(i)),i}function mr(t){for(var e=[],i=0;i<t.length;i++){this._cols.store[t[i]-1]._deleted=!0;var s=this._cols.indexList.indexOf(t[i]);this._cols.indexList.splice(s,1),e.push({id:t[i],index:s})}return e.reverse()}function xr(t){for(var e=[],i=0;i<t.length;i++){this._rows.store[t[i]-1]._deleted=!0;var s=this._rows.indexList.indexOf(t[i]);this._rows.indexList.splice(s,1),e.push({id:t[i],index:s})}return e.reverse()}function vr(t){for(var e=0;e<t.length;e++)delete this._cols.store[t[e].id-1]._deleted,this._cols.indexList.splice(t[e].index,0,t[e].id)}function wr(t){for(var e=0;e<t.length;e++)delete this._rows.store[t[e].id-1]._deleted,this._rows.indexList.splice(t[e].index,0,t[e].id)}function Cr(t){for(var e=0;e<t.rowIds.length;e++)for(var i=0;i<t.colIds.length;i++)if(void 0!==t.values[e][i]){var s=this._cellStore[t.rowIds[e]-1][t.colIds[i]-1];s.value=t.values[e][i],s._found=!1}}function br(t,e,i=0,s=!0){if(null!=t){this._domNodes.cellEditor._isOpen&&this.closeCellEditorAndSave();t=rr.call(this,t);this._activeRangeIndex=Math.min(i,t.length-1),this._cellCursorPosition=null==e?t[this._activeRangeIndex].range[0]:So.call(this,e),this._selection=t,this.constructor.contextMenu.isOpen()&&this.constructor.contextMenu._context==this||Nn.call(this),this.constructor._isTouchDevice||Ci.call(this),this.activate(),this.events.dispatch("setselection",{selection:this._selection,cellCursorPosition:this._cellCursorPosition,_activeRangeIndex:this._activeRangeIndex})}}function Sr(t=null,e="xy"){if(null==t)return{x:0,y:0};var i=this._viewportPosition.x+(this._colView.length-1);this._colViewOverflow>0&&(i-=1);var s=this._viewportPosition.y+(this._rowView.length-1);if(this._rowViewOverflow>0&&(s-=1),t.x<this._viewportPosition.x)var o=t.x-this._viewportPosition.x;else if(t.x>i)o=t.x-i;if(t.y<this._viewportPosition.y)var n=t.y-this._viewportPosition.y;else if(t.y>s)n=t.y-s;return{x:("xy"==e||"x"==e)&&o||0,y:("xy"==e||"y"==e)&&n||0}}function Ir(t){var e={x:this._viewportPosition.x,y:this._viewportPosition.y},i=Sr.call(this,t);t.x>=this._panesXids.left.length&&(e.x+=i.x),t.y>=this._panesYids.top.length&&(e.y+=i.y),Qo.call(this,e)}function Lr(t){if(null!=t&&t.selection.length){for(var e=[],i=0;i<t.selection.length;i++){var s={type:t.selection[i].type,range:t.selection[i].range};e.push(s)}br.call(this,e,t.cellCursorPosition,t.activeRangeIndex),Ir.call(this,this._cellCursorPosition)}}function Rr(){null!=this.constructor._clipboardObject&&ji.call(this.constructor._clipboardObject.instance,this.constructor._clipboardObject.type,null)}function Pr(){this._domNodes.component.style.width=this._cd.componentWidth+"px",this._domNodes.component.style.height=this._cd.componentHeight+"px",this._domNodes.display.style.width=this._cd.displayWidth+"px",this._domNodes.display.style.height=this._cd.displayHeight+"px",this._domNodes.viewport.style.width=this._cd.viewportWidth+"px",this._domNodes.viewport.style.height=this._cd.viewportHeight+"px",this._domNodes.eventArea.style.width=this._cd.scrollAreaWidth+"px",this._domNodes.eventArea.style.height=this._cd.scrollAreaHeight+"px",this._domNodes.scrollArea.style.width=this._cd.scrollAreaWidth+"px",this._domNodes.scrollArea.style.height=this._cd.scrollAreaHeight+"px",this._domNodes.scrollSurface.style.width=this._cd.scrollWidth+"px",this._domNodes.scrollSurface.style.height=this._cd.scrollHeight+"px",this._domNodes.actionRangesContainer.style.width=this._cd.viewportWidth+"px",this._domNodes.actionRangesContainer.style.height=this._cd.viewportHeight+"px",this._domNodes.panes.style.height=this._cd.viewportHeight+"px",this._domNodes.panes.style.width=this._cd.viewportWidth+"px",this._domNodes["pane-left"].style.height=this._cd.viewportHeight+"px",this._domNodes["pane-left"].style.width=this._cd.panesX.left.space+"px",this._domNodes["pane-center"].style.left=this._cd.panesX.center.offset+"px",this._domNodes["pane-center"].style.height=this._cd.viewportHeight+"px",this._domNodes["pane-center"].style.width=this._cd.panesX.center.space+"px",this._domNodes.hintsContainer.style.width=this._cd.viewportWidth+"px",this._domNodes.hintsContainer.style.height=this._cd.viewportHeight+"px",Fr.call(this),Br.call(this),Nr.call(this),Hr.call(this),zr.call(this),kr.call(this),Ar.call(this),Tr.call(this)}const Nr=function(){N(this._domNodes.ghostsContainer,{width:this._cd.viewportWidth+"px",height:this._cd.viewportHeight+"px"}),N(this._domNodes.guidesContainer,{width:this._cd.viewportWidth+"px",height:this._cd.viewportHeight+"px"})},Hr=function(){this._domNodes.colHeaderBackground.style.width=this._cd.viewportWidth+"px"},zr=function(){this._domNodes.rowHeaderBackground.style.height=this._cd.viewportHeight+"px"},kr=function(){this._domNodes.gridLines.style.width=this._cd.viewportWidth+"px",this._domNodes.gridLines.style.height=this._cd.viewportHeight+"px",this._domNodes.rowLines.style.width=this._cd.viewportWidth+"px",this._domNodes.colLines.style.height=this._cd.viewportHeight+"px"},Ar=function(){this._domNodes.backgrounds.style.height=this._cd.viewportHeight+"px",this._domNodes.backgrounds.style.width=this._cd.viewportWidth+"px",N(this._domNodes.background["top-left"],{width:this._cd.panesX.left.space-this._cd.rowHeaderSpace+"px",height:this._cd.panesY.top.space-this._cd.colHeaderSpace+"px"}),N(this._domNodes.background["top-center"],{width:this._cd.panesX.center.space+"px",height:this._cd.panesY.top.space-this._cd.colHeaderSpace+"px",left:this._cd.panesX.center.offset+"px"}),N(this._domNodes.background["center-left"],{width:this._cd.panesX.left.space-this._cd.rowHeaderSpace+"px",height:this._cd.panesY.center.space+"px",top:this._cd.panesY.center.offset+"px"}),N(this._domNodes.background["center-center"],{width:this._cd.panesX.center.space+"px",height:this._cd.panesY.center.space+"px",top:this._cd.panesY.center.offset+"px",left:this._cd.panesX.center.offset+"px"})},Tr=function(){for(var t in this._domNodes.canvas){var[e,i]=t.split("-"),s=this._cd.panesX[i].space,o=this._cd.panesY[e].space,n=1*Math.ceil(s/1),l=Math.ceil(o/this.rowHeight)*this.rowHeight,r=this._domNodes.canvas[t];r.style.width=n+"px",r.style.height=l+"px",r._displayWidth=n,r._displayHeight=l,r._drawWidth=r._displayWidth/1,r._drawHeight=r._displayHeight/this.rowHeight,r.width=r._drawWidth,r.height=r._drawHeight}},Fr=function(){this._domNodes.rowHeaderColumn.style.height=this._cd.viewportHeight+"px",this._domNodes["column-center"].style.top=this._cd.panesY.center.offset-this._cd.colHeaderSpace+"px",this._domNodes["column-center"].style.height=this._cd.panesY.center.space+"px";for(var t=0;t<this._columnNodes.length;t++)this._columnNodes[t].column.style.height=this._cd.viewportHeight+"px",this._columnNodes[t]["column-top"].style.height=this._cd.panesY.top.outer-this._cd.colHeaderSpace+"px",this._columnNodes[t]["column-center"].style.height=this._cd.panesY.center.space+"px"},Br=function(){this._domNodes.freezeLines.style.height=this._cd.viewportHeight+"px",this._domNodes.freezeLines.style.width=this._cd.viewportWidth+"px",this._domNodes.placeholderFreezeLines.style.height=this._cd.viewportHeight+"px",this._domNodes.placeholderFreezeLines.style.width=this._cd.viewportWidth+"px",null==this._freezeLineRowAfterId?N(this._domNodes["freezeLine-row"],{top:this._cd.panesY.center.offset-6+"px","background-color":"transparent",opacity:1}):N(this._domNodes["freezeLine-row"],{top:this._cd.panesY.top.space+"px","background-color":this.getThemeSetting("freezeline"),opacity:this._sectionsPerPaneY.top.length?1:0}),null==this._freezeLineColAfterId?N(this._domNodes["freezeLine-col"],{left:this._cd.panesX.center.offset-6+"px","background-color":"transparent",opacity:1}):N(this._domNodes["freezeLine-col"],{left:this._cd.panesX.left.space+"px","background-color":this.getThemeSetting("freezeline"),opacity:this._sectionsPerPaneX.left.length?1:0})};function Mr(t){var e=[],i=-1;if(t=t.toLowerCase()){for(var s=0;s<this._rows.coordList.length;s++)for(var o=0;o<this._cols.coordList.length;o++){var n=this._cellStore[this._rows.coordList[s]-1][this._cols.coordList[o]-1];null!=n.value&&String(n.value).toLowerCase().indexOf(t)>-1&&(n._found=t,e.push([this._rows.coordList[s],this._cols.coordList[o]]))}e.length&&(i=0)}this._searchStr=t,this._searchCellsFound=e,this._searchCellIndex=i}function Er(t=""){if(C.call(this),w.call(this),t.endsWith("Cols"))for(var e=0;e<this._cols.indexList.length;e++){var i=this._cols.indexList[e];this._columnNodes[i-1].columnHeaderLabel.innerHTML=Qe.call(this,i)}var s=!1,o=!1;("hideCols"==t&&this._viewportPosition.x==this._panesXids.left.length||"freezeCols"==t)&&(s=!0),("hideRows"==t&&this._viewportPosition.y==this._panesYids.top.length||"freezeRows"==t)&&(o=!0),Ot.call(this),Yt.call(this,s,o),Rr.call(this),Pr.call(this),"search"!=t&&this._searchStr&&Mr.call(this,this._searchStr);for(e=0;e<this._validatedTopBar.length;e++)"update"in this._validatedTopBar[e]&&this._validatedTopBar[e].update.call(this,this._topBarNodes[e].nodes);for(e=0;e<this._validatedBottomBar.length;e++)"update"in this._validatedBottomBar[e]&&this._validatedBottomBar[e].update.call(this,this._bottomBarNodes[e].nodes);setTimeout(()=>{Zo.call(this)},0)}function Or(t,e=!0,i=function(){}){var s,o=Dl.call(this),n=[],l=[],r=[],h=[],a=[];const c=function(t="do",e,i=function(){},o=null){if(!this.events.dispatch("beforesetcellvalues",e))return;Rr.call(this),"do"==t?(l=Xr.call(this,e),r=Vr.call(this,e),(l.length||r.length)&&Er.call(this,"insertEmptyItems")):"undo"==t?(l.length&&(h=mr.call(this,l)),r.length&&(a=xr.call(this,r))):"redo"==t&&(h.length&&vr.call(this,h),a.length&&wr.call(this,a),(l.length||r.length)&&Er.call(this,"insertEmptyItems")),i.call(this),null!=o&&(s=Dl.call(this));var c=0;var d=function(){var t=performance.now(),i=[],s=e.colIds,l=[];if(null!=o)do{i.push(e.rowIds[c]),l.push(e.values[c]);for(var r=[],h=0;h<s.length;h++)r.push(this._cellStore[e.rowIds[c]-1][s[h]-1].value||null);n.push(r),c++}while(c<=e.rowIds.length-1&&performance.now()-t<25);else do{i.push(e.rowIds[c]),l.push(e.values[c]),c++}while(c<=e.rowIds.length-1&&performance.now()-t<25);Cr.call(this,{rowIds:i,colIds:s,values:l}),Er.call(this,"setCellValues"),this.redraw(),c<e.rowIds.length-1?setTimeout(d,75):(this.events.dispatch("setcellvalues",e),null!=o&&o.call(this))}.bind(this);d()};if(e)var d=function(){var e=fs(t);e.values=n,this.undoManager.add({desc:"setCellValues",undo:function(){c.call(this,"undo",e,(function(){Lr.call(this,o)}))},redo:function(){c.call(this,"redo",t,(function(){Lr.call(this,s)}))}})};else d=null;c.call(this,"do",t,i,d)}const Xr=function(t){for(var e=0,i=0;i<t.colIds.length;i++)null==this.getColFromStore(t.colIds[i])&&e++;if(e)var s=_r.call(this,e,this._cols.coordList[this._cols.coordList.length-1]);return s||[]},Vr=function(t){for(var e=0,i=0;i<t.rowIds.length;i++)null==this.getRowFromStore(t.rowIds[i])&&e++;if(e)var s=yr.call(this,e,this._rows.coordList[this._rows.coordList.length-1]);return s||[]};function Yr(t=null,e=null,i=!1,s=!1){if(null!=t){var o=rr.call(this,hr(t));if(s)var n=this.constructor._clipboardObject.cellRange,l=cr.call(this,o,e,i,n);else l=cr.call(this,o,e,i);if(i)var r=function(){br.call(this,l.selection)};else r=function(){};Or.call(this,l,!0,r)}}function Kr(t,e,i){ji.call(this,"fill",null);var s=this.getCellRangeData(t),o=[];if("right"==e)for(var l=0;l<s.length;l++)o.push({series:s[l]});else if("left"==e)for(l=0;l<s.length;l++)o.push({series:s[l].reverse()});else if("down"==e)for(var r=0;r<s[0].length;r++){for(var h=[],a=0;a<s.length;a++)h.push(s[a][r]);o.push({series:h})}else if("up"==e)for(r=0;r<s[0].length;r++){for(h=[],a=0;a<s.length;a++)h.push(s[a][r]);o.push({series:h.reverse()})}if(Wr(o),"right"==e)var c=[{x:t[1].x+1,y:t[0].y},{x:Math.min(this._cols.coordList.length-1,t[1].x+i),y:t[1].y}];else if("left"==e)c=[{x:Math.max(0,t[0].x-i),y:t[0].y},{x:t[0].x-1,y:t[1].y}];else if("down"==e)c=[{x:t[0].x,y:t[1].y+1},{x:t[1].x,y:Math.min(this._rows.coordList.length-1,t[1].y+i)}];else if("up"==e)c=[{x:t[0].x,y:Math.max(0,t[0].y-i)},{x:t[1].x,y:t[0].y-1}];var d=c[1].y-c[0].y+1,u=c[1].x-c[0].x+1,p=[];if("right"==e)for(a=0;a<d;a++){p.push([]);for(r=0;r<u;r++){var f=1+Math.floor(r/o[a].groups.length),g=r%o[a].groups.length;if(n(o[a].groups[g])){var _=g-o[a].groups[g].startIndex+o[a].groups[g].size*f,y=o[a].groups[g].base+_*o[a].groups[g].increment;y=Math.round(100*y)/100,p[a].push(y)}else p[a].push(o[a].groups[g])}}else if("left"==e)for(a=0;a<d;a++){p.push([]);for(r=0;r<u;r++){f=1+Math.floor(r/o[a].groups.length),g=r%o[a].groups.length;if(n(o[a].groups[g])){_=g-o[a].groups[g].startIndex+o[a].groups[g].size*f,y=o[a].groups[g].base+_*o[a].groups[g].increment;y=Math.round(100*y)/100,p[a].unshift(y)}else p[a].unshift(o[a].groups[g])}}else if("down"==e)for(a=0;a<d;a++){p.push([]);for(r=0;r<u;r++){f=1+Math.floor(a/o[r].groups.length),g=a%o[r].groups.length;if(n(o[r].groups[g])){_=g-o[r].groups[g].startIndex+o[r].groups[g].size*f,y=o[r].groups[g].base+_*o[r].groups[g].increment;y=Math.round(100*y)/100,p[a].push(y)}else p[a].push(o[r].groups[g])}}else if("up"==e)for(a=0;a<d;a++){p.unshift([]);for(r=0;r<u;r++){f=1+Math.floor(a/o[r].groups.length),g=a%o[r].groups.length;if(n(o[r].groups[g])){_=g-o[r].groups[g].startIndex+o[r].groups[g].size*f,y=o[r].groups[g].base+_*o[r].groups[g].increment;y=Math.round(100*y/100),p[0].push(y)}else p[0].push(o[r].groups[g])}}var m=[{type:"cell",range:c}],x=cr.call(this,m,p,!1);Or.call(this,x,!0,(function(){if(Ss(this._cellCursorPosition,t))var e=this._cellCursorPosition;else e=null;var i,s;br.call(this,[{type:"cell",range:(i=t,s=x.selection[0].range,[{x:Math.min(i[0].x,i[1].x,s[0].x,s[1].x),y:Math.min(i[0].y,i[1].y,s[0].y,s[1].y)},{x:Math.max(i[0].x,i[1].x,s[0].x,s[1].x),y:Math.max(i[0].y,i[1].y,s[0].y,s[1].y)}])}],e)}))}const Wr=function(t){for(var e=0;e<t.length;e++)t[e].groups=i(t[e].series);function i(t){for(var e,i,o,n=[],l=null,r=0;r<t.length;r++)e=""!==(o=t[r])&&null!==o&&!isNaN(o)&&isFinite(o)&&Math.floor(o)===Number(o)?"number":"string",null==l?i=[t[r]]:e==l?i.push(t[r]):("number"==l&&i.length&&(i=s(i,r-i.length)),Array.prototype.push.apply(n,i),i=[t[r]]),l=e;return i.length&&("number"==l&&i.length&&(i=s(i,r-i.length)),Array.prototype.push.apply(n,i)),n}function s(t,e){for(var i=null,s=null,o=0;o<t.length-1;o++){if(i=t[o+1]-t[o],o>0&&i!=s){i=null;break}s=i}if(null!=i){var n={base:Number(t[0]),increment:i,startIndex:e,size:t.length},l=[];for(o=0;o<t.length;o++)l.push(n)}return l||t}};function Dr(t){var e;s(t)?e=t:i(t)?e=[t]:u(t)&&(e=[[t,t]]);for(var o=[],n=0;n<e.length;n++)o.push({range:el.call(this,e[n]),type:"col"});return o}function jr(t=null){if(null==t)return[];for(var e=rr.call(this,Dr.call(this,t)),i=new Set,s=0;s<e.length;s++)for(var o=this.getColIndexByCoord(e[s].range[0].x),n=this.getColIndexByCoord(e[s].range[1].x),l=o;l<=n;l++)i.add(this._cols.indexList[l]);return Array.from(i).sort((t,e)=>this._cols.indexList.indexOf(t)-this._cols.indexList.indexOf(e))}function Ur(t=null){this.deleteColsById(jr.call(this,t))}function Gr(t=1){t=Zs(t,0,this._cols.indexList.length-1),this.freezeColsUntilId(this.getColIdByIndex(t-1))}function $r(t=null){this.hideColsById(jr.call(this,t))}function Zr(t){for(var e=[],i=0;i<t.length;i++)e.push(t[i]);return e}function qr(t,e,i=!0,s=function(){}){var o={amount:t,targetId:e};if(this.events.dispatch("beforeinsertcols",o)){var n=Dl.call(this),l=_r.call(this,o.amount,o.targetId);Er.call(this,"insertEmptyCols"),s.call(this,l),this.redraw();var r,h=Dl.call(this);i&&this.undoManager.add({desc:"insertCols",undo:function(){r=mr.call(this,l),Er.call(this,"deleteCols"),Lr.call(this,n),this.redraw()},redo:function(){vr.call(this,r),Er.call(this,"restoreDeletedCols"),Lr.call(this,h),this.redraw()}}),o.insertedIds=Zr(l),this.events.dispatch("insertcols",o)}}function Jr(t){i(t)||(t=[t,t]);var e=t[0],s=t[t.length-1];return[this._cols.coordList.indexOf(e),this._cols.coordList.indexOf(s)]}function Qr(t=1,e){if(void 0===e&&(e=this._cols.coordList.length),0==(e=Zs(e,0,this._cols.coordList.length)))var i=0;else i=this._cols.coordList[Math.min(this._cols.coordList.length,e)-1];qr.call(this,t,i,!0,(function(t){this.setColSelection(Jr.call(this,t))}))}function th(t="rows",e){for(var i,s=[],o=0;o<e.length;o++)s.push(this["_"+t].coordList.indexOf(e[o]));s.sort();var n=[],l=[];for(o=0;o<s.length;o++)s[o]==i+1||0==o?l.push(s[o]):(n.push(l),l=[s[o]]),i=s[o];return n.push(l),n}function eh(t){for(var e=[],i=0;i<t.length;i++)e.push([t[i][0],t[i][t[i].length-1]]);return e}function ih(t){for(var e=[],i=0;i<t.length;i++){var s=this._cols.indexList.indexOf(t[i].id);if(e.push({id:t[i].id,afterId:this._cols.indexList[s-1]||null}),this._cols.indexList.splice(s,1),t[i].afterId)o=this._cols.indexList.indexOf(t[i].afterId)+1;else var o=0;this._cols.indexList.splice(o,0,t[i].id)}return e.reverse()}function sh(t,e,i=!0,s=function(){}){var o={colIds:t,targetId:e};if(this.events.dispatch("beforemovecols",o)){var n,l=oh(o.colIds,o.targetId),r=Dl.call(this);n=ih.call(this,l),Er.call(this,"moveCols"),s.call(this),this.redraw();var h=Dl.call(this);i&&this.undoManager.add({desc:"moveCols",undo:function(){ih.call(this,n),Er.call(this,"moveCols"),Lr.call(this,r),this.redraw()},redo:function(){ih.call(this,l),Er.call(this,"moveCols"),Lr.call(this,h),this.redraw()}}),this.events.dispatch("movecols",o)}}const oh=function(t,e){for(var i=[],s=0;s<t.length;s++)i.push({id:t[s],afterId:e});return i.reverse()};function nh(t=null,e=null){if(null!=t&&null!=e){var i=jr.call(this,t);if(e=Zs(e,0,this._cols.coordList.length),lh.call(this,i,e)){if(0==e)var s=0;else s=this._cols.coordList[e-1];i.indexOf(s)>-1||sh.call(this,i,s,!0,(function(){this.setColSelection(eh(th.call(this,"cols",i)))}))}else this.alertUser("Cannot move columns in or out of the frozen section. Try turning off frozen columns first.")}}const lh=function(t,e){if(this.getColCoordById(t[0])==e)return!0;for(var i=!0,s=0;s<t.length;s++)this._cols.coordSections[0].indexOf(t[s])>-1&&(i=!1);return e<this._cols.coordSections[0].length&&(i=!1),i};function rh(t,e){for(var i=0;i<t.length;i++)this._columnNodes[t[i]-1].column.style.width=e[i]+"px"}function hh(t,e){for(var i=0;i<t.length;i++)void 0!==e[i]&&(this._cols.store[t[i]-1].width=1*Math.round(Math.max(e[i],32)/1));rh.call(this,t,e)}function ah(t,e,i=!0,s=function(){}){var o={colIds:t,widths:e};if(this.events.dispatch("beforeresizecols",o)){for(var n=Dl.call(this),l=[],r=0;r<o.colIds.length;r++)l.push(this._cols.store[o.colIds[r]-1].width);hh.call(this,o.colIds,o.widths),Er.call(this,"resizeCols"),s.call(this),this.redraw();var h=Dl.call(this);i&&this.undoManager.add({desc:"resizeCols",undo:function(){hh.call(this,o.colIds,l),Er.call(this,"resizeCols"),Lr.call(this,n),this.redraw()},redo:function(){hh.call(this,o.colIds,o.widths),Er.call(this,"resizeCols"),Lr.call(this,h),this.redraw()}}),this.events.dispatch("resizecols",o)}}function ch(t=null,e=null){if(null!=t&&null!=e){for(var i=jr.call(this,t),s=[],o=2*Math.round(Math.max(Math.round(e),32)/2),n=0;n<i.length;n++)s.push(o);ah.call(this,i,s,!0)}}function dh(t=null){if(null!=t){for(var e=jr.call(this,t),i=[],s=0;s<e.length;s++){for(var o,n=0,l=0;l<this._rows.coordList.length;l++)if(null!=(o=this._cellStore[this.getRowIdByCoord(l)-1][e[s]-1].value)){var r=String(o).replace(/\n/g,"↵").replace(/\t/g," "),h=this._textWidthMeterCanvasContext.measureText(r).width;h>n&&(n=h)}n+=12;var a=2*Math.round(Math.max(Math.round(n),32)/2);i.push(a)}ah.call(this,e,i,!0)}}function uh(t,e=!0,i=function(){}){var s={colIds:t};if(this.events.dispatch("beforedeletecols",s)){var o=this._freezeLineColAfterId,n=Dl.call(this),l=mr.call(this,s.colIds);ph.call(this),Er.call(this,"deleteCols"),i.call(this),this.redraw();var r=Dl.call(this);e&&this.undoManager.add({desc:"deleteCols",undo:function(){vr.call(this,l),fh.call(this,o),Er.call(this,"restoreDeletedCols"),Lr.call(this,n),this.redraw()},redo:function(){mr.call(this,s.colIds),ph.call(this),Er.call(this,"deleteCols"),Lr.call(this,r),this.redraw()}}),this.events.dispatch("deletecols",s)}}const ph=function(){if(this._freezeLineColAfterId&&-1==this.getColIndexById(this._freezeLineColAfterId)){for(var t=null,e=this._cols.coordSections[0].slice(0,-1).reverse();e.length;){var i=e.shift();if(this.getColIndexById(i)>-1){t=i;break}}this._freezeLineColAfterId=t}},fh=function(t){this._freezeLineColAfterId=t};function gh(t="rows",e){for(var i=th.call(this,t,e),s=new Set,o=0;o<i.length;o++){var n=i[o][i[o].length-1];n+1>this["_"+t].coordList.length-1?s.add(this["_"+t].coordList[n-1]):s.add(this["_"+t].coordList[n+1])}return Array.from(s)}function _h(t){if(t.length!=this._cols.coordList.length)if(JSON.stringify(t)!=JSON.stringify(this._cols.indexSections[1])){var e=gh.call(this,"cols",t);uh.call(this,t,!0,(function(){for(var t=[],i=0;i<e.length;i++)t.push({range:[{x:this.getColCoordById(e[i]),y:0},{x:this.getColCoordById(e[i]),y:this._rows.coordList.length-1}],type:"col"});br.call(this,t)}))}else this.alertUser("Cannot delete all non-frozen columns.");else this.alertUser("Cannot delete all columns.")}function yh(t){this._preventFrozenCols||(this._freezeLineColAfterId=t)}function mh(t,e=!0,i=function(){}){var s={colId:t};if(this.events.dispatch("beforefreezecols",s)){var o=this._freezeLineColAfterId,n=Dl.call(this);yh.call(this,s.colId),Er.call(this,"freezeCols"),i.call(this),this.redraw();var l=Dl.call(this);e&&this.undoManager.add({desc:"freezeCols",undo:function(){yh.call(this,o),Er.call(this,"freezeCols"),Lr.call(this,n),this.redraw()},redo:function(){yh.call(this,s.colId),Er.call(this,"freezeCols"),Lr.call(this,l),this.redraw()}}),this.events.dispatch("freezecols",s)}}function xh(t=null){mh.call(this,t,!0)}function vh(t){for(var e=0;e<t.length;e++)this._cols.store[t[e]-1]._hide=!0}function wh(t){for(var e=0;e<t.length;e++)this._cols.store[t[e]-1]._hide=!1}function Ch(t,e=!0,i=function(){}){var s={colIds:t};if(this.events.dispatch("beforehidecols",s)){var o=Dl.call(this);vh.call(this,s.colIds),Er.call(this,"hideCols"),i.call(this),this.redraw();var n=Dl.call(this);e&&this.undoManager.add({desc:"hideCols",undo:function(){wh.call(this,s.colIds),Er.call(this,"showCols"),Lr.call(this,o),this.redraw()},redo:function(){vh.call(this,s.colIds),Er.call(this,"hideCols"),Lr.call(this,n),this.redraw()}}),this.events.dispatch("hidecols",s)}}function bh(t){if(t.length!=this._cols.coordList.length){var e=gh.call(this,"cols",t);Ch.call(this,t,!0,(function(){for(var t=[],i=0;i<e.length;i++)t.push({range:[{x:this.getColCoordById(e[i]),y:0},{x:this.getColCoordById(e[i]),y:this._rows.coordList.length-1}],type:"col"});br.call(this,t)}))}else this.alertUser("Cannot hide all columns.")}function Sh(t,e=!0,i=function(){}){var s={colIds:t};if(this.events.dispatch("beforeshowcols",s)){var o=Dl.call(this);wh.call(this,s.colIds),Er.call(this,"showCols"),i.call(this),this.redraw();var n=Dl.call(this);e&&this.undoManager.add({desc:"showCols",undo:function(){vh.call(this,s.colIds),Er.call(this,"hideCols"),Lr.call(this,o),this.redraw()},redo:function(){wh.call(this,s.colIds),Er.call(this,"showCols"),Lr.call(this,n),this.redraw()}}),this.events.dispatch("showcols",s)}}function Ih(t){Sh.call(this,t,!0,(function(){this.setColSelection(eh(th.call(this,"cols",t)))}))}function Lh(t){var e;s(t)?e=t:i(t)?e=[t]:u(t)&&(e=[[t,t]]);for(var o=[],n=0;n<e.length;n++)o.push({range:il.call(this,e[n]),type:"row"});return o}function Rh(t=null){if(null==t)return[];for(var e=rr.call(this,Lh.call(this,t)),i=new Set,s=0;s<e.length;s++)for(var o=this.getRowIndexByCoord(e[s].range[0].y),n=this.getRowIndexByCoord(e[s].range[1].y),l=o;l<=n;l++)i.add(this._rows.indexList[l]);return Array.from(i).sort((t,e)=>this._rows.indexList.indexOf(t)-this._rows.indexList.indexOf(e))}function Ph(t=null){this.deleteRowsById(Rh.call(this,t))}function Nh(t=1){t=Zs(t,0,this._rows.indexList.length-1),this.freezeRowsUntilId(this.getRowIdByIndex(t-1))}function Hh(t){this.hideRowsById(Rh.call(this,t))}function zh(t,e,i=!0,s=function(){}){var o={amount:t,targetId:e};if(this.events.dispatch("beforeinsertrows",o)){var n=Dl.call(this),l=yr.call(this,o.amount,o.targetId);Er.call(this,"insertEmptyRows"),s.call(this,l),this.redraw();var r,h=Dl.call(this);i&&this.undoManager.add({desc:"insertRows",undo:function(){r=xr.call(this,l),Er.call(this,"deleteRows"),Lr.call(this,n),this.redraw()},redo:function(){wr.call(this,r),Er.call(this,"restoreDeletedRows"),Lr.call(this,h),this.redraw()}}),o.insertedIds=Zr(l),this.events.dispatch("insertrows",o)}}function kh(t){i(t)||(t=[t,t]);var e=t[0],s=t[t.length-1];return[this._rows.coordList.indexOf(e),this._rows.coordList.indexOf(s)]}function Ah(t=1,e){if(void 0===e&&(e=this._rows.coordList.length),0==(e=Zs(e,0,this._rows.coordList.length)))var i=0;else i=this._rows.coordList[e-1];zh.call(this,t,i,!0,(function(t){this.setRowSelection(kh.call(this,t))}))}function Th(t){for(var e=[],i=0;i<t.length;i++){var s=this._rows.indexList.indexOf(t[i].id);if(e.push({id:t[i].id,afterId:this._rows.indexList[s-1]||null}),this._rows.indexList.splice(s,1),t[i].afterId)o=this._rows.indexList.indexOf(t[i].afterId)+1;else var o=0;this._rows.indexList.splice(o,0,t[i].id)}return e.reverse()}function Fh(t,e,i=!0,s=function(){}){var o={rowIds:t,targetId:e};if(this.events.dispatch("beforemoverows",o)){var n,l=Bh(o.rowIds,o.targetId),r=Dl.call(this);n=Th.call(this,l),Er.call(this,"moveRows"),s.call(this),this.redraw();var h=Dl.call(this);i&&this.undoManager.add({desc:"moveRows",undo:function(){Th.call(this,n),Er.call(this,"moveRows"),Lr.call(this,r),this.redraw()},redo:function(){Th.call(this,l),Er.call(this,"moveRows"),Lr.call(this,h),this.redraw()}}),this.events.dispatch("moverows",o)}}const Bh=function(t,e){for(var i=[],s=0;s<t.length;s++)i.push({id:t[s],afterId:e});return i.reverse()};function Mh(t=null,e=null){if(null!=t&&null!=e){var i=Rh.call(this,t);if(e=Zs(e,0,this._rows.coordList.length),Eh.call(this,i,e)){if(0==e)var s=0;else s=this._rows.coordList[e-1];i.indexOf(s)>-1||Fh.call(this,i,s,!0,(function(){this.setRowSelection(eh(th.call(this,"rows",i)))}))}else this.alertUser("Cannot move rows in or out of the frozen section. Try turning off frozen rows first.")}}const Eh=function(t,e){if(this.getRowCoordById(t[0])==e)return!0;for(var i=!0,s=0;s<t.length;s++)this._rows.coordSections[0].indexOf(t[s])>-1&&(i=!1);return e<this._rows.coordSections[0].length&&(i=!1),i};function Oh(t,e=!0,i=function(){}){var s={rowIds:t};if(this.events.dispatch("beforedeleterows",s)){var o=this._freezeLineRowAfterId,n=Dl.call(this),l=xr.call(this,s.rowIds);Xh.call(this),Er.call(this,"deleteRows"),i.call(this),this.redraw();var r=Dl.call(this);e&&this.undoManager.add({desc:"deleteRows",undo:function(){wr.call(this,l),Vh.call(this,o),Er.call(this,"restoreDeletedRows"),Lr.call(this,n),this.redraw()},redo:function(){xr.call(this,s.rowIds),Xh.call(this),Er.call(this,"deleteRows"),Lr.call(this,r),this.redraw()}}),this.events.dispatch("deleterows",s)}}const Xh=function(){if(this._freezeLineRowAfterId&&-1==this.getRowIndexById(this._freezeLineRowAfterId)){for(var t=null,e=this._rows.coordSections[0].slice(0,-1).reverse();e.length;){var i=e.shift();if(this.getRowIndexById(i)>-1){t=i;break}}this._freezeLineRowAfterId=t}},Vh=function(t){this._freezeLineRowAfterId=t};function Yh(t){if(t.length!=this._rows.indexList.length)if(JSON.stringify(t)!=JSON.stringify(this._rows.indexSections[1])){var e=gh.call(this,"rows",t);Oh.call(this,t,!0,(function(){for(var t=[],i=0;i<e.length;i++)t.push({range:[{x:0,y:this.getRowCoordById(e[i])},{x:this._cols.coordList.length-1,y:this.getRowCoordById(e[i])}],type:"row"});br.call(this,t)}))}else this.alertUser("Cannot delete all non-frozen rows.");else this.alertUser("Cannot delete all rows.")}function Kh(t){this._preventFrozenRows||(this._freezeLineRowAfterId=t)}function Wh(t,e=!0,i=function(){}){var s={rowId:t};if(this.events.dispatch("beforefreezerows",s)){var o=this._freezeLineRowAfterId,n=Dl.call(this);Kh.call(this,s.rowId),Er.call(this,"freezeRows"),i.call(this),this.redraw();var l=Dl.call(this);e&&this.undoManager.add({desc:"freezeRows",undo:function(){Kh.call(this,o),Er.call(this,"freezeRows"),Lr.call(this,n),this.redraw()},redo:function(){Kh.call(this,s.rowId),Er.call(this,"freezeRows"),Lr.call(this,l),this.redraw()}}),this.events.dispatch("freezerows",s)}}function Dh(t=null){Wh.call(this,t,!0)}function jh(t){for(var e=0;e<t.length;e++)this._rows.store[t[e]-1]._hide=!0}function Uh(t){for(var e=0;e<t.length;e++)this._rows.store[t[e]-1]._hide=!1}function Gh(t,e=!0,i=function(){}){var s={rowIds:t};if(this.events.dispatch("beforehiderows",s)){var o=Dl.call(this);jh.call(this,s.rowIds),Er.call(this,"hideRows"),i.call(this),this.redraw();var n=Dl.call(this);e&&this.undoManager.add({desc:"hideRows",undo:function(){Uh.call(this,s.rowIds),Er.call(this,"showRows"),Lr.call(this,o),this.redraw()},redo:function(){jh.call(this,s.rowIds),Er.call(this,"hideRows"),Lr.call(this,n),this.redraw()}}),this.events.dispatch("hiderows",s)}}function $h(t){if(t.length!=this._rows.coordList.length){var e=gh.call(this,"rows",t);Gh.call(this,t,!0,(function(){for(var t=[],i=0;i<e.length;i++)t.push({range:[{x:0,y:this.getRowCoordById(e[i])},{x:this._cols.coordList.length-1,y:this.getRowCoordById(e[i])}],type:"row"});br.call(this,t)}))}else this.alertUser("Cannot hide all rows.")}function Zh(t,e=!0,i=function(){}){var s={rowIds:t};if(this.events.dispatch("beforeshowrows",s)){var o=Dl.call(this);Uh.call(this,s.rowIds),Er.call(this,"showRows"),i.call(this),this.redraw();var n=Dl.call(this);e&&this.undoManager.add({desc:"showRows",undo:function(){jh.call(this,s.rowIds),Er.call(this,"hideRows"),Lr.call(this,o),this.redraw()},redo:function(){Uh.call(this,s.rowIds),Er.call(this,"showRows"),Lr.call(this,n),this.redraw()}}),this.events.dispatch("showrows",s)}}function qh(t){Zh.call(this,t,!0,(function(){this.setRowSelection(eh(th.call(this,"rows",t)))}))}function Jh(){if(this._searchCellsFound.length){var t=this._searchCellsFound[this._searchCellIndex],e={x:this.getColCoordById(t[1]),y:this.getRowCoordById(t[0])},i=hr.call(this,e);br.call(this,i,e,0)}this.search("")}function Qh(t){if(Mr.call(this,t),this._searchCellsFound.length){var e=this._searchCellsFound[this._searchCellIndex];Ir.call(this,{x:this.getColCoordById(e[1]),y:this.getRowCoordById(e[0])})}Er.call(this,"search"),this.redraw()}function ta(t=""){Qh.call(this,t)}function ea(){if(this._searchCellsFound.length){this._searchCellIndex==this._searchCellsFound.length-1?this._searchCellIndex=0:this._searchCellIndex++;var t=this._searchCellsFound[this._searchCellIndex];Ir.call(this,{x:this.getColCoordById(t[1]),y:this.getRowCoordById(t[0])}),Er.call(this,"search"),this.redraw()}}function ia(){if(this._searchCellsFound.length){0==this._searchCellIndex?this._searchCellIndex=this._searchCellsFound.length-1:this._searchCellIndex--;var t=this._searchCellsFound[this._searchCellIndex];Ir.call(this,{x:this.getColCoordById(t[1]),y:this.getRowCoordById(t[0])}),Er.call(this,"search"),this.redraw()}}function sa(t){if(!this._sortState.length){this._rowOrderStore=[];for(var e=0;e<this._rows.indexList.length;e++)this._rowOrderStore[this._rows.indexList[e]-1]=this._rows.indexList.length-e}var i,s=[],o={};for(e=this._rows.coordSections[0].length;e<this._rows.indexList.length;e++)if(this._rows.store[this._rows.indexList[e]-1]._hide)o[e]=this._rows.indexList[e];else{for(var n=[],l=0;l<t.length;l++)null===(i=this._cellStore[this._rows.indexList[e]-1][t[l][0]-1].value)&&(i=""),n.push(String(i));s.push([this._rows.indexList[e],n]);var r="";for(l=0;l<t.length;l++)r+=t[l].join("-"),l<t.length-1&&(r+="_");if(!(r in this._sortFunctions)){var h=oa(t);this._sortFunctions[r]=new Function("a,b",h)}}s.sort(this._sortFunctions[r]);var a=[];for(l=0;l<this._rows.coordSections[0].length;l++)a.push(this._rows.coordSections[0][l]);for(l=0;l<s.length;l++)a.push(s[l][0]);for(var c in o)a.splice(c,0,o[c]);this._rows.indexList=a,this._sortState=t}const oa=function(t){for(var e="return ",i=0;i<t.length;i++)i>0&&(e+="||"),e+=`(\n      a[1][${i}] === b[1][${i}] ? 0 : (\n        a[1][${i}] == '' ? 1 : (\n          b[1][${i}] == '' ? -1 : (`,"asc"==t[i][1]?e+=`a[1][${i}].localeCompare(b[1][${i}], undefined, { numeric: true, sensitivity: 'base' })`:"desc"==t[i][1]&&(e+=`b[1][${i}].localeCompare(a[1][${i}], undefined, { numeric: true, sensitivity: 'base' })`),e+="))))";return e+=";"};function na(){for(var t,e=[],i=0;i<this._rows.indexList.length;i++)t=this._rowOrderStore[this._rows.indexList[i]-1]||0,e.push([this._rows.indexList[i],t]);e.sort(this._sortFunctions.reset);for(var s=[],o=0;o<e.length;o++)s.push(e[o][0]);this._rows.indexList=s}function la(t,e=!0,i=function(){}){var s={sortState:t};if(this.events.dispatch("beforesort",s)){var o=this._sortState.slice(0),n=Dl.call(this);sa.call(this,s.sortState),Er.call(this,"sort"),i.call(this),this.redraw();var l=Dl.call(this);e&&this.undoManager.add({desc:"sort",undo:function(){o.length?sa.call(this,o):na.call(this),Er.call(this,"sort"),Lr.call(this,n),this.redraw()},redo:function(){sa.call(this,s.sortState),Er.call(this,"sort"),Lr.call(this,l),this.redraw()}}),this.events.dispatch("sort",s)}}function ra(t=null,e=null,i=!1){if(null!=t){var s=this._cols.coordList[t],o="asc";if(null==e?this._sortState.length&&this._sortState[0][0]==s&&(o="asc"==this._sortState[0][1]?"desc":"asc"):o=e,i&&!ha.call(this,s))var n=this._sortState;else n=[];n.push([s,o]),la.call(this,n,!0,(function(){}))}}const ha=function(t){for(var e=null,i=0;i<this._sortState.length;i++)if(this._sortState[i][0]==t){e=this._sortState[i][1];break}return e};function aa(){this._isActive||(this._isActive=!0,vi.call(this,"document","mousedown"),this.keys.resume())}function ca(){this._isActive&&(this._isActive=!1,this._domNodes.cellEditor._isOpen&&this.closeCellEditorAndSave(),wi.call(this,"document","mousedown"),this.keys.suspend(),this.deselectAll())}function da(t){return this._cols.coordList.indexOf(t)}function ua(t){return this._cols.coordList[t]||null}function pa(t){return this._cols.indexList[t]||null}function fa(t){return this.getColIndexById(this.getColIdByCoord(t))}function ga(t){return this._cols.indexList.indexOf(t)}function _a(t){var e,i=!1;e=this._cd.panesX.left.offset+this._cd.rowHeaderSpace;for(var s=0;s<this._panesXids.left.length;s++){if(s==t){i=!0;break}e+=this.getColWidthById(this._panesXids.left[s])}if(i)return e;e=this._cd.panesX.center.offset;for(s=0;s<this._colView.length;s++){if(this.getColCoordById(this._colView[s])==t){i=!0;break}e+=this.getColWidthById(this._colView[s])}return i?e:null}function ya(t){return null==this._cols.store[t-1]?null:this._cols.store[t-1].width}function ma(t){for(var e=0,i=0;i<this._cols.coordSections.length;i++)if(e+=this._cols.coordSections[i].length,t.x<e)return i;return-1}function xa(t){return t.x<this._panesXids.left.length?"left":"center"}function va(t){return this._rows.coordList.indexOf(t)}function wa(t){return null==this._rows.store[t-1]?null:this._actualRowHeight}function Ca(t){return this._rows.coordList[t]||null}function ba(t){return this._rows.indexList[t]||null}function Sa(t){return this.getRowIndexById(this.getRowIdByCoord(t))}function Ia(t){return this._rows.indexList.indexOf(t)}function La(t){var e,i=!1;e=this._cd.panesY.top.offset+this._cd.colHeaderSpace;for(var s=0;s<this._panesYids.top.length;s++){if(s==t){i=!0;break}e+=this.getRowHeightById(this._panesYids.top[s])}if(i)return e;e=this._cd.panesY.center.offset;for(s=0;s<this._rowView.length;s++){if(this.getRowCoordById(this._rowView[s])==t){i=!0;break}e+=this.getRowHeightById(this._rowView[s])}return i?e:null}function Ra(t){for(var e=0,i=0;i<this._rows.coordSections.length;i++)if(e+=this._rows.coordSections[i].length,t.y<e)return i;return-1}function Pa(t){return t.y<this._panesYids.top.length?"top":"center"}function Na(){vi.call(this,"cellEditorInputField","copy"),vi.call(this,"cellEditorInputField","paste"),vi.call(this,"cellEditorInputField","cut"),this._domNodes.cellEditor._isOpen=!1,this._domNodes.cellEditor._coords=null,this._domNodes.cellEditor._mode=null,N(this._domNodes.cellEditor,{opacity:0,height:"1px","z-index":-1}),this.events.dispatch("closecelleditor",{})}function Ha(){this.setCellValues(this._domNodes.cellEditor._coords,this._domNodes.cellEditorInputField.value),this.closeCellEditor()}function za(t="edit"){wi.call(this,"cellEditorInputField","copy"),wi.call(this,"cellEditorInputField","paste"),wi.call(this,"cellEditorInputField","cut"),Ir.call(this,this._cellCursorPosition);var e=this.getRowIdByCoord(this._cellCursorPosition.y),i=this.getColIdByCoord(this._cellCursorPosition.x);if(N(this._domNodes.cellEditorInputField,{height:this.getRowHeightById(e)+1+"px",width:this.getColWidthById(i)+"px"}),N(this._domNodes.cellEditor,{opacity:1,height:"auto","z-index":100,top:this.getRowPositionInViewport(this._cellCursorPosition.y)+"px",left:this.getColPositionInViewport(this._cellCursorPosition.x)+"px"}),this._domNodes.cellEditor._coords={x:this._cellCursorPosition.x,y:this._cellCursorPosition.y},this._domNodes.cellEditor._mode=t,this._domNodes.cellEditor._isOpen=!0,"enter"==t?ts.call(this,"inputModeEnter"):(ts.call(this,"inputModeEdit"),this._domNodes.cellEditorInputField.value=this.getCellValue(this._cellCursorPosition)),"edit"==t&&(this._isIE||this._isIOS||this._isMacOS)){var s=this._domNodes.cellEditorInputField.value;this._domNodes.cellEditorInputField.value="",this._domNodes.cellEditorInputField.value=s}is.call(this),this.redraw()}function ka(t){this._domNodes.cellEditorInputField.value=t,this._domNodes.cellEditorInputField.dispatchEvent(new Event("input"))}function Aa(){var t=document.createElement("textArea");t.value=" all",t.setAttribute("readonly",!0),t.addEventListener("copy",this._domNodes.component._listeners.clipboardNode.events.copy),document.body.appendChild(t);var e=document.createRange();e.selectNodeContents(t);var i=window.getSelection();i.removeAllRanges(),i.addRange(e),t.setSelectionRange(0,999999),document.execCommand("copy"),document.body.removeChild(t)}function Ta(){Ci.call(this,!0),this._domNodes.cellEditor._actualCommand="copy",this.constructor._isIOS?Aa.call(this):document.execCommand("copy")}function Fa(){Ci.call(this,!0),this._domNodes.cellEditor._actualCommand="cut",this.constructor._isIOS?Aa.call(this):document.execCommand("copy")}function Ba(){"clipboard"in navigator&&"function"==typeof navigator.clipboard.readText?navigator.clipboard.readText().then(t=>{""!=t&&Zi.call(this,{text:t},null)}).catch(t=>{}):this.isIE?document.execCommand("paste"):this.alertUser("Paste not available.")}function Ma(){var t=this.getColPositionInViewport(this._cellCursorPosition.x),e=this.getRowPositionInViewport(this._cellCursorPosition.y),i=0,s=this.getRowHeightById(this._rows.coordList[this._cellCursorPosition.y]),o=this._domNodes.display.getBoundingClientRect();Sn.call(this,{snapPointX:t+window.scrollX+i+o.left,snapPointY:e+window.scrollY+s+o.top},null)}function Ea(t={}){P({},t);for(var e="",i=0;i<this._rows.coordList.length;i++){for(var s=0;s<this._cols.coordList.length;s++){var o=this.getCellFromStore(this._rows.coordList[i],this._cols.coordList[s]).value;e+=null==o?"":o,s<this._cols.coordList.length-1&&(e+=",")}e+="\n"}Oa.call(this,e)}const Oa=function(t){var e=new Blob([t],{type:"text/csv",name:"datagridxl.csv"});if(this.constructor._isIE)navigator.msSaveBlob(e,"datagridxl.csv");else{var i=k("a",{class:"dgxl-downloadLink",href:URL.createObjectURL(e),download:"datagridxl.csv"});i.textContent="Click here to download",this._domNodes.component.appendChild(i),i.click(),this._domNodes.component.removeChild(i)}};function Xa(t={}){var e=P({useColTitles:!1,whitespace:2,includeDataField:!1},t);if(e.includeDataField)var i=(s={data:[]}).data;else{var s;i=s=[]}if(e.useColTitles)for(var o=0;o<this._rows.coordList.length;o++){i.push({});for(var n=0;n<this._cols.coordList.length;n++){this.getColFromStore(this._cols.coordList[n]);var l=Qe.call(this,this._cols.coordList[n]),r=this.getCellFromStore(this._rows.coordList[o],this._cols.coordList[n]).value;i[o][l]=null==r?"":r}}else for(o=0;o<this._rows.coordList.length;o++){i.push([]);for(n=0;n<this._cols.coordList.length;n++){r=this.getCellFromStore(this._rows.coordList[o],this._cols.coordList[n]).value;i[o].push(null==r?"":r)}}var h=JSON.stringify(s,null,e.whitespace);Va.call(this,h)}const Va=function(t){var e=new Blob([t],{type:"application/json",name:"datagridxl.json"});if(this.constructor._isIE)navigator.msSaveBlob(e,"datagridxl.json");else{var i=k("a",{class:"dgxl-downloadLink",href:URL.createObjectURL(e),download:"datagridxl.json"});i.textContent="Click here to download",this._domNodes.component.appendChild(i),i.click(),this._domNodes.component.removeChild(i)}};function Ya(t=null){if(null!=t){for(var e=[],i=0,s=t[0].y;s<=t[1].y;s++){e.push([]);for(var o=t[0].x;o<=t[1].x;o++){var n=this._cellStore[this._rows.coordList[s]-1][this._cols.coordList[o]-1].value;e[i].push(n)}i++}return e}}function Ka(t){if(null==t)return"";for(var e="",i=t[0].y;i<=t[1].y;i++){for(var s=t[0].x;s<=t[1].x;s++)e+=this._cellStore[this._rows.coordList[i]-1][this._cols.coordList[s]-1].value||"",s<t[1].x&&(e+="\t");i<t[1].y&&(e+="\n")}return""==e&&(e+="\n"),e}function Wa(t){var e=this._cellStore[this.getRowIdByCoord(t.y)-1];if(null!=e){var i=e[this.getColIdByCoord(t.x)-1];if(null!=i)return i.value}}function Da(t={}){var e=[];if("objectCollection"==this._dataFormat)for(var i=0;i<this._rows.coordList.length;i++){for(var s={},o=0;o<this._cols.coordList.length;o++){s[(n=this.getColFromStore(this._cols.coordList[o])).field]=this._cellStore[this._rows.coordList[i]-1][n.id-1].value}e.push(s)}else if("arrayCollection"==this._dataFormat)for(i=0;i<this._rows.coordList.length;i++){for(s=[],o=0;o<this._cols.coordList.length;o++){var n=this.getColFromStore(this._cols.coordList[o]);s[o]=this._cellStore[this._rows.coordList[i]-1][n.id-1].value}e.push(s)}return e}function ja(){this._isFullscreen?Ga.call(this):Ua.call(this)}const Ua=function(){if(this.constructor._isIOS)this._domNodes.component.style.width="100vw",this._domNodes.component.style.height="100vh";else if(this.constructor._isMacOS){var t=window.outerWidth-window.innerWidth,e=window.outerHeight-window.innerHeight,i=screen.availWidth-t;if(e<100)var s=screen.availHeight;else s=screen.availHeight-e;this._domNodes.component.style.width=i+"px",this._domNodes.component.style.height=s+"px"}this._domNodes.component.requestFullscreen?this._domNodes.component.requestFullscreen():this._domNodes.component.webkitRequestFullscreen?this._domNodes.component.webkitRequestFullscreen():this._domNodes.component.msRequestFullscreen&&this._domNodes.component.msRequestFullscreen()},Ga=function(){document.exitFullscreen?document.exitFullscreen():document.webkitExitFullscreen?document.webkitExitFullscreen():document.msExitFullscreen&&document.msExitFullscreen()};function $a(t){return this.headerLabelSeries.letters.indexToLabel(this.getColIndexByCoord(t.x))+this.headerLabelSeries.numbers.indexToLabel(this.getRowIndexByCoord(t.y))}function Za(t){alert(this.getLocaleSetting(t))}function qa(){var t="";for(var e in W)e.startsWith("reset")||(t+=`${e} {\n`,t+=z(W[e].call(this),!0),t+="}\n\n");t=t.substring(0,t.length-2),Ja.call(this,t)}const Ja=function(t){var e=new Blob([t],{type:"octet/stream",name:"datagridxl.csv"});if(this.constructor._isIE)navigator.msSaveBlob(e,"datagridxl.css");else{var i=k("a",{class:"dgxl-downloadLink",href:URL.createObjectURL(e),download:"datagridxl.css"});i.textContent="Click here to download",document.body.appendChild(i),i.click(),document.body.removeChild(i)}};function Qa(){requestAnimationFrame(()=>{Ll.call(this),this._prevSelection=Dl.call(this)})}function tc(){var t=this._cd.componentHeight,e=this._cd.componentWidth,i=!1,s=!1;Kt.call(this),Pr.call(this),this._isFullscreen&&e==this._cd.componentWidth&&t>this._cd.componentHeight+200?i=!0:this._isFullscreen&&e==this._cd.componentWidth&&this._cd.componentHeight>t+200&&(s=!0),s||i||Qo.call(this,{x:this._panesXids.left.length,y:this._panesYids.top.length}),requestAnimationFrame(()=>{Ll.call(this)}),this.events.dispatch("resize",{width:this._cd.componentWidth,height:this._cd.componentHeight})}function ec(t,e=!1){var i,s={},o=t.match(/([$][\w]+)=([\w\d]+)/g);if(null!=o)for(var n=0;n<o.length;n++){var l=o[n].split("=");s[l[0]]=l[1],t=t.replace(o[n],l[0])}return i=t in this.locale&&null!==this.locale[t]?this.locale[t]:t in this._defaultLocale&&null!==this._defaultLocale[t]?this._defaultLocale[t]:t,ic.call(this,i,s,e)}const ic=function(t,e,i){var s=i?"<em>":"",o=i?"</em>":"";for(var n in e)t=t.replace(n,s+e[n]+o);return t};function sc(){this._selection=[],this._activeRangeIndex=-1,this._cellCursorPosition=null,this.redraw()}function oc(t){for(var e=[],i=0;i<this._selection.length;i++)Ss(t,this._selection[i].range)&&e.push({range:this._selection[i].range,type:this._selection[i].type,index:i});return e}function nc(t=!1){var e=De(this._selection,{});if(t)return e;for(var i=[],s=0;s<e.length;s++)i.push(e[s].range);return i}function lc(t=!0){var e=[{range:[{x:0,y:0},{x:this._cols.coordList.length-1,y:this._rows.coordList.length-1}],type:"all"}];if(t)var i={x:0,y:0};else i=this._cellCursorPosition;br.call(this,e,i,0),this.redraw()}function rc(t){switch(this._selection[this._activeRangeIndex].type){case"cell":cc.call(this,t);break;case"col":hc.call(this,t);break;case"row":ac.call(this,t)}this.redraw()}const hc=function(t){if("left"==t||"right"==t){var e,i=this._selection[this._activeRangeIndex].range,s={x:this._cellCursorPosition.x,y:this._cellCursorPosition.y},o=i;"right"==t?s.x==i[0].x?(o[0].x=i[0].x,o[1].x=i[1].x+1,e=1):(o[0].x=i[0].x+1,o[1].x=i[1].x,e=0):"left"==t&&(s.x==i[1].x?(o[0].x=i[0].x-1,o[1].x=i[1].x,e=0):(o[0].x=i[0].x,o[1].x=i[1].x-1,e=1));var n=this._selection;n[this._activeRangeIndex].range=o,br.call(this,n,s,this._activeRangeIndex);var l=Sr.call(this,{x:o[e].x,y:o[e].y},"x");Qo.call(this,{x:this._viewportPosition.x+l.x,y:this._viewportPosition.y+l.y})}},ac=function(t){if("up"==t||"down"==t){var e,i=this._selection[this._activeRangeIndex].range,s={x:this._cellCursorPosition.x,y:this._cellCursorPosition.y},o=i;"down"==t?s.y==i[0].y?(o[0].y=i[0].y,o[1].y=i[1].y+1,e=1):(o[0].y=i[0].y+1,o[1].y=i[1].y,e=0):"up"==t&&(s.y==i[1].y?(o[0].y=i[0].y-1,o[1].y=i[1].y,e=0):(o[0].y=i[0].y,o[1].y=i[1].y-1,e=1));var n=this._selection;n[this._activeRangeIndex].range=o,br.call(this,n,s,this._activeRangeIndex);var l=Sr.call(this,{x:o[e].x,y:o[e].y},"y");Qo.call(this,{x:this._viewportPosition.x+l.x,y:this._viewportPosition.y+l.y})}},cc=function(t){var e,i,s=this._selection[this._activeRangeIndex].range,o={x:this._cellCursorPosition.x,y:this._cellCursorPosition.y},n=s;"right"==t?(e="x",n[0].y=s[0].y,n[1].y=s[1].y,o.x==s[0].x?(n[0].x=s[0].x,n[1].x=s[1].x+1,i=1):(n[0].x=s[0].x+1,n[1].x=s[1].x,i=0)):"left"==t?(e="x",n[0].y=s[0].y,n[1].y=s[1].y,o.x==s[1].x?(n[0].x=s[0].x-1,n[1].x=s[1].x,i=0):(n[0].x=s[0].x,n[1].x=s[1].x-1,i=1)):"down"==t?(e="y",n[0].x=s[0].x,n[1].x=s[1].x,o.y==s[0].y?(n[0].y=s[0].y,n[1].y=s[1].y+1,i=1):(n[0].y=s[0].y+1,n[1].y=s[1].y,i=0)):"up"==t&&(e="y",n[0].x=s[0].x,n[1].x=s[1].x,o.y==s[1].y?(n[0].y=s[0].y-1,n[1].y=s[1].y,i=0):(n[0].y=s[0].y,n[1].y=s[1].y-1,i=1));var l=this._selection;l[this._activeRangeIndex].range=n,br.call(this,l,o,this._activeRangeIndex);var r=Sr.call(this,{x:n[i].x,y:n[i].y},e);Qo.call(this,{x:this._viewportPosition.x+r.x,y:this._viewportPosition.y+r.y})};function dc(){return null==this._cellCursorPosition?null:{x:this._cellCursorPosition.x,y:this._cellCursorPosition.y}}function uc(t=null,e=!0){if(null!=t){var i=So.call(this,t,"document");if(e||!Ss(i,this._selection[this._activeRangeIndex].range))var s=hr.call(this,i);else s=this._selection;br.call(this,s,i,0),this.redraw()}}function pc(t=null){var e=So.call(this,{x:this._cellCursorPosition.x+t.x,y:this._cellCursorPosition.y+t.y},"document");br.call(this,[{range:[e,e],type:"cell"}]);var i={x:this._viewportPosition.x,y:this._viewportPosition.y},s=Sr.call(this,e);e.x>=this._panesXids.left.length&&(i.x+=s.x),e.y>=this._panesYids.top.length&&(i.y+=s.y),Qo.call(this,i),this.redraw()}function fc(t=null){if(null!=t){var e=this._selection[this._activeRangeIndex].range;if(1==this._selection.length&&Vi.call(this,e)){var i=[{range:[l={x:this._cellCursorPosition.x+t.x,y:this._cellCursorPosition.y+t.y},l],type:"cell"}];br.call(this,i,l,0)}else{var s=this._cellCursorPosition.x+t.x,o=this._cellCursorPosition.y+t.y,n={top:!1,right:!1,bottom:!1,left:!1};s>e[1].x?(n.right=!0,s=e[0].x,o<e[1].y?o++:(o=e[0].y,n.bottom=!0)):s<e[0].x&&(n.left=!0,s=e[1].x,o>e[0].y?o--:(o=e[1].y,n.top=!0)),o>e[1].y?(n.bottom=!0,o=e[0].y,s<e[1].x?s++:(s=e[0].x,n.right=!0)):o<e[0].y&&(n.top=!0,o=e[1].y,s>e[0].x?s--:(s=e[1].x,n.left=!0));var l={x:s,y:o},r=this._activeRangeIndex;n.right&&n.bottom&&(this._activeRangeIndex==this._selection.length-1?r=0:r++,l=this._selection[r].range[0]),n.left&&n.top&&(0==this._activeRangeIndex?r=this._selection.length-1:r--,l=this._selection[r].range[1]),br.call(this,this._selection,l,r)}var h={x:this._viewportPosition.x,y:this._viewportPosition.y},a=Sr.call(this,l);l.x>=this._panesXids.left.length&&(h.x+=a.x),l.y>=this._panesYids.top.length&&(h.y+=a.y),Qo.call(this,h),this.redraw()}}function gc(){var t=this._cellCursorPosition.y-this._viewportPosition.y;t<0&&(t=0);for(var e=0,i=this._viewportPosition.y;e<this._cd.panesY.center.space&&-1!=i;)e+=this.getRowHeightById(this.getRowIdByCoord(i)),i--;var s={x:this._cellCursorPosition.x,y:i+1+t};br.call(this,[{range:[s,s],type:"cell"}]),Qo.call(this,{x:this._viewportPosition.x,y:i+1}),this.redraw()}function _c(){var t=this._cellCursorPosition.y-this._viewportPosition.y;t<0&&(t=0);var e=this._viewportPosition.y+(this._rowView.length-1),i={x:this._cellCursorPosition.x,y:e+t};br.call(this,[{range:[i,i],type:"cell"}]),Qo.call(this,{x:this._viewportPosition.x,y:e}),this.redraw()}function yc(){var t={x:this._cellCursorPosition.x,y:0};br.call(this,[{range:[t,t],type:"cell"}]);var e={x:this._viewportPosition.x,y:this._viewportPosition.y},i=Sr.call(this,t);t.x>=this._panesXids.left.length&&(e.x+=i.x),t.y>=this._panesYids.top.length&&(e.y+=i.y),Qo.call(this,e),this.redraw()}function mc(){var t={x:this._cellCursorPosition.x,y:this._rows.coordList.length-1};br.call(this,[{range:[t,t],type:"cell"}]);var e={x:this._viewportPosition.x,y:this._viewportPosition.y},i=Sr.call(this,t);t.x>=this._panesXids.left.length&&(e.x+=i.x),t.y>=this._panesYids.top.length&&(e.y+=i.y),Qo.call(this,e),this.redraw()}function xc(){var t={x:0,y:this._cellCursorPosition.y};br.call(this,[{range:[t,t],type:"cell"}]);var e={x:this._viewportPosition.x,y:this._viewportPosition.y},i=Sr.call(this,t);t.x>=this._panesXids.left.length&&(e.x+=i.x),t.y>=this._panesYids.top.length&&(e.y+=i.y),Qo.call(this,e),this.redraw()}function vc(){var t={x:this._cols.coordList.length-1,y:this._cellCursorPosition.y};br.call(this,[{range:[t,t],type:"cell"}]);var e={x:this._viewportPosition.x,y:this._viewportPosition.y},i=Sr.call(this,t);t.x>=this._panesXids.left.length&&(e.x+=i.x),t.y>=this._panesYids.top.length&&(e.y+=i.y),Qo.call(this,e),this.redraw()}function wc(){var t={x:this._panesXids.left.length,y:this._panesYids.top.length};br.call(this,[{range:[t,t],type:"cell"}]);var e=Sr.call(this,t);Qo.call(this,{x:this._viewportPosition.x+e.x,y:this._viewportPosition.y+e.y}),this.redraw()}function Cc(){var t={x:this._cols.coordList.length-1,y:this._rows.coordList.length-1};br.call(this,[{range:[t,t],type:"cell"}]);var e=Sr.call(this,t);Qo.call(this,{x:this._viewportPosition.x+e.x,y:this._viewportPosition.y+e.y}),this.redraw()}function bc(t=null){if(null!=t){var e=hr.call(this,t);br.call(this,e),this.redraw()}}function Sc(t=!1){var e=De(this._selection,{type:"cell"});if(t)return e;for(var i=[],s=0;s<e.length;s++)i.push(e[s].range);return i}function Ic(t,e=!1){var i=this._cellCursorPosition||{x:0,y:0};if(e){var s=[{range:o=[i,So.call(this,t)],type:"cell"}];br.call(this,s,i,0)}else{var o=[i,So.call(this,t)];(s=this._selection)[this._activeRangeIndex].range=o,br.call(this,s,i,this._activeRangeIndex)}this.redraw()}function Lc(t=null){if(null!=t){var e=this._selection;e.push({range:t,type:"cell"});var i=e.length-1,s={x:e[i].range[0].x,y:e[i].range[1].y};br.call(this,e,s,i),this.redraw()}}function Rc(t){for(var e={x:t,y:0},i=[],s=0;s<this._selection.length;s++)Ss(e,this._selection[s].range)&&"col"==this._selection[s].type&&i.push({range:this._selection[s].range,type:this._selection[s].type,index:s});return i}function Pc(t=!1){var e=De(this._selection,{type:"col"});if(t)return e;for(var i=[],s=0;s<e.length;s++)i.push(uo.call(this,e[s].range));return i}function Nc(t=null){if(null!=t){var e=Dr.call(this,t),i={x:e[0].range[0].x,y:0};br.call(this,e,i),this.redraw()}}function Hc(t){var e=t,i={left:0,right:this._cols.coordList.length-1},s=e>i.right;return e<i.left&&(e=i.left),s&&(e=i.right),e}function zc(t,e=!1){var i=this._cellCursorPosition||{x:0,y:0};if(e){var s=[i.x,Hc.call(this,t)],o=[{range:n=el.call(this,s),type:"col"}];br.call(this,o,i,0)}else{s=[i.x,Hc.call(this,t)];var n=el.call(this,s);(o=this._selection)[this._activeRangeIndex].range=n,br.call(this,o,i,this._activeRangeIndex)}this.redraw()}function kc(t=null){if(null!=t){var e=this._selection;e.push({range:el.call(this,t),type:"col"});var i={x:e[e.length-1].range[0].x,y:0},s=e.length-1;br.call(this,e,i,s),this.redraw()}}function Ac(t){for(var e={x:0,y:t},i=[],s=0;s<this._selection.length;s++)Ss(e,this._selection[s].range)&&"row"==this._selection[s].type&&i.push({range:this._selection[s].range,type:this._selection[s].type,index:s});return i}function Tc(t=!1){var e=De(this._selection,{type:"row"});if(t)return e;for(var i=[],s=0;s<e.length;s++)i.push(Ys.call(this,e[s].range));return i}function Fc(t=null){if(null!=t){var e=Lh.call(this,t),i={x:0,y:e[0].range[0].y};br.call(this,e,i),this.redraw()}}function Bc(t){var e=t,i={top:0,bottom:this._rows.coordList.length-1},s=e>i.bottom;return e<i.top&&(e=i.top),s&&(e=i.bottom),e}function Mc(t,e=!1){var i=this._cellCursorPosition||{x:0,y:0};if(e){var s=[i.y,Bc.call(this,t)],o=[{range:n=il.call(this,s),type:"row"}];br.call(this,o,i,0)}else{s=[i.y,Bc.call(this,t)];var n=il.call(this,s);(o=this._selection)[this._activeRangeIndex].range=n,br.call(this,o,i,this._activeRangeIndex)}this.redraw()}function Ec(t=null){if(null!=t){var e=this._selection;e.push({range:il.call(this,t),type:"row"});var i={x:0,y:e[e.length-1].range[0].y},s=e.length-1;br.call(this,e,i,s),this.redraw()}}function Oc(t,e){var i=this._cellStore[t-1];return null!=i&&i[e-1]||null}function Xc(t){return this._cols.store[t-1]||null}function Vc(t){return this._rows.store[t-1]||null}function Yc(t){return this.theme[t]||this._defaultTheme[t]}function Kc(){this.undoManager.hasUndo()&&this.undoManager.undo()}function Wc(){this.undoManager.hasRedo()&&this.undoManager.redo()}function Dc(){return null==this._viewportPosition?null:{x:this._viewportPosition.x,y:this._viewportPosition.y}}function jc(t){Qo.call(this,t),this.redraw()}class DataGridXL{constructor(t=null,e={}){this._presetContextMenuItems=Gl,this._presetContextMenuTouchItems,this._presetKeyActions=Wl,this._presetParts=Kl,this._defaultTheme=ir,this._defaultLocale=sr,this.events=new Wt(this),this.keys=new zl(this),this.undoManager=new Xl(this),this.mouseCursorStatesIdle=or,this.mouseCursorStatesDrag=nr,this.headerLabelSeries=$l,this.keyActionSets=tr,this.allowEditCells=!0,this.allowFillCells=!0,this.fillCellsDirection="xy",this.allowCopy=!0,this.allowCut=!0,this.allowPaste=!0,this.expandSheetOnPaste=!0,this.instantCut=!1,this.allowDeleteCols=!0,this.allowInsertCols=!0,this.allowMoveCols=!0,this.allowFreezeCols=!0,this.allowHideCols=!0,this.allowResizeCols=!0,this.allowDeleteRows=!0,this.allowInsertRows=!0,this.allowMoveRows=!0,this.allowFreezeRows=!0,this.allowHideRows=!0,this.allowSort=!0,this.colAlign="left",this.colHeaderHeight=28,this.colHeaderLabelAlign="left",this.colHeaderLabelFunction=Jl,this.colHeaderLabelPrefix="",this.colHeaderLabelSuffix="",this.colHeaderLabelType="letters",this.colWidth=100,this.frozenCols=0,this.frozenRows=0,this.rowHeaderLabelAlign="right",this.rowHeaderLabelFunction=Ql,this.rowHeaderLabelPrefix="",this.rowHeaderLabelSuffix="",this.rowHeaderLabelType="numbers",this.rowHeaderWidth=50,this.rowHeight=28,this.columns=void 0,this.contextMenuItems=er,this.contextMenuTouchItems=void 0,this.data=void 0,this.fontSize=13,this.fontFamily="sans-serif",this.locale={},this.topBar=Zl,this.bottomBar=ql,this.hijackNativeSearchCommand=!1,this.cssTheme="light",this.theme={},this._dataFormat,this._actualRowHeight,this._scrollLeft=0,this._scrollTop=0,this._cd={},this._domNodes={},this._isReady=!1,this._isFullscreen=!1,this._currentDragAction=null,this._copyRange=null,this._cutRange=null,this._fillRange=null,this._cols={store:[],sections:[],tree:[],headerLevels:[],hiddenGroups:[],iconList:void 0,prevNodes:[],nextNodes:[],indexList:[],coordList:[]},this._rows={store:[],sections:[],tree:[],headerLevels:[],hiddenGroups:[],iconList:void 0,prevNodes:[],nextNodes:[],indexList:[],coordList:[]},this._columnNodes=[],this._topBarNodes=[],this._bottomBarNodes=[],this._colLines=[],this._rowLines=[],this._selection=[{range:[{x:0,y:0},{x:0,y:0}],type:"cell"}],this._cellCursorPosition={x:0,y:0},this._activeRangeIndex=0,this._viewportPosition=null,this._viewportOverflowPx={x:0,y:0},this._isViewportConnectedTo={top:!0,left:!0},this._sectionsPerPaneX={left:[0],center:[1]},this._sectionsPerPaneY={top:[0],center:[1]},this._isActive=!1,this._commandKey=this.constructor._isMacOS?"metaKey":"ctrlKey",this._searchStr="",this._searchCellsFound=[],this._searchCellIndex=-1,this._sortState=[],this._sortFunctions={reset:new Function("a,b","return b[1] - a[1];")},this._rowOrderStore=[],Hl.call(this,t,e)}clearCellValues(t){return ar.call(this,t)}setCellValues(t,e,i,s){return Yr.call(this,t,e,i,s)}fillCells(t,e,i){return Kr.call(this,t,e,i)}deleteCols(t){return Ur.call(this,t)}freezeCols(t){return Gr.call(this,t)}hideCols(t){return $r.call(this,t)}insertEmptyCols(t,e){return Qr.call(this,t,e)}moveCols(t,e){return nh.call(this,t,e)}resizeCols(t,e){return ch.call(this,t,e)}resizeColsToFit(t){return dh.call(this,t)}deleteColsById(t){return _h.call(this,t)}freezeColsUntilId(t){return xh.call(this,t)}hideColsById(t){return bh.call(this,t)}showColsById(t){return Ih.call(this,t)}deleteRows(t){return Ph.call(this,t)}freezeRows(t){return Nh.call(this,t)}hideRows(t){return Hh.call(this,t)}insertEmptyRows(t,e){return Ah.call(this,t,e)}moveRows(t,e){return Mh.call(this,t,e)}deleteRowsById(t){return Yh.call(this,t)}freezeRowsUntilId(t){return Dh.call(this,t)}hideRowsById(t){return $h.call(this,t)}showRowsById(t){return qh.call(this,t)}clearSearch(){return Jh.call(this)}search(t){return ta.call(this,t)}searchPrev(){return ia.call(this)}searchNext(){return ea.call(this)}sort(t,e){return ra.call(this,t,e)}activate(){return aa.call(this)}deactivate(){return ca.call(this)}getColCoordById(t){return da.call(this,t)}getColIdByCoord(t){return ua.call(this,t)}getColIdByIndex(t){return pa.call(this,t)}getColIndexByCoord(t){return fa.call(this,t)}getColIndexById(t){return ga.call(this,t)}getColPositionInViewport(t){return _a.call(this,t)}getColWidthById(t){return ya.call(this,t)}getColSectionFromCellCoords(t){return ma.call(this,t)}getPanePositionXfromCellCoords(t){return xa.call(this,t)}getRowCoordById(t){return va.call(this,t)}getRowHeightById(t){return wa.call(this,t)}getRowIdByCoord(t){return Ca.call(this,t)}getRowIdByIndex(t){return ba.call(this,t)}getRowIndexByCoord(t){return Sa.call(this,t)}getRowIndexById(t){return Ia.call(this,t)}getRowPositionInViewport(t){return La.call(this,t)}getRowSectionFromCellCoords(t){return Ra.call(this,t)}getPanePositionYfromCellCoords(t){return Pa.call(this,t)}closeCellEditor(){return Na.call(this)}closeCellEditorAndSave(){return Ha.call(this)}openCellEditor(t){return za.call(this,t)}setCellEditorValue(t){return ka.call(this,t)}copy(){return Ta.call(this)}cut(){return Fa.call(this)}paste(){return Ba.call(this)}openContextMenu(){return Ma.call(this)}downloadDataAsCSV(t){return Ea.call(this,t)}downloadDataAsJSON(t){return Xa.call(this,t)}getCellRangeData(t){return Ya.call(this,t)}getCellRangeText(t){return Ka.call(this,t)}getCellValue(t){return Wa.call(this,t)}getData(t){return Da.call(this,t)}toggleFullscreen(){return ja.call(this)}getSpreadsheetCoords(t){return $a.call(this,t)}alertUser(t){return Za.call(this,t)}generateCssFromStyles(){return qa.call(this)}redraw(){return Qa.call(this)}resize(){return tc.call(this)}getLocaleSetting(t){return ec.call(this,t)}deselectAll(){return sc.call(this)}getAnyRangesFromCellCoords(t){return oc.call(this,t)}getSelection(t){return nc.call(this,t)}selectAll(t){return lc.call(this,t)}modifyActiveRange(t){return rc.call(this,t)}getCellCursorPosition(){return dc.call(this)}setCellCursorPosition(t){return uc.call(this,t)}moveCellCursor(t){return pc.call(this,t)}moveCellCursorInsideSelection(t){return fc.call(this,t)}moveCellCursorOneViewportUp(){return gc.call(this)}moveCellCursorOneViewportDown(){return _c.call(this)}moveCellCursorToColStart(){return yc.call(this)}moveCellCursorToColEnd(){return mc.call(this)}moveCellCursorToRowStart(){return xc.call(this)}moveCellCursorToRowEnd(){return vc.call(this)}moveCellCursorToSheetStart(){return wc.call(this)}moveCellCursorToSheetEnd(){return Cc.call(this)}setCellSelection(t){return bc.call(this,t)}getCellSelection(t){return Sc.call(this,t)}setCellRangeExtreme(t,e){return Ic.call(this,t,e)}addCellRangeToSelection(t){return Lc.call(this,t)}getColRangesFromCoord(t){return Rc.call(this,t)}getColSelection(t){return Pc.call(this,t)}setColSelection(t){return Nc.call(this,t)}setColRangeExtreme(t,e){return zc.call(this,t,e)}addColRangeToSelection(t){return kc.call(this,t)}getRowRangesFromCoord(t){return Ac.call(this,t)}getRowSelection(t){return Tc.call(this,t)}setRowSelection(t){return Fc.call(this,t)}setRowRangeExtreme(t,e){return Mc.call(this,t,e)}addRowRangeToSelection(t){return Ec.call(this,t)}getCellFromStore(t,e){return Oc.call(this,t,e)}getColFromStore(t){return Xc.call(this,t)}getRowFromStore(t){return Vc.call(this,t)}getThemeSetting(t){return Yc.call(this,t)}undo(){return Kc.call(this)}redo(){return Wc.call(this)}getViewportPosition(){return Dc.call(this)}setViewportPosition(t){return jc.call(this,t)}}DataGridXL._domNodes={},DataGridXL.instances=[],DataGridXL._isIE=function(){var t=window.navigator.userAgent,e=t.indexOf("MSIE ");if(e>0)return parseInt(t.substring(e+5,t.indexOf(".",e)),10);if(t.indexOf("Trident/")>0){var i=t.indexOf("rv:");return parseInt(t.substring(i+3,t.indexOf(".",i)),10)}return!1}(),DataGridXL._isMacOS=navigator.platform.indexOf("Mac")>-1,DataGridXL._isIOS=!!navigator.platform&&/iPad|iPhone|iPod/.test(navigator.platform)||"MacIntel"===navigator.platform&&navigator.maxTouchPoints>1,DataGridXL._isTouchDevice=window.matchMedia("(pointer: coarse)").matches,DataGridXL.createEmptyData=function(t,e){for(var i=[],s=0;s<t;s++){i.push([]);for(var o=0;o<e;o++)i[s].push(null)}return i},DataGridXL.createDummyData=function(t,e){for(var i=[],s=0;s<t;s++){i.push([]);for(var o=0;o<e;o++)i[s].push(s+1+";"+(o+1))}return i};export default DataGridXL;
